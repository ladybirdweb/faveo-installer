(function(){angular.module("ui.tree").factory("UiTreeHelper",["$document","$window","treeConfig",function(d,c,b){return{nodesData:{},setNodeAttribute:function(f,e,h){if(!f.$modelValue){return null}var g=this.nodesData[f.$modelValue.$$hashKey];if(!g){g={};this.nodesData[f.$modelValue.$$hashKey]=g}g[e]=h},getNodeAttribute:function(f,e){if(!f.$modelValue){return null}var g=this.nodesData[f.$modelValue.$$hashKey];if(g){return g[e]}return null},nodrag:function(e){if(typeof e.attr("data-nodrag")!="undefined"){return e.attr("data-nodrag")!=="false"}return false},eventObj:function(g){var f=g;if(g.targetTouches!==undefined){f=g.targetTouches.item(0)}else{if(g.originalEvent!==undefined&&g.originalEvent.targetTouches!==undefined){f=g.originalEvent.targetTouches.item(0)}}return f},dragInfo:function(e){return{source:e,sourceInfo:{cloneModel:e.$treeScope.cloneEnabled===true?angular.copy(e.$modelValue):undefined,nodeScope:e,index:e.index(),nodesScope:e.$parentNodesScope},index:e.index(),siblings:e.siblings().slice(0),parent:e.$parentNodesScope,resetParent:function(){this.parent=e.$parentNodesScope},moveTo:function(h,j,f){this.parent=h;this.siblings=j.slice(0);var g=this.siblings.indexOf(this.source);if(g>-1){this.siblings.splice(g,1);if(this.source.index()<f){f--}}this.siblings.splice(f,0,this.source);this.index=f},parentNode:function(){return this.parent.$nodeScope},prev:function(){if(this.index>0){return this.siblings[this.index-1]}return null},next:function(){if(this.index<this.siblings.length-1){return this.siblings[this.index+1]}return null},isClone:function(){return this.source.$treeScope.cloneEnabled===true},clonedNode:function(f){return angular.copy(f)},isDirty:function(){return this.source.$parentNodesScope!=this.parent||this.source.index()!=this.index},isForeign:function(){return this.source.$treeScope!==this.parent.$treeScope},eventArgs:function(f,g){return{source:this.sourceInfo,dest:{index:this.index,nodesScope:this.parent},elements:f,pos:g}},apply:function(){var f=this.source.$modelValue;if(this.parent.nodropEnabled||this.parent.$treeScope.nodropEnabled){return}if(!this.isDirty()){return}if(this.isClone()&&this.isForeign()){this.parent.insertNode(this.index,this.sourceInfo.cloneModel)}else{this.source.remove();this.parent.insertNode(this.index,f)}}}},height:function(e){return e.prop("scrollHeight")},width:function(e){return e.prop("scrollWidth")},offset:function(e){var f=e[0].getBoundingClientRect();return{width:e.prop("offsetWidth"),height:e.prop("offsetHeight"),top:f.top+(c.pageYOffset||d[0].body.scrollTop||d[0].documentElement.scrollTop),left:f.left+(c.pageXOffset||d[0].body.scrollLeft||d[0].documentElement.scrollLeft)}},positionStarted:function(i,h){var j={},g=i.pageX,f=i.pageY;if(i.originalEvent&&i.originalEvent.touches&&(i.originalEvent.touches.length>0)){g=i.originalEvent.touches[0].pageX;f=i.originalEvent.touches[0].pageY}j.offsetX=g-this.offset(h).left;j.offsetY=f-this.offset(h).top;j.startX=j.lastX=g;j.startY=j.lastY=f;j.nowX=j.nowY=j.distX=j.distY=j.dirAx=0;j.dirX=j.dirY=j.lastDirX=j.lastDirY=j.distAxX=j.distAxY=0;return j},positionMoved:function(j,k,g){var i=j.pageX,h=j.pageY,f;if(j.originalEvent&&j.originalEvent.touches&&(j.originalEvent.touches.length>0)){i=j.originalEvent.touches[0].pageX;h=j.originalEvent.touches[0].pageY}k.lastX=k.nowX;k.lastY=k.nowY;k.nowX=i;k.nowY=h;k.distX=k.nowX-k.lastX;k.distY=k.nowY-k.lastY;k.lastDirX=k.dirX;k.lastDirY=k.dirY;k.dirX=k.distX===0?0:k.distX>0?1:-1;k.dirY=k.distY===0?0:k.distY>0?1:-1;f=Math.abs(k.distX)>Math.abs(k.distY)?1:0;if(g){k.dirAx=f;k.moving=true;return}if(k.dirAx!==f){k.distAxX=0;k.distAxY=0}else{k.distAxX+=Math.abs(k.distX);if(k.dirX!==0&&k.dirX!==k.lastDirX){k.distAxX=0}k.distAxY+=Math.abs(k.distY);if(k.dirY!==0&&k.dirY!==k.lastDirY){k.distAxY=0}}k.dirAx=f},elementIsTreeNode:function(e){return typeof e.attr("ui-tree-node")!=="undefined"},elementIsTreeNodeHandle:function(e){return typeof e.attr("ui-tree-handle")!=="undefined"},elementIsTree:function(e){return typeof e.attr("ui-tree")!=="undefined"},elementIsTreeNodes:function(e){return typeof e.attr("ui-tree-nodes")!=="undefined"},elementIsPlaceholder:function(e){return e.hasClass(b.placeholderClass)},elementContainsTreeNodeHandler:function(e){return e[0].querySelectorAll("[ui-tree-handle]").length>=1},treeNodeHandlerContainerOfElement:function(e){return a("ui-tree-handle",e[0])}}}]);function a(c,f){if(f===undefined){return null}var b=f.parentNode,e=1,d=(typeof b.setAttribute==="function"&&b.hasAttribute(c))?b:null;while(b&&typeof b.setAttribute==="function"&&!b.hasAttribute(c)){b=b.parentNode;d=b;if(b===document.documentElement){d=null;break}e++}return d}})();