if(Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get){(function(){var a=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return a.get.call(this)},set:function(b){return a.set.call(this,b)}})})()}if(!Array.isArray){Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}}var wysihtml5={version:"0.4.15",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\uFEFF",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};(function(a,b){if(typeof define=="function"&&define.amd){define(a)}else{b.rangy=a()}})(function(){var n="object",i="function",H="undefined";var o=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var d=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"];var w=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"];var t=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function l(L,K){var J=typeof L[K];return J==i||(!!(J==n&&L[K]))||J=="unknown"}function e(K,J){return !!(typeof K[J]==n&&K[J])}function u(K,J){return typeof K[J]!=H}function p(J){return function(M,L){var K=L.length;while(K--){if(!J(M,L[K])){return false}}return true}}var s=p(l);var v=p(e);var G=p(u);function C(J){return J&&s(J,t)&&G(J,w)}function I(J){return e(J,"body")?J.body:J.getElementsByTagName("body")[0]}var E={};var r={version:"1.3alpha.20140804",initialized:false,supported:true,util:{isHostMethod:l,isHostObject:e,isHostProperty:u,areHostMethods:s,areHostObjects:v,areHostProperties:G,isTextRange:C,getBody:I},features:{},modules:E,config:{alertOnFail:true,alertOnWarn:false,preferTextRange:false,autoInitialize:(typeof rangyAutoInitialize==H)?true:rangyAutoInitialize}};function B(J){if(e(window,"console")&&l(window.console,"log")){window.console.log(J)}}function h(K,J){if(J){window.alert(K)}else{B(K)}}function g(J){r.initialized=true;r.supported=false;h("Rangy is not supported on this page in your browser. Reason: "+J,r.config.alertOnFail)}r.fail=g;function A(J){h("Rangy warning: "+J,r.config.alertOnWarn)}r.warn=A;if({}.hasOwnProperty){r.util.extend=function(N,L,J){var O,M;for(var K in L){if(L.hasOwnProperty(K)){O=N[K];M=L[K];if(J&&O!==null&&typeof O=="object"&&M!==null&&typeof M=="object"){r.util.extend(O,M,true)}N[K]=M}}if(L.hasOwnProperty("toString")){N.toString=L.toString}return N}}else{g("hasOwnProperty not supported")}(function(){var K=document.createElement("div");K.appendChild(document.createElement("span"));var M=[].slice;var J;try{if(M.call(K.childNodes,0)[0].nodeType==1){J=function(N){return M.call(N,0)}}}catch(L){}if(!J){J=function(P){var O=[];for(var Q=0,N=P.length;Q<N;++Q){O[Q]=P[Q]}return O}}r.util.toArray=J})();var m;if(l(document,"addEventListener")){m=function(L,J,K){L.addEventListener(J,K,false)}}else{if(l(document,"attachEvent")){m=function(L,J,K){L.attachEvent("on"+J,K)}}else{g("Document does not have required addEventListener or attachEvent method")}}r.util.addListener=m;var D=[];function j(J){return J.message||J.description||String(J)}function y(){if(r.initialized){return}var L;var S=false,M=false;if(l(document,"createRange")){L=document.createRange();if(s(L,d)&&G(L,o)){S=true}}var O=I(document);if(!O||O.nodeName.toLowerCase()!="body"){g("No body element found");return}if(O&&l(O,"createTextRange")){L=O.createTextRange();if(C(L)){M=true}}if(!S&&!M){g("Neither Range nor TextRange are available");return}r.initialized=true;r.features={implementsDomRange:S,implementsTextRange:M};var K,Q;for(var J in E){if((K=E[J]) instanceof F){K.init(K,r)}}for(var N=0,P=D.length;N<P;++N){try{D[N](r)}catch(R){Q="Rangy init listener threw an exception. Continuing. Detail: "+j(R);B(Q)}}}r.init=y;r.addInitListener=function(J){if(r.initialized){J(r)}else{D.push(J)}};var f=[];r.addShimListener=function(J){f.push(J)};function a(L){L=L||window;y();for(var K=0,J=f.length;K<J;++K){f[K](L)}}r.shim=r.createMissingNativeApi=a;function F(J,L,K){this.name=J;this.dependencies=L;this.initialized=false;this.supported=false;this.initializer=K}F.prototype={init:function(){var M=this.dependencies||[];for(var L=0,J=M.length,N,K;L<J;++L){K=M[L];N=E[K];if(!N||!(N instanceof F)){throw new Error("required module '"+K+"' not found")}N.init();if(!N.supported){throw new Error("required module '"+K+"' not supported")}}this.initializer(this)},fail:function(J){this.initialized=true;this.supported=false;throw new Error("Module '"+this.name+"' failed to load: "+J)},warn:function(J){r.warn("Module "+this.name+": "+J)},deprecationNotice:function(J,K){r.warn("DEPRECATED: "+J+" in module "+this.name+"is deprecated. Please use "+K+" instead")},createError:function(J){return new Error("Error in Rangy "+this.name+" module: "+J)}};function z(J,K,M,N){var L=new F(K,M,function(Q){if(!Q.initialized){Q.initialized=true;try{N(r,Q);Q.supported=true}catch(P){var O="Module '"+K+"' failed to load: "+j(P);B(O)}}});E[K]=L}r.createModule=function(J){var M,L;if(arguments.length==2){M=arguments[1];L=[]}else{M=arguments[2];L=arguments[1]}var K=z(false,J,L,M);if(r.initialized){K.init()}};r.createCoreModule=function(J,K,L){z(true,J,K,L)};function q(){}r.RangePrototype=q;r.rangePrototype=new q();function x(){}r.selectionPrototype=new x();var b=false;var k=function(J){if(!b){b=true;if(!r.initialized&&r.config.autoInitialize){y()}}};if(typeof window==H){g("No window found");return}if(typeof document==H){g("No document found");return}if(l(document,"addEventListener")){document.addEventListener("DOMContentLoaded",k,false)}m(window,"load",k);r.createCoreModule("DomUtil",[],function(M,K){var ab="undefined";var O=M.util;if(!O.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])){K.fail("document missing a Node creation method")}if(!O.isHostMethod(document,"getElementsByTagName")){K.fail("document missing getElementsByTagName method")}var an=document.createElement("div");if(!O.areHostMethods(an,["insertBefore","appendChild","cloneNode"]||!O.areHostObjects(an,["previousSibling","nextSibling","childNodes","parentNode"]))){K.fail("Incomplete Element implementation")}if(!O.isHostProperty(an,"innerHTML")){K.fail("Element is missing innerHTML property")}var ap=document.createTextNode("test");if(!O.areHostMethods(ap,["splitText","deleteData","insertData","appendData","cloneNode"]||!O.areHostObjects(an,["previousSibling","nextSibling","childNodes","parentNode"])||!O.areHostProperties(ap,["data"]))){K.fail("Incomplete Text Node implementation")}var at=function(au,aw){var av=au.length;while(av--){if(au[av]===aw){return true}}return false};function Q(av){var au;return typeof av.namespaceURI==ab||((au=av.namespaceURI)===null||au=="http://www.w3.org/1999/xhtml")}function ac(av){var au=av.parentNode;return(au.nodeType==1)?au:null}function W(av){var au=0;while((av=av.previousSibling)){++au}return au}function ae(au){switch(au.nodeType){case 7:case 10:return 0;case 3:case 8:return au.length;default:return au.childNodes.length}}function T(av,au){var aw=[],ax;for(ax=av;ax;ax=ax.parentNode){aw.push(ax)}for(ax=au;ax;ax=ax.parentNode){if(at(aw,ax)){return ax}}return null}function S(au,av,ax){var aw=ax?av:av.parentNode;while(aw){if(aw===au){return true}else{aw=aw.parentNode}}return false}function al(au,av){return S(au,av,true)}function aj(av,au,ay){var aw,ax=ay?av:av.parentNode;while(ax){aw=ax.parentNode;if(aw===au){return ax}ax=aw}return null}function L(av){var au=av.nodeType;return au==3||au==4||au==8}function J(av){if(!av){return false}var au=av.nodeType;return au==3||au==8}function P(ax,av){var au=av.nextSibling,aw=av.parentNode;if(au){aw.insertBefore(ax,au)}else{aw.appendChild(ax)}return ax}function ad(az,aw,av){var ay=az.cloneNode(false);ay.deleteData(0,aw);az.deleteData(aw,az.length-aw);P(ay,az);if(av){for(var ax=0,au;au=av[ax++];){if(au.node==az&&au.offset>aw){au.node=ay;au.offset-=aw}else{if(au.node==az.parentNode&&au.offset>W(az)){++au.offset}}}}return ay}function aq(au){if(au.nodeType==9){return au}else{if(typeof au.ownerDocument!=ab){return au.ownerDocument}else{if(typeof au.document!=ab){return au.document}else{if(au.parentNode){return aq(au.parentNode)}else{throw K.createError("getDocument: no document found for node")}}}}}function V(au){var av=aq(au);if(typeof av.defaultView!=ab){return av.defaultView}else{if(typeof av.parentWindow!=ab){return av.parentWindow}else{throw K.createError("Cannot get a window object for node")}}}function ar(au){if(typeof au.contentDocument!=ab){return au.contentDocument}else{if(typeof au.contentWindow!=ab){return au.contentWindow.document}else{throw K.createError("getIframeDocument: No Document object found for iframe element")}}}function ao(au){if(typeof au.contentWindow!=ab){return au.contentWindow}else{if(typeof au.contentDocument!=ab){return au.contentDocument.defaultView}else{throw K.createError("getIframeWindow: No Window object found for iframe element")}}}function ah(au){return au&&O.isHostMethod(au,"setTimeout")&&O.isHostObject(au,"document")}function ag(ax,av,au){var aw;if(!ax){aw=document}else{if(O.isHostProperty(ax,"nodeType")){aw=(ax.nodeType==1&&ax.tagName.toLowerCase()=="iframe")?ar(ax):aq(ax)}else{if(ah(ax)){aw=ax.document}}}if(!aw){throw av.createError(au+"(): Parameter must be a Window object or DOM node")}return aw}function R(av){var au;while((au=av.parentNode)){av=au}return av}function ak(ax,az,aw,ay){var au,aA,aC,aB,av;if(ax==aw){return az===ay?0:(az<ay)?-1:1}else{if((au=aj(aw,ax,true))){return az<=W(au)?-1:1}else{if((au=aj(ax,aw,true))){return W(au)<ay?-1:1}else{aA=T(ax,aw);if(!aA){throw new Error("comparePoints error: nodes have no common ancestor")}aC=(ax===aA)?aA:aj(ax,aA,true);aB=(aw===aA)?aA:aj(aw,aA,true);if(aC===aB){throw K.createError("comparePoints got to case 4 and childA and childB are the same!")}else{av=aA.firstChild;while(av){if(av===aC){return -1}else{if(av===aB){return 1}}av=av.nextSibling}}}}}}var Z=false;function Y(au){var aw;try{aw=au.parentNode;return false}catch(av){return true}}(function(){var au=document.createElement("b");au.innerHTML="1";var av=au.firstChild;au.innerHTML="<br>";Z=Y(av);M.features.crashyTextNodes=Z})();function aa(au){if(!au){return"[No node]"}if(Z&&Y(au)){return"[Broken node]"}if(L(au)){return'"'+au.data+'"'}if(au.nodeType==1){var av=au.id?' id="'+au.id+'"':"";return"<"+au.nodeName+av+">[index:"+W(au)+",length:"+au.childNodes.length+"]["+(au.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return au.nodeName}function ai(av){var au=aq(av).createDocumentFragment(),aw;while((aw=av.firstChild)){au.appendChild(aw)}return au}var U;if(typeof window.getComputedStyle!=ab){U=function(au,av){return V(au).getComputedStyle(au,null)[av]}}else{if(typeof document.documentElement.currentStyle!=ab){U=function(au,av){return au.currentStyle[av]}}else{K.fail("No means of obtaining computed style properties found")}}function N(au){this.root=au;this._next=au}N.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){var aw=this._current=this._next;var av,au;if(this._current){av=aw.firstChild;if(av){this._next=av}else{au=null;while((aw!==this.root)&&!(au=aw.nextSibling)){aw=aw.parentNode}this._next=au}}return this._current},detach:function(){this._current=this._next=this.root=null}};function am(au){return new N(au)}function X(au,av){this.node=au;this.offset=av}X.prototype={equals:function(au){return !!au&&this.node===au.node&&this.offset==au.offset},inspect:function(){return"[DomPosition("+aa(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function af(au){this.code=this[au];this.codeName=au;this.message="DOMException: "+this.codeName}af.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};af.prototype.toString=function(){return this.message};M.dom={arrayContains:at,isHtmlNamespace:Q,parentElement:ac,getNodeIndex:W,getNodeLength:ae,getCommonAncestor:T,isAncestorOf:S,isOrIsAncestorOf:al,getClosestAncestorIn:aj,isCharacterDataNode:L,isTextOrCommentNode:J,insertAfter:P,splitDataNode:ad,getDocument:aq,getWindow:V,getIframeWindow:ao,getIframeDocument:ar,getBody:O.getBody,isWindow:ah,getContentDocument:ag,getRootContainer:R,comparePoints:ak,isBrokenNode:Y,inspectNode:aa,getComputedStyleProperty:U,fragmentFromNodeChildren:ai,createIterator:am,DomPosition:X};M.DOMException=af});r.createCoreModule("DomRange",["DomUtil"],function(R,N){var L=R.dom;var Z=R.util;var am=L.DomPosition;var aG=R.DOMException;var P=L.isCharacterDataNode;var aj=L.getNodeIndex;var aQ=L.isOrIsAncestorOf;var a1=L.getDocument;var aN=L.comparePoints;var aE=L.splitDataNode;var aM=L.getClosestAncestorIn;var aF=L.getNodeLength;var a2=L.arrayContains;var ad=L.getRootContainer;var au=R.features.crashyTextNodes;function af(a4,a3){return(a4.nodeType!=3)&&(aQ(a4,a3.startContainer)||aQ(a4,a3.endContainer))}function V(a3){return a3.document||a1(a3.startContainer)}function ai(a3){return new am(a3.parentNode,aj(a3))}function aJ(a3){return new am(a3.parentNode,aj(a3)+1)}function S(a4,a6,a5){var a3=a4.nodeType==11?a4.firstChild:a4;if(P(a6)){if(a5==a6.length){L.insertAfter(a4,a6)}else{a6.parentNode.insertBefore(a4,a5==0?a6:aE(a6,a5))}}else{if(a5>=a6.childNodes.length){a6.appendChild(a4)}else{a6.insertBefore(a4,a6.childNodes[a5])}}return a3}function a0(a6,a5,a3){Q(a6);Q(a5);if(V(a5)!=V(a6)){throw new aG("WRONG_DOCUMENT_ERR")}var a7=aN(a6.startContainer,a6.startOffset,a5.endContainer,a5.endOffset),a4=aN(a6.endContainer,a6.endOffset,a5.startContainer,a5.startOffset);return a3?a7<=0&&a4>=0:a7<0&&a4>0}function ap(a5){var a4;for(var a6,a7=V(a5.range).createDocumentFragment(),a3;a6=a5.next();){a4=a5.isPartiallySelectedSubtree();a6=a6.cloneNode(!a4);if(a4){a3=a5.getSubtreeIterator();a6.appendChild(ap(a3));a3.detach()}if(a6.nodeType==10){throw new aG("HIERARCHY_REQUEST_ERR")}a7.appendChild(a6)}return a7}function aI(a4,a7,a3){var a5,a9;a3=a3||{stop:false};for(var a6,a8;a6=a4.next();){if(a4.isPartiallySelectedSubtree()){if(a7(a6)===false){a3.stop=true;return}else{a8=a4.getSubtreeIterator();aI(a8,a7,a3);a8.detach();if(a3.stop){return}}}else{a5=L.createIterator(a6);while((a9=a5.next())){if(a7(a9)===false){a3.stop=true;return}}}}}function W(a4){var a3;while(a4.next()){if(a4.isPartiallySelectedSubtree()){a3=a4.getSubtreeIterator();W(a3);a3.detach()}else{a4.remove()}}}function aB(a4){for(var a5,a6=V(a4.range).createDocumentFragment(),a3;a5=a4.next();){if(a4.isPartiallySelectedSubtree()){a5=a5.cloneNode(false);a3=a4.getSubtreeIterator();a5.appendChild(aB(a3));a3.detach()}else{a4.remove()}if(a5.nodeType==10){throw new aG("HIERARCHY_REQUEST_ERR")}a6.appendChild(a5)}return a6}function Y(a5,a3,a6){var a8=!!(a3&&a3.length),a7;var a9=!!a6;if(a8){a7=new RegExp("^("+a3.join("|")+")$")}var a4=[];aI(new O(a5,false),function(bb){if(a8&&!a7.test(bb.nodeType)){return}if(a9&&!a6(bb)){return}var bc=a5.startContainer;if(bb==bc&&P(bc)&&a5.startOffset==bc.length){return}var ba=a5.endContainer;if(bb==ba&&P(ba)&&a5.endOffset==0){return}a4.push(bb)});return a4}function ah(a3){var a4=(typeof a3.getName=="undefined")?"Range":a3.getName();return"["+a4+"("+L.inspectNode(a3.startContainer)+":"+a3.startOffset+", "+L.inspectNode(a3.endContainer)+":"+a3.endOffset+")]"}function O(a5,a4){this.range=a5;this.clonePartiallySelectedTextNodes=a4;if(!a5.collapsed){this.sc=a5.startContainer;this.so=a5.startOffset;this.ec=a5.endContainer;this.eo=a5.endOffset;var a3=a5.commonAncestorContainer;if(this.sc===this.ec&&P(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=(this.sc===a3&&!P(this.sc))?this.sc.childNodes[this.so]:aM(this.sc,a3,true);this._last=(this.ec===a3&&!P(this.ec))?this.ec.childNodes[this.eo-1]:aM(this.ec,a3,true)}}}O.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return !!this._next},next:function(){var a3=this._current=this._next;if(a3){this._next=(a3!==this._last)?a3.nextSibling:null;if(P(a3)&&this.clonePartiallySelectedTextNodes){if(a3===this.ec){(a3=a3.cloneNode(true)).deleteData(this.eo,a3.length-this.eo)}if(this._current===this.sc){(a3=a3.cloneNode(true)).deleteData(0,this.so)}}}return a3},remove:function(){var a4=this._current,a5,a3;if(P(a4)&&(a4===this.sc||a4===this.ec)){a5=(a4===this.sc)?this.so:0;a3=(a4===this.ec)?this.eo:a4.length;if(a5!=a3){a4.deleteData(a5,a3-a5)}}else{if(a4.parentNode){a4.parentNode.removeChild(a4)}else{}}},isPartiallySelectedSubtree:function(){var a3=this._current;return af(a3,this.range)},getSubtreeIterator:function(){var a4;if(this.isSingleCharacterDataNode){a4=this.range.cloneRange();a4.collapse(false)}else{a4=new aY(V(this.range));var a8=this._current;var a6=a8,a3=0,a7=a8,a5=aF(a8);if(aQ(a8,this.sc)){a6=this.sc;a3=this.so}if(aQ(a8,this.ec)){a7=this.ec;a5=this.eo}al(a4,a6,a3,a7,a5)}return new O(a4,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var aT=[1,3,4,5,7,8,10];var aR=[2,9,11];var ak=[5,6,10,12];var ax=[1,3,4,5,7,8,10,11];var an=[1,3,4,5,7,8];function aL(a3){return function(a5,a7){var a4,a6=a7?a5:a5.parentNode;while(a6){a4=a6.nodeType;if(a2(a3,a4)){return a6}a6=a6.parentNode}return null}}var ar=aL([9,11]);var av=aL(ak);var K=aL([6,10,12]);function ab(a4,a3){if(K(a4,a3)){throw new aG("INVALID_NODE_TYPE_ERR")}}function aH(a3,a4){if(!a2(a4,a3.nodeType)){throw new aG("INVALID_NODE_TYPE_ERR")}}function aS(a3,a4){if(a4<0||a4>(P(a3)?a3.length:a3.childNodes.length)){throw new aG("INDEX_SIZE_ERR")}}function M(a4,a3){if(ar(a4,true)!==ar(a3,true)){throw new aG("WRONG_DOCUMENT_ERR")}}function aP(a3){if(av(a3,true)){throw new aG("NO_MODIFICATION_ALLOWED_ERR")}}function aW(a4,a3){if(!a4){throw new aG(a3)}}function X(a3){return(au&&L.isBrokenNode(a3))||!a2(aR,a3.nodeType)&&!ar(a3,true)}function aZ(a3,a4){return a4<=(P(a3)?a3.length:a3.childNodes.length)}function az(a3){return(!!a3.startContainer&&!!a3.endContainer&&!X(a3.startContainer)&&!X(a3.endContainer)&&aZ(a3.startContainer,a3.startOffset)&&aZ(a3.endContainer,a3.endOffset))}function Q(a3){if(!az(a3)){throw new Error("Range error: Range is no longer valid after DOM mutation ("+a3.inspect()+")")}}var J=document.createElement("style");var aA=false;try{J.innerHTML="<b>x</b>";aA=(J.firstChild.nodeType==3)}catch(aV){}R.features.htmlParsingConforms=aA;var aC=aA?function(a5){var a4=this.startContainer;var a6=a1(a4);if(!a4){throw new aG("INVALID_STATE_ERR")}var a3=null;if(a4.nodeType==1){a3=a4}else{if(P(a4)){a3=L.parentElement(a4)}}if(a3===null||(a3.nodeName=="HTML"&&L.isHtmlNamespace(a1(a3).documentElement)&&L.isHtmlNamespace(a3))){a3=a6.createElement("body")}else{a3=a3.cloneNode(false)}a3.innerHTML=a5;return L.fragmentFromNodeChildren(a3)}:function(a4){var a5=V(this);var a3=a5.createElement("body");a3.innerHTML=a4;return L.fragmentFromNodeChildren(a3)};function aX(a5,a3){Q(a5);var a9=a5.startContainer,a8=a5.startOffset,a6=a5.endContainer,a4=a5.endOffset;var a7=(a9===a6);if(P(a6)&&a4>0&&a4<a6.length){aE(a6,a4,a3)}if(P(a9)&&a8>0&&a8<a9.length){a9=aE(a9,a8,a3);if(a7){a4-=a8;a6=a9}else{if(a6==a9.parentNode&&a4>=aj(a9)){a4++}}a8=0}a5.setStartAndEnd(a9,a8,a6,a4)}function aq(a4){Q(a4);var a3=a4.commonAncestorContainer.parentNode.cloneNode(false);a3.appendChild(a4.cloneContents());return a3.innerHTML}var aw=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var U=0,ag=1,aU=2,aO=3;var ac=0,ae=1,at=2,T=3;Z.extend(R.rangePrototype,{compareBoundaryPoints:function(a8,a5){Q(this);M(this.startContainer,a5.startContainer);var ba,a4,a9,a3;var a7=(a8==aO||a8==U)?"start":"end";var a6=(a8==ag||a8==U)?"start":"end";ba=this[a7+"Container"];a4=this[a7+"Offset"];a9=a5[a6+"Container"];a3=a5[a6+"Offset"];return aN(ba,a4,a9,a3)},insertNode:function(a4){Q(this);aH(a4,ax);aP(this.startContainer);if(aQ(a4,this.startContainer)){throw new aG("HIERARCHY_REQUEST_ERR")}var a3=S(a4,this.startContainer,this.startOffset);this.setStartBefore(a3)},cloneContents:function(){Q(this);var a5,a4;if(this.collapsed){return V(this).createDocumentFragment()}else{if(this.startContainer===this.endContainer&&P(this.startContainer)){a5=this.startContainer.cloneNode(true);a5.data=a5.data.slice(this.startOffset,this.endOffset);a4=V(this).createDocumentFragment();a4.appendChild(a5);return a4}else{var a3=new O(this,true);a5=ap(a3);a3.detach()}return a5}},canSurroundContents:function(){Q(this);aP(this.startContainer);aP(this.endContainer);var a3=new O(this,true);var a4=(a3._first&&(af(a3._first,this))||(a3._last&&af(a3._last,this)));a3.detach();return !a4},surroundContents:function(a4){aH(a4,an);if(!this.canSurroundContents()){throw new aG("INVALID_STATE_ERR")}var a3=this.extractContents();if(a4.hasChildNodes()){while(a4.lastChild){a4.removeChild(a4.lastChild)}}S(a4,this.startContainer,this.startOffset);a4.appendChild(a3);this.selectNode(a4)},cloneRange:function(){Q(this);var a3=new aY(V(this));var a4=aw.length,a5;while(a4--){a5=aw[a4];a3[a5]=this[a5]}return a3},toString:function(){Q(this);var a5=this.startContainer;if(a5===this.endContainer&&P(a5)){return(a5.nodeType==3||a5.nodeType==4)?a5.data.slice(this.startOffset,this.endOffset):""}else{var a3=[],a4=new O(this,true);aI(a4,function(a6){if(a6.nodeType==3||a6.nodeType==4){a3.push(a6.data)}});a4.detach();return a3.join("")}},compareNode:function(a5){Q(this);var a4=a5.parentNode;var a7=aj(a5);if(!a4){throw new aG("NOT_FOUND_ERR")}var a6=this.comparePoint(a4,a7),a3=this.comparePoint(a4,a7+1);if(a6<0){return(a3>0)?at:ac}else{return(a3>0)?ae:T}},comparePoint:function(a3,a4){Q(this);aW(a3,"HIERARCHY_REQUEST_ERR");M(a3,this.startContainer);if(aN(a3,a4,this.startContainer,this.startOffset)<0){return -1}else{if(aN(a3,a4,this.endContainer,this.endOffset)>0){return 1}}return 0},createContextualFragment:aC,toHtml:function(){return aq(this)},intersectsNode:function(a6,a3){Q(this);aW(a6,"NOT_FOUND_ERR");if(a1(a6)!==V(this)){return false}var a5=a6.parentNode,a8=aj(a6);aW(a5,"NOT_FOUND_ERR");var a7=aN(a5,a8,this.endContainer,this.endOffset),a4=aN(a5,a8+1,this.startContainer,this.startOffset);return a3?a7<=0&&a4>=0:a7<0&&a4>0},isPointInRange:function(a3,a4){Q(this);aW(a3,"HIERARCHY_REQUEST_ERR");M(a3,this.startContainer);return(aN(a3,a4,this.startContainer,this.startOffset)>=0)&&(aN(a3,a4,this.endContainer,this.endOffset)<=0)},intersectsRange:function(a3){return a0(this,a3,false)},intersectsOrTouchesRange:function(a3){return a0(this,a3,true)},intersection:function(a3){if(this.intersectsRange(a3)){var a6=aN(this.startContainer,this.startOffset,a3.startContainer,a3.startOffset),a4=aN(this.endContainer,this.endOffset,a3.endContainer,a3.endOffset);var a5=this.cloneRange();if(a6==-1){a5.setStart(a3.startContainer,a3.startOffset)}if(a4==1){a5.setEnd(a3.endContainer,a3.endOffset)}return a5}return null},union:function(a3){if(this.intersectsOrTouchesRange(a3)){var a4=this.cloneRange();if(aN(a3.startContainer,a3.startOffset,this.startContainer,this.startOffset)==-1){a4.setStart(a3.startContainer,a3.startOffset)}if(aN(a3.endContainer,a3.endOffset,this.endContainer,this.endOffset)==1){a4.setEnd(a3.endContainer,a3.endOffset)}return a4}else{throw new aG("Ranges do not intersect")}},containsNode:function(a4,a3){if(a3){return this.intersectsNode(a4,false)}else{return this.compareNode(a4)==T}},containsNodeContents:function(a3){return this.comparePoint(a3,0)>=0&&this.comparePoint(a3,aF(a3))<=0},containsRange:function(a3){var a4=this.intersection(a3);return a4!==null&&a3.equals(a4)},containsNodeText:function(a5){var a6=this.cloneRange();a6.selectNode(a5);var a4=a6.getNodes([3]);if(a4.length>0){a6.setStart(a4[0],0);var a3=a4.pop();a6.setEnd(a3,a3.length);return this.containsRange(a6)}else{return this.containsNodeContents(a5)}},getNodes:function(a3,a4){Q(this);return Y(this,a3,a4)},getDocument:function(){return V(this)},collapseBefore:function(a3){this.setEndBefore(a3);this.collapse(false)},collapseAfter:function(a3){this.setStartAfter(a3);this.collapse(true)},getBookmark:function(a3){var a7=V(this);var a5=R.createRange(a7);a3=a3||L.getBody(a7);a5.selectNodeContents(a3);var a6=this.intersection(a5);var a8=0,a4=0;if(a6){a5.setEnd(a6.startContainer,a6.startOffset);a8=a5.toString().length;a4=a8+a6.toString().length}return{start:a8,end:a4,containerNode:a3}},moveToBookmark:function(ba){var a6=ba.containerNode;var a3=0;this.setStart(a6,0);this.collapse(true);var a8=[a6],a4,a5=false,bb=false;var a9,a7,bc;while(!bb&&(a4=a8.pop())){if(a4.nodeType==3){a9=a3+a4.length;if(!a5&&ba.start>=a3&&ba.start<=a9){this.setStart(a4,ba.start-a3);a5=true}if(a5&&ba.end>=a3&&ba.end<=a9){this.setEnd(a4,ba.end-a3);bb=true}a3=a9}else{bc=a4.childNodes;a7=bc.length;while(a7--){a8.push(bc[a7])}}}},getName:function(){return"DomRange"},equals:function(a3){return aY.rangesEqual(this,a3)},isValid:function(){return az(this)},inspect:function(){return ah(this)},detach:function(){}});function aD(a3){a3.START_TO_START=U;a3.START_TO_END=ag;a3.END_TO_END=aU;a3.END_TO_START=aO;a3.NODE_BEFORE=ac;a3.NODE_AFTER=ae;a3.NODE_BEFORE_AND_AFTER=at;a3.NODE_INSIDE=T}function ao(a3){aD(a3);aD(a3.prototype)}function aa(a3,a4){return function(){Q(this);var ba=this.startContainer,a9=this.startOffset,a5=this.commonAncestorContainer;var a7=new O(this,true);var a8,bb;if(ba!==a5){a8=aM(ba,a5,true);bb=aJ(a8);ba=bb.node;a9=bb.offset}aI(a7,aP);a7.reset();var a6=a3(a7);a7.detach();a4(this,ba,a9,ba,a9);return a6}}function aK(a4,a8){function a7(ba,a9){return function(bb){aH(bb,aT);aH(ad(bb),aR);var bc=(ba?ai:aJ)(bb);(a9?a3:a6)(this,bc.node,bc.offset)}}function a3(ba,bc,bd){var bb=ba.endContainer,a9=ba.endOffset;if(bc!==ba.startContainer||bd!==ba.startOffset){if(ad(bc)!=ad(bb)||aN(bc,bd,bb,a9)==1){bb=bc;a9=bd}a8(ba,bc,bd,bb,a9)}}function a6(a9,ba,bd){var bc=a9.startContainer,bb=a9.startOffset;if(ba!==a9.endContainer||bd!==a9.endOffset){if(ad(ba)!=ad(bc)||aN(ba,bd,bc,bb)==-1){bc=ba;bb=bd}a8(a9,bc,bb,ba,bd)}}var a5=function(){};a5.prototype=R.rangePrototype;a4.prototype=new a5();Z.extend(a4.prototype,{setStart:function(a9,ba){ab(a9,true);aS(a9,ba);a3(this,a9,ba)},setEnd:function(a9,ba){ab(a9,true);aS(a9,ba);a6(this,a9,ba)},setStartAndEnd:function(){var bb=arguments;var bd=bb[0],bc=bb[1],ba=bd,a9=bc;switch(bb.length){case 3:a9=bb[2];break;case 4:ba=bb[2];a9=bb[3];break}a8(this,bd,bc,ba,a9)},setBoundary:function(ba,bb,a9){this["set"+(a9?"Start":"End")](ba,bb)},setStartBefore:a7(true,true),setStartAfter:a7(false,true),setEndBefore:a7(true,false),setEndAfter:a7(false,false),collapse:function(a9){Q(this);if(a9){a8(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset)}else{a8(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)}},selectNodeContents:function(a9){ab(a9,true);a8(this,a9,0,a9,aF(a9))},selectNode:function(ba){ab(ba,false);aH(ba,aT);var bb=ai(ba),a9=aJ(ba);a8(this,bb.node,bb.offset,a9.node,a9.offset)},extractContents:aa(aB,a8),deleteContents:aa(W,a8),canSurroundContents:function(){Q(this);aP(this.startContainer);aP(this.endContainer);var a9=new O(this,true);var ba=(a9._first&&af(a9._first,this)||(a9._last&&af(a9._last,this)));a9.detach();return !ba},splitBoundaries:function(){aX(this)},splitBoundariesPreservingPositions:function(a9){aX(this,a9)},normalizeBoundaries:function(){Q(this);var bg=this.startContainer,bb=this.startOffset,bf=this.endContainer,a9=this.endOffset;var bc=function(bj){var bi=bj.nextSibling;if(bi&&bi.nodeType==bj.nodeType){bf=bj;a9=bj.length;bj.appendData(bi.data);bi.parentNode.removeChild(bi)}};var bh=function(bk){var bj=bk.previousSibling;if(bj&&bj.nodeType==bk.nodeType){bg=bk;var bi=bk.length;bb=bj.length;bk.insertData(0,bj.data);bj.parentNode.removeChild(bj);if(bg==bf){a9+=bb;bf=bg}else{if(bf==bk.parentNode){var bl=aj(bk);if(a9==bl){bf=bk;a9=bi}else{if(a9>bl){a9--}}}}}};var be=true;if(P(bf)){if(bf.length==a9){bc(bf)}}else{if(a9>0){var bd=bf.childNodes[a9-1];if(bd&&P(bd)){bc(bd)}}be=!this.collapsed}if(be){if(P(bg)){if(bb==0){bh(bg)}}else{if(bb<bg.childNodes.length){var ba=bg.childNodes[bb];if(ba&&P(ba)){bh(ba)}}}}else{bg=bf;bb=a9}a8(this,bg,bb,bf,a9)},collapseToPoint:function(a9,ba){ab(a9,true);aS(a9,ba);this.setStartAndEnd(a9,ba)}});ao(a4)}function ay(a3){a3.collapsed=(a3.startContainer===a3.endContainer&&a3.startOffset===a3.endOffset);a3.commonAncestorContainer=a3.collapsed?a3.startContainer:L.getCommonAncestor(a3.startContainer,a3.endContainer)}function al(a4,a6,a3,a7,a5){a4.startContainer=a6;a4.startOffset=a3;a4.endContainer=a7;a4.endOffset=a5;a4.document=L.getDocument(a6);ay(a4)}function aY(a3){this.startContainer=a3;this.startOffset=0;this.endContainer=a3;this.endOffset=0;this.document=a3;ay(this)}aK(aY,al);Z.extend(aY,{rangeProperties:aw,RangeIterator:O,copyComparisonConstants:ao,createPrototypeRange:aK,inspect:ah,toHtml:aq,getRangeDocument:V,rangesEqual:function(a4,a3){return a4.startContainer===a3.startContainer&&a4.startOffset===a3.startOffset&&a4.endContainer===a3.endContainer&&a4.endOffset===a3.endOffset}});R.DomRange=aY});r.createCoreModule("WrappedRange",["DomRange"],function(V,N){var J,K;var R=V.dom;var S=V.util;var M=R.DomPosition;var X=V.DomRange;var T=R.getBody;var Z=R.getContentDocument;var U=R.isCharacterDataNode;if(V.features.implementsDomRange){(function(){var ad;var ak=X.rangeProperties;function aa(am){var an=ak.length,ao;while(an--){ao=ak[an];am[ao]=am.nativeRange[ao]}am.collapsed=(am.startContainer===am.endContainer&&am.startOffset===am.endOffset)}function af(ao,ar,an,at,ap){var am=(ao.startContainer!==ar||ao.startOffset!=an);var au=(ao.endContainer!==at||ao.endOffset!=ap);var aq=!ao.equals(ao.nativeRange);if(am||au||aq){ao.setEnd(at,ap);ao.setStart(ar,an)}}var ac;J=function(am){if(!am){throw N.createError("WrappedRange: Range must be specified")}this.nativeRange=am;aa(this)};X.createPrototypeRange(J,af);ad=J.prototype;ad.selectNode=function(am){this.nativeRange.selectNode(am);aa(this)};ad.cloneContents=function(){return this.nativeRange.cloneContents()};ad.surroundContents=function(am){this.nativeRange.surroundContents(am);aa(this)};ad.collapse=function(am){this.nativeRange.collapse(am);aa(this)};ad.cloneRange=function(){return new J(this.nativeRange.cloneRange())};ad.refresh=function(){aa(this)};ad.toString=function(){return this.nativeRange.toString()};var aj=document.createTextNode("test");T(document).appendChild(aj);var ag=document.createRange();ag.setStart(aj,0);ag.setEnd(aj,0);try{ag.setStart(aj,1);ad.setStart=function(am,an){this.nativeRange.setStart(am,an);aa(this)};ad.setEnd=function(am,an){this.nativeRange.setEnd(am,an);aa(this)};ac=function(am){return function(an){this.nativeRange[am](an);aa(this)}}}catch(ai){ad.setStart=function(an,ao){try{this.nativeRange.setStart(an,ao)}catch(am){this.nativeRange.setEnd(an,ao);this.nativeRange.setStart(an,ao)}aa(this)};ad.setEnd=function(an,ao){try{this.nativeRange.setEnd(an,ao)}catch(am){this.nativeRange.setStart(an,ao);this.nativeRange.setEnd(an,ao)}aa(this)};ac=function(am,an){return function(ap){try{this.nativeRange[am](ap)}catch(ao){this.nativeRange[an](ap);this.nativeRange[am](ap)}aa(this)}}}ad.setStartBefore=ac("setStartBefore","setEndBefore");ad.setStartAfter=ac("setStartAfter","setEndAfter");ad.setEndBefore=ac("setEndBefore","setStartBefore");ad.setEndAfter=ac("setEndAfter","setStartAfter");ad.selectNodeContents=function(am){this.setStartAndEnd(am,0,R.getNodeLength(am))};ag.selectNodeContents(aj);ag.setEnd(aj,3);var al=document.createRange();al.selectNodeContents(aj);al.setEnd(aj,4);al.setStart(aj,2);if(ag.compareBoundaryPoints(ag.START_TO_END,al)==-1&&ag.compareBoundaryPoints(ag.END_TO_START,al)==1){ad.compareBoundaryPoints=function(an,am){am=am.nativeRange||am;if(an==am.START_TO_END){an=am.END_TO_START}else{if(an==am.END_TO_START){an=am.START_TO_END}}return this.nativeRange.compareBoundaryPoints(an,am)}}else{ad.compareBoundaryPoints=function(an,am){return this.nativeRange.compareBoundaryPoints(an,am.nativeRange||am)}}var ab=document.createElement("div");ab.innerHTML="123";var ae=ab.firstChild;var ah=T(document);ah.appendChild(ab);ag.setStart(ae,1);ag.setEnd(ae,2);ag.deleteContents();if(ae.data=="13"){ad.deleteContents=function(){this.nativeRange.deleteContents();aa(this)};ad.extractContents=function(){var am=this.nativeRange.extractContents();aa(this);return am}}else{}ah.removeChild(ab);ah=null;if(S.isHostMethod(ag,"createContextualFragment")){ad.createContextualFragment=function(am){return this.nativeRange.createContextualFragment(am)}}T(document).removeChild(aj);ad.getName=function(){return"WrappedRange"};V.WrappedRange=J;V.createNativeRange=function(am){am=Z(am,N,"createNativeRange");return am.createRange()}})()}if(V.features.implementsTextRange){var O=function(af){var ad=af.parentElement();var ab=af.duplicate();ab.collapse(true);var ae=ab.parentElement();ab=af.duplicate();ab.collapse(false);var ac=ab.parentElement();var aa=(ae==ac)?ae:R.getCommonAncestor(ae,ac);return aa==ad?aa:R.getCommonAncestor(ad,aa)};var L=function(aa){return aa.compareEndPoints("StartToEnd",aa)==0};var P=function(aa,am,ak,ab,ae){var an=aa.duplicate();an.collapse(ak);var ac=an.parentElement();if(!R.isOrIsAncestorOf(am,ac)){ac=am}if(!ac.canHaveHTML){var aj=new M(ac.parentNode,R.getNodeIndex(ac));return{boundaryPosition:aj,nodeInfo:{nodeIndex:aj.offset,containerElement:aj.node}}}var ad=R.getDocument(ac).createElement("span");if(ad.parentNode){ad.parentNode.removeChild(ad)}var aw,au=ak?"StartToStart":"StartToEnd";var ao,af,al,ap;var ah=(ae&&ae.containerElement==ac)?ae.nodeIndex:0;var aq=ac.childNodes.length;var ag=aq;var at=ag;while(true){if(at==aq){ac.appendChild(ad)}else{ac.insertBefore(ad,ac.childNodes[at])}an.moveToElementText(ad);aw=an.compareEndPoints(au,aa);if(aw==0||ah==ag){break}else{if(aw==-1){if(ag==ah+1){break}else{ah=at}}else{ag=(ag==ah+1)?ah:at}}at=Math.floor((ah+ag)/2);ac.removeChild(ad)}ap=ad.nextSibling;if(aw==-1&&ap&&U(ap)){an.setEndPoint(ak?"EndToStart":"EndToEnd",aa);var ai;if(/[\r\n]/.test(ap.data)){var ar=an.duplicate();var av=ar.text.replace(/\r\n/g,"\r").length;ai=ar.moveStart("character",av);while((aw=ar.compareEndPoints("StartToEnd",ar))==-1){ai++;ar.moveStart("character",1)}}else{ai=an.text.length}al=new M(ap,ai)}else{ao=(ab||!ak)&&ad.previousSibling;af=(ab||ak)&&ad.nextSibling;if(af&&U(af)){al=new M(af,0)}else{if(ao&&U(ao)){al=new M(ao,ao.data.length)}else{al=new M(ac,R.getNodeIndex(ad))}}}ad.parentNode.removeChild(ad);return{boundaryPosition:al,nodeInfo:{nodeIndex:at,containerElement:ac}}};var Y=function(aa,ac){var ad,ag,ae=aa.offset;var ah=R.getDocument(aa.node);var ab,ai,aj=T(ah).createTextRange();var af=U(aa.node);if(af){ad=aa.node;ag=ad.parentNode}else{ai=aa.node.childNodes;ad=(ae<ai.length)?ai[ae]:null;ag=aa.node}ab=ah.createElement("span");ab.innerHTML="&#feff;";if(ad){ag.insertBefore(ab,ad)}else{ag.appendChild(ab)}aj.moveToElementText(ab);aj.collapse(!ac);ag.removeChild(ab);if(af){aj[ac?"moveStart":"moveEnd"]("character",ae)}return aj};K=function(aa){this.textRange=aa;this.refresh()};K.prototype=new X(document);K.prototype.refresh=function(){var ad,aa,ac;var ab=O(this.textRange);if(L(this.textRange)){aa=ad=P(this.textRange,ab,true,true).boundaryPosition}else{ac=P(this.textRange,ab,true,false);ad=ac.boundaryPosition;aa=P(this.textRange,ab,false,false,ac.nodeInfo).boundaryPosition}this.setStart(ad.node,ad.offset);this.setEnd(aa.node,aa.offset)};K.prototype.getName=function(){return"WrappedTextRange"};X.copyComparisonConstants(K);var W=function(aa){if(aa.collapsed){return Y(new M(aa.startContainer,aa.startOffset),true)}else{var ad=Y(new M(aa.startContainer,aa.startOffset),true);var ac=Y(new M(aa.endContainer,aa.endOffset),false);var ab=T(X.getRangeDocument(aa)).createTextRange();ab.setEndPoint("StartToStart",ad);ab.setEndPoint("EndToEnd",ac);return ab}};K.rangeToTextRange=W;K.prototype.toTextRange=function(){return W(this)};V.WrappedTextRange=K;if(!V.features.implementsDomRange||V.config.preferTextRange){var Q=(function(){return this})();if(typeof Q.Range=="undefined"){Q.Range=K}V.createNativeRange=function(aa){aa=Z(aa,N,"createNativeRange");return T(aa).createTextRange()};V.WrappedRange=K}}V.createRange=function(aa){aa=Z(aa,N,"createRange");return new V.WrappedRange(V.createNativeRange(aa))};V.createRangyRange=function(aa){aa=Z(aa,N,"createRangyRange");return new X(aa)};V.createIframeRange=function(aa){N.deprecationNotice("createIframeRange()","createRange(iframeEl)");return V.createRange(aa)};V.createIframeRangyRange=function(aa){N.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)");return V.createRangyRange(aa)};V.addShimListener(function(ab){var aa=ab.document;if(typeof aa.createRange=="undefined"){aa.createRange=function(){return V.createRange(aa)}}aa=ab=null})});r.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(S,M){S.config.checkSelectionRanges=true;var ar="boolean";var av="number";var L=S.dom;var X=S.util;var aG=X.isHostMethod;var aK=S.DomRange;var O=S.WrappedRange;var aF=S.DOMException;var am=L.DomPosition;var aC;var Z;var W=S.features;var aS="Control";var aR=L.getDocument;var aQ=L.getBody;var ax=aK.rangesEqual;function P(aU){return(typeof aU=="string")?/^backward(s)?$/i.test(aU):!!aU}function ai(aW,aU){if(!aW){return window}else{if(L.isWindow(aW)){return aW}else{if(aW instanceof ao){return aW.win}else{var aV=L.getContentDocument(aW,M,aU);return L.getWindow(aV)}}}}function Y(aU){return ai(aU,"getWinSelection").getSelection()}function ac(aU){return ai(aU,"getDocSelection").document.selection}function aP(aU){var aV=false;if(aU.anchorNode){aV=(L.comparePoints(aU.anchorNode,aU.anchorOffset,aU.focusNode,aU.focusOffset)==1)}return aV}var aN=aG(window,"getSelection"),aE=X.isHostObject(document,"selection");W.implementsWinGetSelection=aN;W.implementsDocSelection=aE;var af=aE&&(!aN||S.config.preferTextRange);if(af){aC=ac;S.isSelectionValid=function(aV){var aW=ai(aV,"isSelectionValid").document,aU=aW.selection;return(aU.type!="None"||aR(aU.createRange().parentElement())==aW)}}else{if(aN){aC=Y;S.isSelectionValid=function(){return true}}else{M.fail("Neither document.selection or window.getSelection() detected.")}}S.getNativeSelection=aC;var aD=aC();var ap=S.createNativeRange(document);var aq=aQ(document);var aA=X.areHostProperties(aD,["anchorNode","focusNode","anchorOffset","focusOffset"]);W.selectionHasAnchorAndFocus=aA;var ab=aG(aD,"extend");W.selectionHasExtend=ab;var aT=(typeof aD.rangeCount==av);W.selectionHasRangeCount=aT;var aJ=false;var aH=true;var aj=ab?function(aX,aU){var aW=aK.getRangeDocument(aU);var aV=S.createRange(aW);aV.collapseToPoint(aU.endContainer,aU.endOffset);aX.addRange(az(aV));aX.extend(aU.startContainer,aU.startOffset)}:null;if(X.areHostMethods(aD,["addRange","getRangeAt","removeAllRanges"])&&typeof aD.rangeCount==av&&W.implementsDomRange){(function(){var aV=window.getSelection();if(aV){var aZ=aV.rangeCount;var a1=(aZ>1);var a3=[];var a5=aP(aV);for(var a0=0;a0<aZ;++a0){a3[a0]=aV.getRangeAt(a0)}var a2=aQ(document);var aY=a2.appendChild(document.createElement("div"));aY.contentEditable="false";var aX=aY.appendChild(document.createTextNode("\u00a0\u00a0\u00a0"));var aW=document.createRange();aW.setStart(aX,1);aW.collapse(true);aV.addRange(aW);aH=(aV.rangeCount==1);aV.removeAllRanges();if(!a1){var a4=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(a4&&parseInt(a4[1])>=36){aJ=false}else{var aU=aW.cloneRange();aW.setStart(aX,0);aU.setEnd(aX,3);aU.setStart(aX,2);aV.addRange(aW);aV.addRange(aU);aJ=(aV.rangeCount==2)}}a2.removeChild(aY);aV.removeAllRanges();for(a0=0;a0<aZ;++a0){if(a0==0&&a5){if(aj){aj(aV,a3[a0])}else{S.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend");aV.addRange(a3[a0])}}else{aV.addRange(a3[a0])}}}})()}W.selectionSupportsMultipleRanges=aJ;W.collapsedNonEditableSelectionsSupported=aH;var R=false,U;if(aq&&aG(aq,"createControlRange")){U=aq.createControlRange();if(X.areHostProperties(U,["item","add"])){R=true}}W.implementsControlRange=R;if(aA){Z=function(aU){return aU.anchorNode===aU.focusNode&&aU.anchorOffset===aU.focusOffset}}else{Z=function(aU){return aU.rangeCount?aU.getRangeAt(aU.rangeCount-1).collapsed:false}}function K(aW,aU,aX){var aV=aX?"end":"start",aY=aX?"start":"end";aW.anchorNode=aU[aV+"Container"];aW.anchorOffset=aU[aV+"Offset"];aW.focusNode=aU[aY+"Container"];aW.focusOffset=aU[aY+"Offset"]}function ah(aV){var aU=aV.nativeSelection;aV.anchorNode=aU.anchorNode;aV.anchorOffset=aU.anchorOffset;aV.focusNode=aU.focusNode;aV.focusOffset=aU.focusOffset}function aw(aU){aU.anchorNode=aU.focusNode=null;aU.anchorOffset=aU.focusOffset=0;aU.rangeCount=0;aU.isCollapsed=true;aU._ranges.length=0}function az(aU){var aV;if(aU instanceof aK){aV=S.createNativeRange(aU.getDocument());aV.setEnd(aU.endContainer,aU.endOffset);aV.setStart(aU.startContainer,aU.startOffset)}else{if(aU instanceof O){aV=aU.nativeRange}else{if(W.implementsDomRange&&(aU instanceof L.getWindow(aU.startContainer).Range)){aV=aU}}}return aV}function V(aW){if(!aW.length||aW[0].nodeType!=1){return false}for(var aV=1,aU=aW.length;aV<aU;++aV){if(!L.isAncestorOf(aW[0],aW[aV])){return false}}return true}function aB(aV){var aU=aV.getNodes();if(!V(aU)){throw M.createError("getSingleElementFromRange: range "+aV.inspect()+" did not consist of a single element")}return aU[0]}function au(aU){return !!aU&&typeof aU.text!="undefined"}function ay(aW,aV){var aU=new O(aV);aW._ranges=[aU];K(aW,aU,false);aW.rangeCount=1;aW.isCollapsed=aU.collapsed}function ae(aX){aX._ranges.length=0;if(aX.docSelection.type=="None"){aw(aX)}else{var aW=aX.docSelection.createRange();if(au(aW)){ay(aX,aW)}else{aX.rangeCount=aW.length;var aU,aY=aR(aW.item(0));for(var aV=0;aV<aX.rangeCount;++aV){aU=S.createRange(aY);aU.selectNode(aW.item(aV));aX._ranges.push(aU)}aX.isCollapsed=aX.rangeCount==1&&aX._ranges[0].collapsed;K(aX,aX._ranges[aX.rangeCount-1],false)}}}function al(aV,aY){var aW=aV.docSelection.createRange();var aU=aB(aY);var a2=aR(aW.item(0));var aZ=aQ(a2).createControlRange();for(var aX=0,a0=aW.length;aX<a0;++aX){aZ.add(aW.item(aX))}try{aZ.add(aU)}catch(a1){throw M.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}aZ.select();ae(aV)}var aa;if(aG(aD,"getRangeAt")){aa=function(aW,aU){try{return aW.getRangeAt(aU)}catch(aV){return null}}}else{if(aA){aa=function(aV){var aW=aR(aV.anchorNode);var aU=S.createRange(aW);aU.setStartAndEnd(aV.anchorNode,aV.anchorOffset,aV.focusNode,aV.focusOffset);if(aU.collapsed!==this.isCollapsed){aU.setStartAndEnd(aV.focusNode,aV.focusOffset,aV.anchorNode,aV.anchorOffset)}return aU}}}function ao(aU,aW,aV){this.nativeSelection=aU;this.docSelection=aW;this._ranges=[];this.win=aV;this.refresh()}ao.prototype=S.selectionPrototype;function ak(aU){aU.win=aU.anchorNode=aU.focusNode=aU._ranges=null;aU.rangeCount=aU.anchorOffset=aU.focusOffset=0;aU.detached=true}var aO=[];function aI(aY,aX){var aU=aO.length,aV,aW;while(aU--){aV=aO[aU];aW=aV.selection;if(aX=="deleteAll"){ak(aW)}else{if(aV.win==aY){if(aX=="delete"){aO.splice(aU,1);return true}else{return aW}}}}if(aX=="deleteAll"){aO.length=0}return null}var ag=function(aW){if(aW&&aW instanceof ao){aW.refresh();return aW}aW=ai(aW,"getNativeSelection");var aV=aI(aW);var aU=aC(aW),aX=aE?ac(aW):null;if(aV){aV.nativeSelection=aU;aV.docSelection=aX;aV.refresh()}else{aV=new ao(aU,aX,aW);aO.push({win:aW,selection:aV})}return aV};S.getSelection=ag;S.getIframeSelection=function(aU){M.deprecationNotice("getIframeSelection()","getSelection(iframeEl)");return S.getSelection(L.getIframeWindow(aU))};var J=ao.prototype;function T(a0,aV){var a1=aR(aV[0].startContainer);var aY=aQ(a1).createControlRange();for(var aX=0,aZ,aU=aV.length;aX<aU;++aX){aZ=aB(aV[aX]);try{aY.add(aZ)}catch(aW){throw M.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}aY.select();ae(a0)}if(!af&&aA&&X.areHostMethods(aD,["removeAllRanges","addRange"])){J.removeAllRanges=function(){this.nativeSelection.removeAllRanges();aw(this)};var N=function(aV,aU){aj(aV.nativeSelection,aU);aV.refresh()};if(aT){J.addRange=function(aU,aX){if(R&&aE&&this.docSelection.type==aS){al(this,aU)}else{if(P(aX)&&ab){N(this,aU)}else{var aV;if(aJ){aV=this.rangeCount}else{this.removeAllRanges();aV=0}this.nativeSelection.addRange(az(aU).cloneRange());this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==aV+1){if(S.config.checkSelectionRanges){var aW=aa(this.nativeSelection,this.rangeCount-1);if(aW&&!ax(aW,aU)){aU=new O(aW)}}this._ranges[this.rangeCount-1]=aU;K(this,aU,Q(this.nativeSelection));this.isCollapsed=Z(this)}else{this.refresh()}}}}}else{J.addRange=function(aU,aV){if(P(aV)&&ab){N(this,aU)}else{this.nativeSelection.addRange(az(aU));this.refresh()}}}J.setRanges=function(aV){if(R&&aE&&aV.length>1){T(this,aV)}else{this.removeAllRanges();for(var aW=0,aU=aV.length;aW<aU;++aW){this.addRange(aV[aW])}}}}else{if(aG(aD,"empty")&&aG(ap,"select")&&R&&af){J.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var aX;if(this.anchorNode){aX=aR(this.anchorNode)}else{if(this.docSelection.type==aS){var aV=this.docSelection.createRange();if(aV.length){aX=aR(aV.item(0))}}}if(aX){var aW=aQ(aX).createTextRange();aW.select();this.docSelection.empty()}}}catch(aU){}aw(this)};J.addRange=function(aU){if(this.docSelection.type==aS){al(this,aU)}else{S.WrappedTextRange.rangeToTextRange(aU).select();this._ranges[0]=aU;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;K(this,aU,false)}};J.setRanges=function(aU){this.removeAllRanges();var aV=aU.length;if(aV>1){T(this,aU)}else{if(aV){this.addRange(aU[0])}}}}else{M.fail("No means of selecting a Range or TextRange was found");return false}}J.getRangeAt=function(aU){if(aU<0||aU>=this.rangeCount){throw new aF("INDEX_SIZE_ERR")}else{return this._ranges[aU].cloneRange()}};var at;if(af){at=function(aV){var aU;if(S.isSelectionValid(aV.win)){aU=aV.docSelection.createRange()}else{aU=aQ(aV.win.document).createTextRange();aU.collapse(true)}if(aV.docSelection.type==aS){ae(aV)}else{if(au(aU)){ay(aV,aU)}else{aw(aV)}}}}else{if(aG(aD,"getRangeAt")&&typeof aD.rangeCount==av){at=function(aW){if(R&&aE&&aW.docSelection.type==aS){ae(aW)}else{aW._ranges.length=aW.rangeCount=aW.nativeSelection.rangeCount;if(aW.rangeCount){for(var aV=0,aU=aW.rangeCount;aV<aU;++aV){aW._ranges[aV]=new S.WrappedRange(aW.nativeSelection.getRangeAt(aV))}K(aW,aW._ranges[aW.rangeCount-1],Q(aW.nativeSelection));aW.isCollapsed=Z(aW)}else{aw(aW)}}}}else{if(aA&&typeof aD.isCollapsed==ar&&typeof ap.collapsed==ar&&W.implementsDomRange){at=function(aW){var aU,aV=aW.nativeSelection;if(aV.anchorNode){aU=aa(aV,0);aW._ranges=[aU];aW.rangeCount=1;ah(aW);aW.isCollapsed=Z(aW)}else{aw(aW)}}}else{M.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}}}J.refresh=function(aV){var aU=aV?this._ranges.slice(0):null;var aX=this.anchorNode,aY=this.anchorOffset;at(this);if(aV){var aW=aU.length;if(aW!=this._ranges.length){return true}if(this.anchorNode!=aX||this.anchorOffset!=aY){return true}while(aW--){if(!ax(aU[aW],this._ranges[aW])){return true}}return false}};var an=function(aY,aW){var aV=aY.getAllRanges();aY.removeAllRanges();for(var aX=0,aU=aV.length;aX<aU;++aX){if(!ax(aW,aV[aX])){aY.addRange(aV[aX])}}if(!aY.rangeCount){aw(aY)}};if(R&&aE){J.removeRange=function(aY){if(this.docSelection.type==aS){var aW=this.docSelection.createRange();var aU=aB(aY);var a2=aR(aW.item(0));var a0=aQ(a2).createControlRange();var aV,a1=false;for(var aX=0,aZ=aW.length;aX<aZ;++aX){aV=aW.item(aX);if(aV!==aU||a1){a0.add(aW.item(aX))}else{a1=true}}a0.select();ae(this)}else{an(this,aY)}}}else{J.removeRange=function(aU){an(this,aU)}}var Q;if(!af&&aA&&W.implementsDomRange){Q=aP;J.isBackward=function(){return Q(this)}}else{Q=J.isBackward=function(){return false}}J.isBackwards=J.isBackward;J.toString=function(){var aW=[];for(var aV=0,aU=this.rangeCount;aV<aU;++aV){aW[aV]=""+this._ranges[aV]}return aW.join("")};function aL(aV,aU){if(aV.win.document!=aR(aU)){throw new aF("WRONG_DOCUMENT_ERR")}}J.collapse=function(aV,aW){aL(this,aV);var aU=S.createRange(aV);aU.collapseToPoint(aV,aW);this.setSingleRange(aU);this.isCollapsed=true};J.collapseToStart=function(){if(this.rangeCount){var aU=this._ranges[0];this.collapse(aU.startContainer,aU.startOffset)}else{throw new aF("INVALID_STATE_ERR")}};J.collapseToEnd=function(){if(this.rangeCount){var aU=this._ranges[this.rangeCount-1];this.collapse(aU.endContainer,aU.endOffset)}else{throw new aF("INVALID_STATE_ERR")}};J.selectAllChildren=function(aV){aL(this,aV);var aU=S.createRange(aV);aU.selectNodeContents(aV);this.setSingleRange(aU)};J.deleteFromDocument=function(){if(R&&aE&&this.docSelection.type==aS){var aY=this.docSelection.createRange();var aX;while(aY.length){aX=aY.item(0);aY.remove(aX);aX.parentNode.removeChild(aX)}this.refresh()}else{if(this.rangeCount){var aV=this.getAllRanges();if(aV.length){this.removeAllRanges();for(var aW=0,aU=aV.length;aW<aU;++aW){aV[aW].deleteContents()}this.addRange(aV[aU-1])}}}};J.eachRange=function(aX,aW){for(var aV=0,aU=this._ranges.length;aV<aU;++aV){if(aX(this.getRangeAt(aV))){return aW}}};J.getAllRanges=function(){var aU=[];this.eachRange(function(aV){aU.push(aV)});return aU};J.setSingleRange=function(aU,aV){this.removeAllRanges();this.addRange(aU,aV)};J.callMethodOnEachRange=function(aU,aW){var aV=[];this.eachRange(function(aX){aV.push(aX[aU].apply(aX,aW))});return aV};function aM(aU){return function(aW,aX){var aV;if(this.rangeCount){aV=this.getRangeAt(0);aV["set"+(aU?"Start":"End")](aW,aX)}else{aV=S.createRange(this.win.document);aV.setStartAndEnd(aW,aX)}this.setSingleRange(aV,this.isBackward())}}J.setStart=aM(true);J.setEnd=aM(false);S.rangePrototype.select=function(aU){ag(this.getDocument()).setSingleRange(this,aU)};J.changeEachRange=function(aV){var aU=[];var aW=this.isBackward();this.eachRange(function(aX){aV(aX);aU.push(aX)});this.removeAllRanges();if(aW&&aU.length==1){this.addRange(aU[0],"backward")}else{this.setRanges(aU)}};J.containsNode=function(aV,aU){return this.eachRange(function(aW){return aW.containsNode(aV,aU)},true)||false};J.getBookmark=function(aU){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[aU])}};J.moveToBookmark=function(aY){var aU=[];for(var aX=0,aW,aV;aW=aY.rangeBookmarks[aX++];){aV=S.createRange(this.win);aV.moveToBookmark(aW);aU.push(aV)}if(aY.backward){this.setSingleRange(aU[0],"backward")}else{this.setRanges(aU)}};J.toHtml=function(){var aU=[];this.eachRange(function(aV){aU.push(aK.toHtml(aV))});return aU.join("")};if(W.implementsTextRange){J.getNativeTextRange=function(){var aW,aV;if((aW=this.docSelection)){var aU=aW.createRange();if(au(aU)){return aU}else{throw M.createError("getNativeTextRange: selection is a control selection")}}else{if(this.rangeCount>0){return S.WrappedTextRange.rangeToTextRange(this.getRangeAt(0))}else{throw M.createError("getNativeTextRange: selection contains no range")}}}}function ad(a0){var aZ=[];var aX=new am(a0.anchorNode,a0.anchorOffset);var aV=new am(a0.focusNode,a0.focusOffset);var aW=(typeof a0.getName=="function")?a0.getName():"Selection";if(typeof a0.rangeCount!="undefined"){for(var aY=0,aU=a0.rangeCount;aY<aU;++aY){aZ[aY]=aK.inspect(a0.getRangeAt(aY))}}return"["+aW+"(Ranges: "+aZ.join(", ")+")(anchor: "+aX.inspect()+", focus: "+aV.inspect()+"]"}J.getName=function(){return"WrappedSelection"};J.inspect=function(){return ad(this)};J.detach=function(){aI(this.win,"delete");ak(this)};ao.detachAll=function(){aI(null,"deleteAll")};ao.inspect=ad;ao.isDirectionBackward=P;S.Selection=ao;S.selectionPrototype=J;S.addShimListener(function(aU){if(typeof aU.getSelection=="undefined"){aU.getSelection=function(){return ag(aU)}}aU=null})});return r},this);(function(a,b){if(typeof define=="function"&&define.amd){define(["rangy"],a)}else{a(b.rangy)}})(function(a){a.createModule("SaveRestore",["WrappedRange"],function(k,h){var j=k.dom;var e="\ufeff";function r(t,s){return(s||document).getElementById(t)}function f(u,s){var v="selectionBoundary_"+(+new Date())+"_"+(""+Math.random()).slice(2);var t;var x=j.getDocument(u.startContainer);var w=u.cloneRange();w.collapse(s);t=x.createElement("span");t.id=v;t.style.lineHeight="0";t.style.display="none";t.className="rangySelectionBoundary";t.appendChild(x.createTextNode(e));w.insertNode(t);return t}function o(w,u,v,s){var t=r(v,w);if(t){u[s?"setStartBefore":"setEndBefore"](t);t.parentNode.removeChild(t)}else{h.warn("Marker element has been removed. Cannot restore selection.")}}function g(t,s){return s.compareBoundaryPoints(t.START_TO_START,t)}function m(s,x){var u,t,v=k.DomRange.getRangeDocument(s),w=s.toString();if(s.collapsed){t=f(s,false);return{document:v,markerId:t.id,collapsed:true}}else{t=f(s,false);u=f(s,true);return{document:v,startMarkerId:u.id,endMarkerId:t.id,collapsed:false,backward:x,toString:function(){return"original text: '"+w+"', new text: '"+s.toString()+"'"}}}}function q(w,v){var x=w.document;if(typeof v=="undefined"){v=true}var u=k.createRange(x);if(w.collapsed){var t=r(w.markerId,x);if(t){t.style.display="inline";var s=t.previousSibling;if(s&&s.nodeType==3){t.parentNode.removeChild(t);u.collapseToPoint(s,s.length)}else{u.collapseBefore(t);t.parentNode.removeChild(t)}}else{h.warn("Marker element has been removed. Cannot restore selection.")}}else{o(x,u,w.startMarkerId,true);o(x,u,w.endMarkerId,false)}if(v){u.normalizeBoundaries()}return u}function d(t,y){var w=[],u,x;t=t.slice(0);t.sort(g);for(var v=0,s=t.length;v<s;++v){w[v]=m(t[v],y)}for(v=s-1;v>=0;--v){u=t[v];x=k.DomRange.getRangeDocument(u);if(u.collapsed){u.collapseAfter(r(w[v].markerId,x))}else{u.setEndBefore(r(w[v].endMarkerId,x));u.setStartAfter(r(w[v].startMarkerId,x))}}return w}function i(v){if(!k.isSelectionValid(v)){h.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.");return null}var u=k.getSelection(v);var s=u.getAllRanges();var w=(s.length==1&&u.isBackward());var t=d(s,w);if(w){u.setSingleRange(s[0],"backward")}else{u.setRanges(s)}return{win:v,rangeInfos:t,restored:false}}function p(v){var s=[];var t=v.length;for(var u=t-1;u>=0;u--){s[u]=q(v[u],true)}return s}function b(s,v){if(!s.restored){var w=s.rangeInfos;var x=k.getSelection(s.win);var t=p(w),u=w.length;if(u==1&&v&&k.features.selectionHasExtend&&w[0].backward){x.removeAllRanges();x.addRange(t[0],true)}else{x.setRanges(t)}s.restored=true}}function l(u,t){var s=r(t,u);if(s){s.parentNode.removeChild(s)}}function n(t){var w=t.rangeInfos;for(var v=0,s=w.length,u;v<s;++v){u=w[v];if(u.collapsed){l(t.doc,u.markerId)}else{l(t.doc,u.startMarkerId);l(t.doc,u.endMarkerId)}}}k.util.extend(k,{saveRange:m,restoreRange:q,saveRanges:d,restoreRanges:p,saveSelection:i,restoreSelection:b,removeMarkerElement:l,removeMarkers:n})})},this);var Base=function(){};Base.extend=function(b,f){var g=Base.prototype.extend;Base._prototyping=true;var e=new this;g.call(e,b);e.base=function(){};delete Base._prototyping;var d=e.constructor;var a=e.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==a){this._constructing=true;d.apply(this,arguments);delete this._constructing}else{if(arguments[0]!=null){return(arguments[0].extend||g).call(arguments[0],e)}}}};a.ancestor=this;a.extend=this.extend;a.forEach=this.forEach;a.implement=this.implement;a.prototype=e;a.toString=this.toString;a.valueOf=function(h){return(h=="object")?a:d.valueOf()};g.call(a,f);if(typeof a.init=="function"){a.init()}return a};Base.prototype={extend:function(b,j){if(arguments.length>1){var f=this[b];if(f&&(typeof j=="function")&&(!f.valueOf||f.valueOf()!=j.valueOf())&&/\bbase\b/.test(j)){var a=j.valueOf();j=function(){var l=this.base||Base.prototype.base;this.base=f;var i=a.apply(this,arguments);this.base=l;return i};j.valueOf=function(i){return(i=="object")?j:a};j.toString=Base.toString}this[b]=j}else{if(b){var h=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){h=this.extend||h}var e={toSource:null};var g=["constructor","toString","valueOf"];var d=Base._prototyping?0:1;while(k=g[d++]){if(b[k]!=e[k]){h.call(this,k,b[k])}}for(var k in b){if(!e[k]){h.call(this,k,b[k])}}}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,e,d){for(var b in a){if(this.prototype[b]===undefined){e.call(d,a[b],b,a)}}},implement:function(){for(var a=0;a<arguments.length;a++){if(typeof arguments[a]=="function"){arguments[a](this.prototype)}else{this.prototype.extend(arguments[a])}}return this},toString:function(){return String(this.valueOf())}});wysihtml5.browser=(function(){var j=navigator.userAgent,e=document.createElement("div"),b=j.indexOf("Gecko")!==-1&&j.indexOf("KHTML")===-1,g=j.indexOf("AppleWebKit/")!==-1,a=j.indexOf("Chrome/")!==-1,d=j.indexOf("Opera/")!==-1;function i(k){return +((/ipad|iphone|ipod/.test(k)&&k.match(/ os (\d+).+? like mac os x/))||[undefined,0])[1]}function h(k){return +(k.match(/android (\d+)/)||[undefined,0])[1]}function f(k,l){var n=-1,m;if(navigator.appName=="Microsoft Internet Explorer"){m=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})")}else{if(navigator.appName=="Netscape"){m=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")}}if(m&&m.exec(navigator.userAgent)!=null){n=parseFloat(RegExp.$1)}if(n===-1){return false}if(!k){return true}if(!l){return k===n}if(l==="<"){return k<n}if(l===">"){return k>n}if(l==="<="){return k<=n}if(l===">="){return k>=n}}return{USER_AGENT:j,supported:function(){var m=this.USER_AGENT.toLowerCase(),o="contentEditable" in e,k=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,l=document.querySelector&&document.querySelectorAll,n=(this.isIos()&&i(m)<5)||(this.isAndroid()&&h(m)<4)||m.indexOf("opera mobi")!==-1||m.indexOf("hpwos/")!==-1;return o&&k&&l&&!n},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return(/ipad|iphone|ipod/i).test(this.USER_AGENT)},isAndroid:function(){return this.USER_AGENT.indexOf("Android")!==-1},supportsSandboxedIframes:function(){return f()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return !("querySelector" in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return f()},hasCurrentStyleProperty:function(){return"currentStyle" in e},hasHistoryIssue:function(){return b&&navigator.platform.substr(0,3)==="Mac"},insertsLineBreaksOnReturn:function(){return b},supportsPlaceholderAttributeOn:function(k){return"placeholder" in k},supportsEvent:function(k){return"on"+k in e||(function(){e.setAttribute("on"+k,"return;");return typeof(e["on"+k])==="function"})()},supportsEventsInIframeCorrectly:function(){return !d},supportsHTML5Tags:function(m){var l=m.createElement("div"),k="<article>foo</article>";l.innerHTML=k;return l.innerHTML.toLowerCase()===k},supportsCommand:(function(){var l={formatBlock:f(10,"<="),insertUnorderedList:f(),insertOrderedList:f()};var k={insertHTML:b};return function(n,p){var q=l[p];if(!q){try{return n.queryCommandSupported(p)}catch(o){}try{return n.queryCommandEnabled(p)}catch(m){return !!k[p]}}return false}})(),doesAutoLinkingInContentEditable:function(){return f()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return b||d||g},supportsGetAttributeCorrectly:function(){var k=document.createElement("td");return k.getAttribute("rowspan")!="1"},canSelectImagesInContentEditable:function(){return b||f()||d},autoScrollsToCaret:function(){return !g},autoClosesUnclosedTags:function(){var m=e.cloneNode(false),k,l;m.innerHTML="<p><div></div>";l=m.innerHTML.toLowerCase();k=l==="<p></p><div></div>"||l==="<p><div></div></p>";this.autoClosesUnclosedTags=function(){return k};return k},supportsNativeGetElementsByClassName:function(){return String(document.getElementsByClassName).indexOf("[native code]")!==-1},supportsSelectionModify:function(){return"getSelection" in window&&"modify" in window.getSelection()},needsSpaceAfterLineBreak:function(){return d},supportsSpeechApiOn:function(k){var l=j.match(/Chrome\/(\d+)/)||[undefined,0];return l[1]>=11&&("onwebkitspeechchange" in k||"speech" in k)},crashesWhenDefineProperty:function(k){return f(9)&&(k==="XMLHttpRequest"||k==="XDomainRequest")},doesAsyncFocus:function(){return f()},hasProblemsSettingCaretAfterImg:function(){return f()},hasUndoInContextMenu:function(){return b||a||d},hasInsertNodeIssue:function(){return d},hasIframeFocusIssue:function(){return f()},createsNestedInvalidMarkupAfterPaste:function(){return g},supportsMutationEvents:function(){return("MutationEvent" in window)},supportsModenPaste:function(){return !("clipboardData" in window)}}})();wysihtml5.lang.array=function(a){return{contains:function(d){if(Array.isArray(d)){for(var b=d.length;b--;){if(wysihtml5.lang.array(a).indexOf(d[b])!==-1){return true}}return false}else{return wysihtml5.lang.array(a).indexOf(d)!==-1}},indexOf:function(e){if(a.indexOf){return a.indexOf(e)}else{for(var b=0,d=a.length;b<d;b++){if(a[b]===e){return b}}return -1}},without:function(b){b=wysihtml5.lang.array(b);var e=[],d=0,f=a.length;for(;d<f;d++){if(!b.contains(a[d])){e.push(a[d])}}return e},get:function(){var d=0,e=a.length,b=[];for(;d<e;d++){b.push(a[d])}return b},map:function(g,e){if(Array.prototype.map){return a.map(g,e)}else{var d=a.length>>>0,b=new Array(d),f=0;for(;f<d;f++){b[f]=g.call(e,a[f],f,a)}return b}},unique:function(){var e=[],d=a.length,b=0;while(b<d){if(!wysihtml5.lang.array(e).contains(a[b])){e.push(a[b])}b++}return e}}};wysihtml5.lang.Dispatcher=Base.extend({on:function(a,b){this.events=this.events||{};this.events[a]=this.events[a]||[];this.events[a].push(b);return this},off:function(b,e){this.events=this.events||{};var d=0,a,f;if(b){a=this.events[b]||[],f=[];for(;d<a.length;d++){if(a[d]!==e&&e){f.push(a[d])}}this.events[b]=f}else{this.events={}}return this},fire:function(b,e){this.events=this.events||{};var a=this.events[b]||[],d=0;for(;d<a.length;d++){a[d].call(this,e)}return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}});wysihtml5.lang.object=function(a){return{merge:function(b){for(var d in b){a[d]=b[d]}return this},get:function(){return a},clone:function(b){var d={},e;if(a===null||!wysihtml5.lang.object(a).isPlainObject()){return a}for(e in a){if(a.hasOwnProperty(e)){if(b){d[e]=wysihtml5.lang.object(a[e]).clone(b)}else{d[e]=a[e]}}}return d},isArray:function(){return Object.prototype.toString.call(a)==="[object Array]"},isFunction:function(){return Object.prototype.toString.call(a)==="[object Function]"},isPlainObject:function(){return Object.prototype.toString.call(a)==="[object Object]"}}};(function(){var e=/^\s+/,d=/\s+$/,a=/[&<>\t"]/g,b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml5.lang.string=function(f){f=String(f);return{trim:function(){return f.replace(e,"").replace(d,"")},interpolate:function(h){for(var g in h){f=this.replace("#{"+g+"}").by(h[g])}return f},replace:function(g){return{by:function(h){return f.split(g).join(h)}}},escapeHTML:function(g,i){var h=f.replace(a,function(j){return b[j]});if(g){h=h.replace(/(?:\r\n|\r|\n)/g,"<br />")}if(i){h=h.replace(/  /gi,"&nbsp; ")}return h}}}})();(function(m){var k=m.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),l=/((https?:\/\/|www\.)[^\s<]{3,})/gi,f=/([^\w\/\-](,?))$/i,d=100,g={")":"(","]":"[","}":"{"};function b(n,o){if(j(n,o)){return n}if(n===n.ownerDocument.documentElement){n=n.ownerDocument.body}return a(n,o)}function h(n){return n.replace(l,function(q,p){var s=(p.match(f)||[])[1]||"",o=g[s];p=p.replace(f,"");if(p.split(o).length>p.split(s).length){p=p+s;s=""}var r=p,t=p;if(p.length>d){t=t.substr(0,d)+"..."}if(r.substr(0,4)==="www."){r="http://"+r}return'<a href="'+r+'">'+t+"</a>"+s})}function e(o){var n=o._wysihtml5_tempElement;if(!n){n=o._wysihtml5_tempElement=o.createElement("div")}return n}function i(q){var o=q.parentNode,p=m.lang.string(q.data).escapeHTML(),n=e(o.ownerDocument);n.innerHTML="<span></span>"+h(p);n.removeChild(n.firstChild);while(n.firstChild){o.insertBefore(n.firstChild,q)}o.removeChild(q)}function j(n,p){var o;while(n.parentNode){n=n.parentNode;o=n.nodeName;if(n.className&&m.lang.array(n.className.split(" ")).contains(p)){return true}if(k.contains(o)){return true}else{if(o==="body"){return false}}}return false}function a(o,r){if(k.contains(o.nodeName)){return}if(o.className&&m.lang.array(o.className.split(" ")).contains(r)){return}if(o.nodeType===m.TEXT_NODE&&o.data.match(l)){i(o);return}var q=m.lang.array(o.childNodes).get(),p=q.length,n=0;for(;n<p;n++){a(q[n],r)}return o}m.dom.autoLink=b;m.dom.autoLink.URL_REG_EXP=l})(wysihtml5);(function(b){var a=b.dom;a.addClass=function(d,e){var f=d.classList;if(f){return f.add(e)}if(a.hasClass(d,e)){return}d.className+=" "+e};a.removeClass=function(d,e){var f=d.classList;if(f){return f.remove(e)}d.className=d.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ")};a.hasClass=function(d,e){var g=d.classList;if(g){return g.contains(e)}var f=d.className;return(f.length>0&&(f==e||new RegExp("(^|\\s)"+e+"(\\s|$)").test(f)))}})(wysihtml5);wysihtml5.dom.contains=(function(){var a=document.documentElement;if(a.contains){return function(b,d){if(d.nodeType!==wysihtml5.ELEMENT_NODE){d=d.parentNode}return b!==d&&b.contains(d)}}else{if(a.compareDocumentPosition){return function(b,d){return !!(b.compareDocumentPosition(d)&16)}}}})();wysihtml5.dom.convertToList=(function(){function b(g,f){var e=g.createElement("li");f.appendChild(e);return e}function d(f,e){return f.createElement(e)}function a(g,p,h){if(g.nodeName==="UL"||g.nodeName==="OL"||g.nodeName==="MENU"){return g}var r=g.ownerDocument,m=d(r,p),n=g.querySelectorAll("br"),l=n.length,t,s,e,o,k,u,j,q,f;for(f=0;f<l;f++){o=n[f];while((k=o.parentNode)&&k!==g&&k.lastChild===o){if(wysihtml5.dom.getStyle("display").from(k)==="block"){k.removeChild(o);break}wysihtml5.dom.insert(o).after(o.parentNode)}}t=wysihtml5.lang.array(g.childNodes).get();s=t.length;for(f=0;f<s;f++){q=q||b(r,m);e=t[f];u=wysihtml5.dom.getStyle("display").from(e)==="block";j=e.nodeName==="BR";if(u&&(!h||!wysihtml5.dom.hasClass(e,h))){q=q.firstChild?b(r,m):q;q.appendChild(e);q=null;continue}if(j){q=q.firstChild?null:q;continue}q.appendChild(e)}if(t.length===0){b(r,m)}g.parentNode.replaceChild(m,g);return m}return a})();wysihtml5.dom.copyAttributes=function(a){return{from:function(b){return{to:function(d){var g,e=0,f=a.length;for(;e<f;e++){g=a[e];if(typeof(b[g])!=="undefined"&&b[g]!==""){d[g]=b[g]}}return{andTo:arguments.callee}}}}}};(function(b){var e=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"];var d=function(f){if(a(f)){return parseInt(b.getStyle("width").from(f),10)<f.offsetWidth}return false};var a=function(g){var f=0,h=e.length;for(;f<h;f++){if(b.getStyle(e[f]).from(g)==="border-box"){return e[f]}}};b.copyStyles=function(f){return{from:function(h){if(d(h)){f=wysihtml5.lang.array(f).without(e)}var j="",k=f.length,g=0,l;for(;g<k;g++){l=f[g];j+=l+":"+b.getStyle(l).from(h)+";"}return{to:function(i){b.setStyles(j).on(i);return{andTo:arguments.callee}}}}}}})(wysihtml5.dom);(function(a){a.dom.delegate=function(d,b,e,f){return a.dom.observe(d,e,function(h){var i=h.target,g=a.lang.array(d.querySelectorAll(b));while(i&&i!==d){if(g.contains(i)){f.call(i,h);break}i=i.parentNode}})}})(wysihtml5);(function(a){a.dom.domNode=function(d){var e=[a.ELEMENT_NODE,a.TEXT_NODE];var b=function(f){return f.nodeType===a.TEXT_NODE&&(/^\s*$/g).test(f.data)};return{prev:function(g){var f=d.previousSibling,h=(g&&g.nodeTypes)?g.nodeTypes:e;if(!f){return null}if((!a.lang.array(h).contains(f.nodeType))||(g&&g.ignoreBlankTexts&&b(f))){return a.dom.domNode(f).prev(g)}return f},next:function(g){var f=d.nextSibling,h=(g&&g.nodeTypes)?g.nodeTypes:e;if(!f){return null}if((!a.lang.array(h).contains(f.nodeType))||(g&&g.ignoreBlankTexts&&b(f))){return a.dom.domNode(f).next(g)}return f}}}})(wysihtml5);wysihtml5.dom.getAsDom=(function(){var a=function(h,g){var f=g.createElement("div");f.style.display="none";g.body.appendChild(f);try{f.innerHTML=h}catch(i){}g.body.removeChild(f);return f};var d=function(f){if(f._wysihtml5_supportsHTML5Tags){return}for(var e=0,g=b.length;e<g;e++){f.createElement(b[e])}f._wysihtml5_supportsHTML5Tags=true};var b=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(g,f){f=f||document;var e;if(typeof(g)==="object"&&g.nodeType){e=f.createElement("div");e.appendChild(g)}else{if(wysihtml5.browser.supportsHTML5Tags(f)){e=f.createElement("div");e.innerHTML=g}else{d(f);e=a(g,f)}}return e}})();wysihtml5.dom.getParentElement=(function(){function a(g,f){if(!f||!f.length){return true}if(typeof(f)==="string"){return g===f}else{return wysihtml5.lang.array(f).contains(g)}}function e(f){return f.nodeType===wysihtml5.ELEMENT_NODE}function d(f,g,h){var i=(f.className||"").match(h)||[];if(!g){return !!i.length}return i[i.length-1]===g}function b(g,i,f){var h=(g.getAttribute("style")||"").match(f)||[];if(!i){return !!h.length}return h[h.length-1]===i}return function(i,g,j,f){var h=(g.cssStyle||g.styleRegExp),k=(g.className||g.classRegExp);j=j||50;while(j--&&i&&i.nodeName!=="BODY"&&(!f||i!==f)){if(e(i)&&a(i.nodeName,g.nodeName)&&(!h||b(i,g.cssStyle,g.styleRegExp))&&(!k||d(i,g.className,g.classRegExp))){return i}i=i.parentNode}return null}})();wysihtml5.dom.getStyle=(function(){var b={"float":("styleFloat" in document.createElement("div").style)?"styleFloat":"cssFloat"},d=/\-[a-z]/g;function a(e){return e.replace(d,function(f){return f.charAt(1).toUpperCase()})}return function(e){return{from:function(j){if(j.nodeType!==wysihtml5.ELEMENT_NODE){return}var o=j.ownerDocument,k=b[e]||a(e),g=j.style,h=j.currentStyle,p=g[k];if(p){return p}if(h){try{return h[k]}catch(m){}}var l=o.defaultView||o.parentWindow,n=(e==="height"||e==="width")&&j.nodeName==="TEXTAREA",i,f;if(l.getComputedStyle){if(n){i=g.overflow;g.overflow="hidden"}f=l.getComputedStyle(j,null).getPropertyValue(e);if(n){g.overflow=i||""}return f}}}}})();wysihtml5.dom.getTextNodes=function(d,a){var b=[];for(d=d.firstChild;d;d=d.nextSibling){if(d.nodeType==3){if(!a||!(/^\s*$/).test(d.innerText||d.textContent)){b.push(d)}}else{b=b.concat(wysihtml5.dom.getTextNodes(d,a))}}return b};wysihtml5.dom.hasElementWithTagName=(function(){var d={},b=1;function a(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=b++)}return function(g,f){var e=a(g)+":"+f,h=d[e];if(!h){h=d[e]=g.getElementsByTagName(f)}return h.length>0}})();(function(e){var d={},b=1;function a(f){return f._wysihtml5_identifier||(f._wysihtml5_identifier=b++)}e.dom.hasElementWithClassName=function(h,g){if(!e.browser.supportsNativeGetElementsByClassName()){return !!h.querySelector("."+g)}var f=a(h)+":"+g,i=d[f];if(!i){i=d[f]=h.getElementsByClassName(g)}return i.length>0}})(wysihtml5);wysihtml5.dom.insert=function(a){return{after:function(b){b.parentNode.insertBefore(a,b.nextSibling)},before:function(b){b.parentNode.insertBefore(a,b)},into:function(b){b.appendChild(a)}}};wysihtml5.dom.insertCSS=function(a){a=a.join("\n");return{into:function(f){var b=f.createElement("style");b.type="text/css";if(b.styleSheet){b.styleSheet.cssText=a}else{b.appendChild(f.createTextNode(a))}var e=f.querySelector("head link");if(e){e.parentNode.insertBefore(b,e);return}else{var d=f.querySelector("head");if(d){d.appendChild(b)}}}}};(function(a){a.dom.lineBreaks=function(d){function e(f){return f.nodeName==="BR"}function b(f){if(e(f)){return true}if(a.dom.getStyle("display").from(f)==="block"){return true}return false}return{add:function(f){var i=d.ownerDocument,h=a.dom.domNode(d).next({ignoreBlankTexts:true}),g=a.dom.domNode(d).prev({ignoreBlankTexts:true});if(h&&!b(h)){a.dom.insert(i.createElement("br")).after(d)}if(g&&!b(g)){a.dom.insert(i.createElement("br")).before(d)}},remove:function(f){var h=a.dom.domNode(d).next({ignoreBlankTexts:true}),g=a.dom.domNode(d).prev({ignoreBlankTexts:true});if(h&&e(h)){h.parentNode.removeChild(h)}if(g&&e(g)){g.parentNode.removeChild(g)}}}}})(wysihtml5);wysihtml5.dom.observe=function(d,h,e){h=typeof(h)==="string"?[h]:h;var g,a,b=0,f=h.length;for(;b<f;b++){a=h[b];if(d.addEventListener){d.addEventListener(a,e,false)}else{g=function(i){if(!("target" in i)){i.target=i.srcElement}i.preventDefault=i.preventDefault||function(){this.returnValue=false};i.stopPropagation=i.stopPropagation||function(){this.cancelBubble=true};e.call(d,i)};d.attachEvent("on"+a,g)}}return{stop:function(){var j,k=0,l=h.length;for(;k<l;k++){j=h[k];if(d.removeEventListener){d.removeEventListener(j,e,false)}else{d.detachEvent("on"+j,g)}}}}};wysihtml5.dom.parse=function(o,B){var n={"1":k,"3":j,"8":i},a="span",r=/\s+/,m={tags:{},classes:{}},d={};function p(I,F){wysihtml5.lang.object(d).merge(m).merge(F.rules).get();var C=F.context||I.ownerDocument||document,H=C.createDocumentFragment(),D=typeof(I)==="string",K=false,G,L,J;if(F.clearInternals===true){K=true}if(D){G=wysihtml5.dom.getAsDom(I,C)}else{G=I}if(d.selectors){w(G,d.selectors)}while(G.firstChild){J=G.firstChild;L=y(J,F.cleanUp,K,F.uneditableClass);if(L){H.appendChild(L)}if(J!==L){G.removeChild(J)}}if(F.unjoinNbsps){var M=wysihtml5.dom.getTextNodes(H);for(var E=M.length;E--;){M[E].nodeValue=M[E].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ")}}G.innerHTML="";G.appendChild(H);return D?wysihtml5.quirks.getCorrectInnerHTML(G):G}function y(E,D,L,G){var M=E.nodeType,K=E.childNodes,J=K.length,C=n[M],F=0,I,N,H;if(G&&M===1&&wysihtml5.dom.hasClass(E,G)){return E}N=C&&C(E,L);if(!N){if(N===false){I=E.ownerDocument.createDocumentFragment();for(F=J;F--;){if(K[F]){H=y(K[F],D,L,G);if(H){if(K[F]===H){F--}I.insertBefore(H,I.firstChild)}}}if(wysihtml5.dom.getStyle("display").from(E)==="block"){I.appendChild(E.ownerDocument.createElement("br"))}if(wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(E.nodeName.toLowerCase())&&E.parentNode.lastChild!==E){if(!E.nextSibling||E.nextSibling.nodeType!==3||!(/^\s/).test(E.nextSibling.nodeValue)){I.appendChild(E.ownerDocument.createTextNode(" "))}}if(I.normalize){I.normalize()}return I}else{return null}}for(F=0;F<J;F++){if(K[F]){H=y(K[F],D,L,G);if(H){if(K[F]===H){F--}N.appendChild(H)}}}if(D&&N.nodeName.toLowerCase()===a&&(!N.childNodes.length||((/^\s*$/gi).test(N.innerHTML)&&(L||(E.className!=="_wysihtml5-temp-placeholder"&&E.className!=="rangySelectionBoundary")))||!N.attributes.length)){I=N.ownerDocument.createDocumentFragment();while(N.firstChild){I.appendChild(N.firstChild)}if(I.normalize){I.normalize()}return I}if(N.normalize){N.normalize()}return N}function w(E,G){var F,H,D;for(F in G){if(G.hasOwnProperty(F)){if(wysihtml5.lang.object(G[F]).isFunction()){H=G[F]}else{if(typeof(G[F])==="string"&&h[G[F]]){H=h[G[F]]}}D=E.querySelectorAll(F);for(var C=D.length;C--;){H(D[C])}}}}function k(H,J){var G,E,D=d.tags,I=H.nodeName.toLowerCase(),C=H.scopeName,F;if(H._wysihtml5){return null}H._wysihtml5=1;if(H.className==="wysihtml5-temp"){return null}if(C&&C!="HTML"){I=C+":"+I}if("outerHTML" in H){if(!wysihtml5.browser.autoClosesUnclosedTags()&&H.nodeName==="P"&&H.outerHTML.slice(-4).toLowerCase()!=="</p>"){I="div"}}if(I in D){G=D[I];if(!G||G.remove){return null}else{if(G.unwrap){return false}}G=typeof(G)==="string"?{rename_tag:G}:G}else{if(H.firstChild){G={rename_tag:a}}else{return null}}if(G.one_of_type&&!q(H,d,G.one_of_type,J)){if(G.remove_action){if(G.remove_action==="unwrap"){return false}else{if(G.remove_action==="rename"){F=G.remove_action_rename_to||a}else{return null}}}else{return null}}E=H.ownerDocument.createElement(F||G.rename_tag||I);f(H,E,G,J);v(H,E,G);H=null;if(E.normalize){E.normalize()}return E}function q(F,G,D,H){var C,E;if(F.nodeName==="SPAN"&&!H&&(F.className==="_wysihtml5-temp-placeholder"||F.className==="rangySelectionBoundary")){return true}for(E in D){if(D.hasOwnProperty(E)&&G.type_definitions&&G.type_definitions[E]){C=G.type_definitions[E];if(s(F,C)){return true}}}return false}function g(C,E){var D=C.length;while(D--){if(C[D]===E){return true}}return false}function s(H,E){var M=H.getAttribute("class"),D=H.getAttribute("style"),L,P,N,O,K,I,G;if(E.methods){for(var F in E.methods){if(E.methods.hasOwnProperty(F)&&t[F]){if(t[F](H)){return true}}}}if(M&&E.classes){M=M.replace(/^\s+/g,"").replace(/\s+$/g,"").split(r);L=M.length;for(var J=0;J<L;J++){if(E.classes[M[J]]){return true}}}if(D&&E.styles){D=D.split(";");for(P in E.styles){if(E.styles.hasOwnProperty(P)){for(var C=D.length;C--;){G=D[C].split(":");if(G[0].replace(/\s/g,"").toLowerCase()===P){if(E.styles[P]===true||E.styles[P]===1||wysihtml5.lang.array(E.styles[P]).contains(G[1].replace(/\s/g,"").toLowerCase())){return true}}}}}}if(E.attrs){for(O in E.attrs){if(E.attrs.hasOwnProperty(O)){K=wysihtml5.dom.getAttribute(H,O);if(typeof(K)==="string"){if(K.search(E.attrs[O])>-1){return true}}}}}return false}function v(G,D,F){var E,C;if(F&&F.keep_styles){for(E in F.keep_styles){if(F.keep_styles.hasOwnProperty(E)){C=(E==="float")?G.style.styleFloat||G.style.cssFloat:G.style[E];if(F.keep_styles[E] instanceof RegExp&&!(F.keep_styles[E].test(C))){continue}if(E==="float"){D.style[(G.style.styleFloat)?"styleFloat":"cssFloat"]=C}else{if(G.style[E]){D.style[E]=C}}}}}}function z(F,E){var D=[];for(var C in E){if(E.hasOwnProperty(C)&&C.indexOf(F)===0){D.push(C)}}return D}function b(D,E,C,H){var G=x[C],F;if(G){if(E||(D==="alt"&&H=="IMG")){F=G(E);if(typeof(F)==="string"){return F}}}return false}function u(D,E){var M=wysihtml5.lang.object(d.attributes||{}).clone(),L=wysihtml5.lang.object(M).merge(wysihtml5.lang.object(E||{}).clone()).get(),G={},I=wysihtml5.dom.getAttributes(D),J,C,K;for(J in L){if((/\*$/).test(J)){K=z(J.slice(0,-1),I);for(var H=0,F=K.length;H<F;H++){C=b(K[H],I[K[H]],L[J],D.nodeName);if(C!==false){G[K[H]]=C}}}else{C=b(J,I[J],L[J],D.nodeName);if(C!==false){G[J]=C}}}return G}function f(O,C,G,P){var J={},W=G.set_class,M=G.add_class,R=G.add_style,T=G.set_attributes,F=d.classes,S=0,V=[],K=[],X=[],Q=[],H,L,E,I,N,D;if(T){J=wysihtml5.lang.object(T).clone()}J=wysihtml5.lang.object(J).merge(u(O,G.check_attributes)).get();if(W){V.push(W)}if(M){for(N in M){D=A[M[N]];if(!D){continue}I=D(wysihtml5.dom.getAttribute(O,N));if(typeof(I)==="string"){V.push(I)}}}if(R){for(N in R){D=l[R[N]];if(!D){continue}newStyle=D(wysihtml5.dom.getAttribute(O,N));if(typeof(newStyle)==="string"){K.push(newStyle)}}}if(typeof(F)==="string"&&F==="any"&&O.getAttribute("class")){if(d.classes_blacklist){Q=O.getAttribute("class");if(Q){V=V.concat(Q.split(r))}H=V.length;for(;S<H;S++){E=V[S];if(!d.classes_blacklist[E]){X.push(E)}}if(X.length){J["class"]=wysihtml5.lang.array(X).unique().join(" ")}}else{J["class"]=O.getAttribute("class")}}else{if(!P){F["_wysihtml5-temp-placeholder"]=1;F._rangySelectionBoundary=1;F["wysiwyg-tmp-selected-cell"]=1}Q=O.getAttribute("class");if(Q){V=V.concat(Q.split(r))}H=V.length;for(;S<H;S++){E=V[S];if(F[E]){X.push(E)}}if(X.length){J["class"]=wysihtml5.lang.array(X).unique().join(" ")}}if(J["class"]&&P){J["class"]=J["class"].replace("wysiwyg-tmp-selected-cell","");if((/^\s*$/g).test(J["class"])){delete J["class"]}}if(K.length){J.style=wysihtml5.lang.array(K).unique().join(" ")}for(N in J){try{C.setAttribute(N,J[N])}catch(U){}}if(J.src){if(typeof(J.width)!=="undefined"){C.setAttribute("width",J.width)}if(typeof(J.height)!=="undefined"){C.setAttribute("height",J.height)}}}var e=/\uFEFF/g;function j(E){var D=E.nextSibling;if(D&&D.nodeType===wysihtml5.TEXT_NODE){D.data=E.data.replace(e,"")+D.data.replace(e,"")}else{var C=E.data.replace(e,"");return E.ownerDocument.createTextNode(C)}}function i(C){if(d.comments){return C.ownerDocument.createComment(C.nodeValue)}}var x={url:(function(){var C=/^https?:\/\//i;return function(D){if(!D||!D.match(C)){return null}return D.replace(C,function(E){return E.toLowerCase()})}})(),src:(function(){var C=/^(\/|https?:\/\/)/i;return function(D){if(!D||!D.match(C)){return null}return D.replace(C,function(E){return E.toLowerCase()})}})(),href:(function(){var C=/^(#|\/|https?:\/\/|mailto:)/i;return function(D){if(!D||!D.match(C)){return null}return D.replace(C,function(E){return E.toLowerCase()})}})(),alt:(function(){var C=/[^ a-z0-9_\-]/gi;return function(D){if(!D){return""}return D.replace(C,"")}})(),numbers:(function(){var C=/\D/g;return function(D){D=(D||"").replace(C,"");return D||null}})(),any:(function(){return function(C){return C}})()};var l={align_text:(function(){var C={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(D){return C[String(D).toLowerCase()]}})(),};var A={align_img:(function(){var C={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(D){return C[String(D).toLowerCase()]}})(),align_text:(function(){var C={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(D){return C[String(D).toLowerCase()]}})(),clear_br:(function(){var C={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(D){return C[String(D).toLowerCase()]}})(),size_font:(function(){var C={"1":"wysiwyg-font-size-xx-small","2":"wysiwyg-font-size-small","3":"wysiwyg-font-size-medium","4":"wysiwyg-font-size-large","5":"wysiwyg-font-size-x-large","6":"wysiwyg-font-size-xx-large","7":"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(D){return C[String(D).charAt(0)]}})()};var t={has_visible_contet:(function(){var D,C=false,E=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"];return function(G){D=(G.innerText||G.textContent).replace(/\s/g,"");if(D&&D.length>0){return true}for(var F=E.length;F--;){if(G.querySelector(E[F])){return true}}if(G.offsetWidth&&G.offsetWidth>0&&G.offsetHeight&&G.offsetHeight>0){return true}return false}})()};var h={unwrap:function(C){wysihtml5.dom.unwrap(C)},remove:function(C){C.parentNode.removeChild(C)}};return p(o,B)};wysihtml5.dom.removeEmptyTextNodes=function(d){var b,f=wysihtml5.lang.array(d.childNodes).get(),e=f.length,a=0;for(;a<e;a++){b=f[a];if(b.nodeType===wysihtml5.TEXT_NODE&&b.data===""){b.parentNode.removeChild(b)}}};wysihtml5.dom.renameElement=function(a,b){var e=a.ownerDocument.createElement(b),d;while(d=a.firstChild){e.appendChild(d)}wysihtml5.dom.copyAttributes(["align","className"]).from(a).to(e);a.parentNode.replaceChild(e,a);return e};wysihtml5.dom.replaceWithChildNodes=function(b){if(!b.parentNode){return}if(!b.firstChild){b.parentNode.removeChild(b);return}var a=b.ownerDocument.createDocumentFragment();while(b.firstChild){a.appendChild(b.firstChild)}b.parentNode.replaceChild(a,b);b=a=null};(function(f){function d(g){return f.getStyle("display").from(g)==="block"}function e(g){return g.nodeName==="BR"}function b(h){var g=h.ownerDocument.createElement("br");h.appendChild(g)}function a(m,p){if(!m.nodeName.match(/^(MENU|UL|OL)$/)){return}var q=m.ownerDocument,n=q.createDocumentFragment(),h=wysihtml5.dom.domNode(m).prev({ignoreBlankTexts:true}),o,i,j,k,l,g;if(p){if(h&&!d(h)&&!e(h)){b(n)}while(g=(m.firstElementChild||m.firstChild)){i=g.lastChild;while(o=g.firstChild){j=o===i;k=j&&!d(o)&&!e(o);n.appendChild(o);if(k){b(n)}}g.parentNode.removeChild(g)}}else{while(g=(m.firstElementChild||m.firstChild)){if(g.querySelector&&g.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6")){while(o=g.firstChild){n.appendChild(o)}}else{l=q.createElement("p");while(o=g.firstChild){l.appendChild(o)}n.appendChild(l)}g.parentNode.removeChild(g)}}m.parentNode.replaceChild(n,m)}f.resolveList=a})(wysihtml5.dom);(function(f){var e=document,d=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],b=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],a=["referrer","write","open","close"];f.dom.Sandbox=Base.extend({constructor:function(h,g){this.callback=h||f.EMPTY_FUNCTION;this.config=f.lang.object({}).merge(g).get();this.editableArea=this._createIframe()},insertInto:function(g){if(typeof(g)==="string"){g=e.getElementById(g)}g.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var g=this.getIframe();g.parentNode.removeChild(g)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var h=this,g=e.createElement("iframe");g.className="wysihtml5-sandbox";f.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(g);if(f.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()){g.src="javascript:'<html></html>'"}g.onload=function(){g.onreadystatechange=g.onload=null;h._onLoadIframe(g)};g.onreadystatechange=function(){if(/loaded|complete/.test(g.readyState)){g.onreadystatechange=g.onload=null;h._onLoadIframe(g)}};return g},_onLoadIframe:function(j){if(!f.dom.contains(e.documentElement,j)){return}var m=this,g=j.contentWindow,n=j.contentWindow.document,o=e.characterSet||e.charset||"utf-8",l=this._getHtml({charset:o,stylesheets:this.config.stylesheets});n.open("text/html","replace");n.write(l);n.close();this.getWindow=function(){return j.contentWindow};this.getDocument=function(){return j.contentWindow.document};g.onerror=function(p,q,i){throw new Error("wysihtml5.Sandbox: "+p,q,i)};if(!f.browser.supportsSandboxedIframes()){var h,k;for(h=0,k=d.length;h<k;h++){this._unset(g,d[h])}for(h=0,k=b.length;h<k;h++){this._unset(g,b[h],f.EMPTY_FUNCTION)}for(h=0,k=a.length;h<k;h++){this._unset(n,a[h])}this._unset(n,"cookie","",true)}this.loaded=true;setTimeout(function(){m.callback(m)},0)},_getHtml:function(k){var l=k.stylesheets,h="",g=0,j;l=typeof(l)==="string"?[l]:l;if(l){j=l.length;for(;g<j;g++){h+='<link rel="stylesheet" href="'+l[g]+'">'}}k.stylesheets=h;return f.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(k)},_unset:function(h,j,i,l){try{h[j]=i}catch(k){}try{h.__defineGetter__(j,function(){return i})}catch(k){}if(l){try{h.__defineSetter__(j,function(){})}catch(k){}}if(!f.browser.crashesWhenDefineProperty(j)){try{var g={get:function(){return i}};if(l){g.set=function(){}}Object.defineProperty(h,j,g)}catch(k){}}}})})(wysihtml5);(function(b){var a=document;b.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(f,d,e){this.callback=f||b.EMPTY_FUNCTION;this.config=b.lang.object({}).merge(d).get();if(e){this.element=this._bindElement(e)}else{this.element=this._createElement()}},_createElement:function(){var d=a.createElement("div");d.className="wysihtml5-sandbox";this._loadElement(d);return d},_bindElement:function(d){d.className=(d.className&&d.className!="")?d.className+" wysihtml5-sandbox":"wysihtml5-sandbox";this._loadElement(d,true);return d},_loadElement:function(e,d){var g=this;if(!d){var f=this._getHtml();e.innerHTML=f}this.getWindow=function(){return e.ownerDocument.defaultView};this.getDocument=function(){return e.ownerDocument};this.loaded=true;setTimeout(function(){g.callback(g)},0)},_getHtml:function(d){return""}})})(wysihtml5);(function(){var a={className:"class"};wysihtml5.dom.setAttributes=function(b){return{on:function(e){for(var d in b){e.setAttribute(a[d]||d,b[d])}}}}})();wysihtml5.dom.setStyles=function(a){return{on:function(d){var e=d.style;if(typeof(a)==="string"){e.cssText+=";"+a;return}for(var b in a){if(b==="float"){e.cssFloat=a[b];e.styleFloat=a[b]}else{e[b]=a[b]}}}}};(function(a){a.simulatePlaceholder=function(e,b,d){var f="placeholder",g=function(){var i=b.element.offsetWidth>0&&b.element.offsetHeight>0;if(b.hasPlaceholderSet()){b.clear();b.element.focus();if(i){setTimeout(function(){var j=b.selection.getSelection();if(!j.focusNode||!j.anchorNode){b.selection.selectNode(b.element.firstChild||b.element)}},0)}}b.placeholderSet=false;a.removeClass(b.element,f)},h=function(){if(b.isEmpty()){b.placeholderSet=true;b.setValue(d);a.addClass(b.element,f)}};e.on("set_placeholder",h).on("unset_placeholder",g).on("focus:composer",g).on("paste:composer",g).on("blur:composer",h);h()}})(wysihtml5.dom);(function(b){var a=document.documentElement;if("textContent" in a){b.setTextContent=function(d,e){d.textContent=e};b.getTextContent=function(d){return d.textContent}}else{if("innerText" in a){b.setTextContent=function(d,e){d.innerText=e};b.getTextContent=function(d){return d.innerText}}else{b.setTextContent=function(d,e){d.nodeValue=e};b.getTextContent=function(d){return d.nodeValue}}}})(wysihtml5.dom);wysihtml5.dom.getAttribute=function(d,b){var g=!wysihtml5.browser.supportsGetAttributeCorrectly();b=b.toLowerCase();var f=d.nodeName;if(f=="IMG"&&b=="src"&&wysihtml5.dom.isLoadedImage(d)===true){return d.src}else{if(g&&"outerHTML" in d){var e=d.outerHTML.toLowerCase(),a=e.indexOf(" "+b+"=")!=-1;return a?d.getAttribute(b):null}else{return d.getAttribute(b)}}};wysihtml5.dom.getAttributes=function(d){var f=!wysihtml5.browser.supportsGetAttributeCorrectly(),e=d.nodeName,b=[],a;for(a in d.attributes){if((d.attributes.hasOwnProperty&&d.attributes.hasOwnProperty(a))||(!d.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(d.attributes,a))){if(d.attributes[a].specified){if(e=="IMG"&&d.attributes[a].name.toLowerCase()=="src"&&wysihtml5.dom.isLoadedImage(d)===true){b.src=d.src}else{if(wysihtml5.lang.array(["rowspan","colspan"]).contains(d.attributes[a].name.toLowerCase())&&f){if(d.attributes[a].value!==1){b[d.attributes[a].name]=d.attributes[a].value}}else{b[d.attributes[a].name]=d.attributes[a].value}}}}}return b};wysihtml5.dom.isLoadedImage=function(a){try{return a.complete&&!a.mozMatchesSelector(":-moz-broken")}catch(b){if(a.complete&&a.readyState==="complete"){return true}}};(function(i){var e=i.dom;var d=function(j){this.el=j;this.isColspan=false;this.isRowspan=false;this.firstCol=true;this.lastCol=true;this.firstRow=true;this.lastRow=true;this.isReal=true;this.spanCollection=[];this.modified=false};var g=function(j,k){if(j){this.cell=j;this.table=e.getParentElement(j,{nodeName:["TABLE"]})}else{if(k){this.table=k;this.cell=this.table.querySelectorAll("th, td")[0]}}};function h(o,n){var k=[],m;for(var p=0,j=o.length;p<j;p++){m=o[p].querySelectorAll(n);if(m){for(var l=m.length;l--;k.unshift(m[l])){}}}return k}function b(j){j.parentNode.removeChild(j)}function f(j,k){j.parentNode.insertBefore(k,j.nextSibling)}function a(l,j){var k=l.nextSibling;while(k.nodeType!=1){k=k.nextSibling;if(!j||j==k.tagName.toLowerCase()){return k}}return null}g.prototype={addSpannedCellToMap:function(q,k,j,p,l,t){var o=[],u=j+((t)?parseInt(t,10)-1:0),s=p+((l)?parseInt(l,10)-1:0);for(var n=j;n<=u;n++){if(typeof k[n]=="undefined"){k[n]=[]}for(var m=p;m<=s;m++){k[n][m]=new d(q);k[n][m].isColspan=(l&&parseInt(l,10)>1);k[n][m].isRowspan=(t&&parseInt(t,10)>1);k[n][m].firstCol=m==p;k[n][m].lastCol=m==s;k[n][m].firstRow=n==j;k[n][m].lastRow=n==u;k[n][m].isReal=m==p&&n==j;k[n][m].spanCollection=o;o.push(k[n][m])}}},setCellAsModified:function(j){j.modified=true;if(j.spanCollection.length>0){for(var k=0,l=j.spanCollection.length;k<l;k++){j.spanCollection[k].modified=true}}},setTableMap:function(){var k=[];var n=this.getTableRows(),j,r,q,s,o,m,l,p;for(j=0;j<n.length;j++){r=n[j];q=this.getRowCells(r);m=0;if(typeof k[j]=="undefined"){k[j]=[]}for(s=0;s<q.length;s++){o=q[s];while(typeof k[j][m]!="undefined"){m++}l=e.getAttribute(o,"colspan");p=e.getAttribute(o,"rowspan");if(l||p){this.addSpannedCellToMap(o,k,j,m,l,p);m=m+((l)?parseInt(l,10):1)}else{k[j][m]=new d(o);m++}}}this.map=k;return k},getRowCells:function(n){var k=this.table.querySelectorAll("table"),l=(k)?h(k,"th, td"):[],j=n.querySelectorAll("th, td"),m=(l.length>0)?i.lang.array(j).without(l):j;return m},getTableRows:function(){var l=this.table.querySelectorAll("table"),m=(l)?h(l,"tr"):[],k=this.table.querySelectorAll("tr"),j=(m.length>0)?i.lang.array(k).without(m):k;return j},getMapIndex:function(j){var l=this.map.length,n=(this.map&&this.map[0])?this.map[0].length:0;for(var m=0;m<l;m++){for(var k=0;k<n;k++){if(this.map[m][k].el===j){return{row:m,col:k}}}}return false},getElementAtIndex:function(j){this.setTableMap();if(this.map[j.row]&&this.map[j.row][j.col]&&this.map[j.row][j.col].el){return this.map[j.row][j.col].el}return null},getMapElsTo:function(p){var m=[];this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(p);if(this.idx_start.row>this.idx_end.row||(this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)){var n=this.idx_start;this.idx_start=this.idx_end;this.idx_end=n}if(this.idx_start.col>this.idx_end.col){var j=this.idx_start.col;this.idx_start.col=this.idx_end.col;this.idx_end.col=j}if(this.idx_start!=null&&this.idx_end!=null){for(var q=this.idx_start.row,l=this.idx_end.row;q<=l;q++){for(var k=this.idx_start.col,o=this.idx_end.col;k<=o;k++){m.push(this.map[q][k].el)}}}return m},orderSelectionEnds:function(k){this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(k);if(this.idx_start.row>this.idx_end.row||(this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)){var l=this.idx_start;this.idx_start=this.idx_end;this.idx_end=l}if(this.idx_start.col>this.idx_end.col){var j=this.idx_start.col;this.idx_start.col=this.idx_end.col;this.idx_end.col=j}return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(l,o,m){var p=this.table.ownerDocument,q=p.createDocumentFragment(),k;for(var n=0;n<o;n++){k=p.createElement(l);if(m){for(var j in m){if(m.hasOwnProperty(j)){k.setAttribute(j,m[j])}}}k.appendChild(document.createTextNode("\u00a0"));q.appendChild(k)}return q},correctColIndexForUnreals:function(l,o){var n=this.map[o],k=-1;for(var m=0,j=l;m<l;m++){if(n[m].isReal){k++}}return k},getLastNewCellOnRow:function(p,o){var n=this.getRowCells(p),m,l;for(var k=0,j=n.length;k<j;k++){m=n[k];l=this.getMapIndex(m);if(l===false||(typeof o!="undefined"&&l.row!=o)){return m}}return null},removeEmptyTable:function(){var j=this.table.querySelectorAll("td, th");if(!j||j.length==0){b(this.table);return true}else{return false}},splitRowToCells:function(j){if(j.isColspan){var m=parseInt(e.getAttribute(j.el,"colspan")||1,10),k=j.el.tagName.toLowerCase();if(m>1){var l=this.createCells(k,m-1);f(j.el,l)}j.el.removeAttribute("colspan")}},getRealRowEl:function(n,l){var m=null,o=null;l=l||this.idx;for(var k=0,j=this.map[l.row].length;k<j;k++){o=this.map[l.row][k];if(o.isReal){m=e.getParentElement(o.el,{nodeName:["TR"]});if(m){return m}}}if(m===null&&n){m=e.getParentElement(this.map[l.row][l.col].el,{nodeName:["TR"]})||null}return m},injectRowAt:function(q,l,k,n,p){var j=this.getRealRowEl(false,{row:q,col:l}),s=this.createCells(n,k);if(j){var o=this.correctColIndexForUnreals(l,q);if(o>=0){f(this.getRowCells(j)[o],s)}else{j.insertBefore(s,j.firstChild)}}else{var m=this.table.ownerDocument.createElement("tr");m.appendChild(s);f(e.getParentElement(p.el,{nodeName:["TR"]}),m)}},canMerge:function(p){this.to=p;this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(this.to);if(this.idx_start.row>this.idx_end.row||(this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)){var m=this.idx_start;this.idx_start=this.idx_end;this.idx_end=m}if(this.idx_start.col>this.idx_end.col){var j=this.idx_start.col;this.idx_start.col=this.idx_end.col;this.idx_end.col=j}for(var o=this.idx_start.row,l=this.idx_end.row;o<=l;o++){for(var k=this.idx_start.col,n=this.idx_end.col;k<=n;k++){if(this.map[o][k].isColspan||this.map[o][k].isRowspan){return false}}}return true},decreaseCellSpan:function(j,k){var l=parseInt(e.getAttribute(j.el,k),10)-1;if(l>=1){j.el.setAttribute(k,l)}else{j.el.removeAttribute(k);if(k=="colspan"){j.isColspan=false}if(k=="rowspan"){j.isRowspan=false}j.firstCol=true;j.lastCol=true;j.firstRow=true;j.lastRow=true;j.isReal=true}},removeSurplusLines:function(){var o,l,q,p,k,j,m;this.setTableMap();if(this.map){q=0;p=this.map.length;for(;q<p;q++){o=this.map[q];m=true;k=0;j=o.length;for(;k<j;k++){l=o[k];if(!(e.getAttribute(l.el,"rowspan")&&parseInt(e.getAttribute(l.el,"rowspan"),10)>1&&l.firstRow!==true)){m=false;break}}if(m){k=0;for(;k<j;k++){this.decreaseCellSpan(o[k],"rowspan")}}}var n=this.getTableRows();q=0;p=n.length;for(;q<p;q++){o=n[q];if(o.childNodes.length==0&&(/^\s*$/.test(o.textContent||o.innerText))){b(o)}}}},fillMissingCells:function(){var l=0,j=0,n=null;this.setTableMap();if(this.map){l=this.map.length;for(var o=0;o<l;o++){if(this.map[o].length>j){j=this.map[o].length}}for(var m=0;m<l;m++){for(var k=0;k<j;k++){if(this.map[m]&&!this.map[m][k]){if(k>0){this.map[m][k]=new d(this.createCells("td",1));n=this.map[m][k-1];if(n&&n.el&&n.el.parent){f(this.map[m][k-1].el,this.map[m][k].el)}}}}}}},rectify:function(){if(!this.removeEmptyTable()){this.removeSurplusLines();this.fillMissingCells();return true}else{return false}},unmerge:function(){if(this.rectify()){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx){var n=this.map[this.idx.row][this.idx.col],o=(e.getAttribute(n.el,"colspan"))?parseInt(e.getAttribute(n.el,"colspan"),10):1,j=n.el.tagName.toLowerCase();if(n.isRowspan){var m=parseInt(e.getAttribute(n.el,"rowspan"),10);if(m>1){for(var l=1,k=m-1;l<=k;l++){this.injectRowAt(this.idx.row+l,this.idx.col,o,j,n)}}n.el.removeAttribute("rowspan")}this.splitRowToCells(n)}}},merge:function(p){if(this.rectify()){if(this.canMerge(p)){var m=this.idx_end.row-this.idx_start.row+1,o=this.idx_end.col-this.idx_start.col+1;for(var n=this.idx_start.row,k=this.idx_end.row;n<=k;n++){for(var j=this.idx_start.col,l=this.idx_end.col;j<=l;j++){if(n==this.idx_start.row&&j==this.idx_start.col){if(m>1){this.map[n][j].el.setAttribute("rowspan",m)}if(o>1){this.map[n][j].el.setAttribute("colspan",o)}}else{if(!(/^\s*<br\/?>\s*$/.test(this.map[n][j].el.innerHTML.toLowerCase()))){this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[n][j].el.innerHTML}b(this.map[n][j].el)}}}this.rectify()}else{if(window.console){console.log("Do not know how to merge allready merged cells.")}}}},collapseCellToNextRow:function(l){var n=this.getMapIndex(l.el),o=n.row+1,m={row:o,col:n.col};if(o<this.map.length){var p=this.getRealRowEl(false,m);if(p!==null){var k=this.correctColIndexForUnreals(m.col,m.row);if(k>=0){f(this.getRowCells(p)[k],l.el)}else{var j=this.getLastNewCellOnRow(p,o);if(j!==null){f(j,l.el)}else{p.insertBefore(l.el,p.firstChild)}}if(parseInt(e.getAttribute(l.el,"rowspan"),10)>2){l.el.setAttribute("rowspan",parseInt(e.getAttribute(l.el,"rowspan"),10)-1)}else{l.el.removeAttribute("rowspan")}}}},removeRowCell:function(j){if(j.isReal){if(j.isRowspan){this.collapseCellToNextRow(j)}else{b(j.el)}}else{if(parseInt(e.getAttribute(j.el,"rowspan"),10)>2){j.el.setAttribute("rowspan",parseInt(e.getAttribute(j.el,"rowspan"),10)-1)}else{j.el.removeAttribute("rowspan")}}},getRowElementsByCell:function(){var m=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){var l=this.map[this.idx.row];for(var k=0,j=l.length;k<j;k++){if(l[k].isReal){m.push(l[k].el)}}}return m},getColumnElementsByCell:function(){var j=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){for(var l=0,k=this.map.length;l<k;l++){if(this.map[l][this.idx.col]&&this.map[l][this.idx.col].isReal){j.push(this.map[l][this.idx.col].el)}}}return j},removeRow:function(){var m=e.getParentElement(this.cell,{nodeName:["TR"]});if(m){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){var l=this.map[this.idx.row];for(var k=0,j=l.length;k<j;k++){if(!l[k].modified){this.setCellAsModified(l[k]);this.removeRowCell(l[k])}}}b(m)}},removeColCell:function(j){if(j.isColspan){if(parseInt(e.getAttribute(j.el,"colspan"),10)>2){j.el.setAttribute("colspan",parseInt(e.getAttribute(j.el,"colspan"),10)-1)}else{j.el.removeAttribute("colspan")}}else{if(j.isReal){b(j.el)}}},removeColumn:function(){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){for(var k=0,j=this.map.length;k<j;k++){if(!this.map[k][this.idx.col].modified){this.setCellAsModified(this.map[k][this.idx.col]);this.removeColCell(this.map[k][this.idx.col])}}}},remove:function(j){if(this.rectify()){switch(j){case"row":this.removeRow();break;case"column":this.removeColumn();break}this.rectify()}},addRow:function(l){var n=this.table.ownerDocument;this.setTableMap();this.idx=this.getMapIndex(this.cell);if(l=="below"&&e.getAttribute(this.cell,"rowspan")){this.idx.row=this.idx.row+parseInt(e.getAttribute(this.cell,"rowspan"),10)-1}if(this.idx!==false){var j=this.map[this.idx.row],k=n.createElement("tr");for(var p=0,o=j.length;p<o;p++){if(!j[p].modified){this.setCellAsModified(j[p]);this.addRowCell(j[p],k,l)}}switch(l){case"below":f(this.getRealRowEl(true),k);break;case"above":var m=e.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]});if(m){m.parentNode.insertBefore(k,m)}break}}},addRowCell:function(j,m,k){var l=(j.isColspan)?{colspan:e.getAttribute(j.el,"colspan")}:null;if(j.isReal){if(k!="above"&&j.isRowspan){j.el.setAttribute("rowspan",parseInt(e.getAttribute(j.el,"rowspan"),10)+1)}else{m.appendChild(this.createCells("td",1,l))}}else{if(k!="above"&&j.isRowspan&&j.lastRow){m.appendChild(this.createCells("td",1,l))}else{if(c.isRowspan){j.el.attr("rowspan",parseInt(e.getAttribute(j.el,"rowspan"),10)+1)}}}},add:function(j){if(this.rectify()){if(j=="below"||j=="above"){this.addRow(j)}if(j=="before"||j=="after"){this.addColumn(j)}}},addColCell:function(j,n,l){var m,k=j.el.tagName.toLowerCase();switch(l){case"before":m=(!j.isColspan||j.firstCol);break;case"after":m=(!j.isColspan||j.lastCol||(j.isColspan&&c.el==this.cell));break}if(m){switch(l){case"before":j.el.parentNode.insertBefore(this.createCells(k,1),j.el);break;case"after":f(j.el,this.createCells(k,1));break}if(j.isRowspan){this.handleCellAddWithRowspan(j,n+1,l)}}else{j.el.setAttribute("colspan",parseInt(e.getAttribute(j.el,"colspan"),10)+1)}},addColumn:function(j){var l,k;this.setTableMap();this.idx=this.getMapIndex(this.cell);if(j=="after"&&e.getAttribute(this.cell,"colspan")){this.idx.col=this.idx.col+parseInt(e.getAttribute(this.cell,"colspan"),10)-1}if(this.idx!==false){for(var n=0,m=this.map.length;n<m;n++){l=this.map[n];if(l[this.idx.col]){k=l[this.idx.col];if(!k.modified){this.setCellAsModified(k);this.addColCell(k,n,j)}}}}},handleCellAddWithRowspan:function(s,j,o){var q=parseInt(e.getAttribute(this.cell,"rowspan"),10)-1,k=e.getParentElement(s.el,{nodeName:["TR"]}),p=s.el.tagName.toLowerCase(),t,m,r=this.table.ownerDocument,l;for(var n=0;n<q;n++){t=this.correctColIndexForUnreals(this.idx.col,(j+n));k=a(k,"tr");if(k){if(t>0){switch(o){case"before":m=this.getRowCells(k);if(t>0&&this.map[j+n][this.idx.col].el!=m[t]&&t==m.length-1){f(m[t],this.createCells(p,1))}else{m[t].parentNode.insertBefore(this.createCells(p,1),m[t])}break;case"after":f(this.getRowCells(k)[t],this.createCells(p,1));break}}else{k.insertBefore(this.createCells(p,1),k.firstChild)}}else{l=r.createElement("tr");l.appendChild(this.createCells(p,1));this.table.appendChild(l)}}}};e.table={getCellsBetween:function(k,j){var l=new g(k);return l.getMapElsTo(j)},addCells:function(j,k){var l=new g(j);l.add(k)},removeCells:function(j,k){var l=new g(j);l.remove(k)},mergeCellsBetween:function(k,j){var l=new g(k);l.merge(j)},unmergeCell:function(j){var k=new g(j);k.unmerge()},orderSelectionEnds:function(j,k){var l=new g(j);return l.orderSelectionEnds(k)},indexOf:function(j){var k=new g(j);k.setTableMap();return k.getMapIndex(j)},findCell:function(k,j){var l=new g(null,k);return l.getElementAtIndex(j)},findRowByCell:function(j){var k=new g(j);return k.getRowElementsByCell()},findColumnByCell:function(j){var k=new g(j);return k.getColumnElementsByCell()},canMerge:function(k,j){var l=new g(k);return l.canMerge(j)}}})(wysihtml5);wysihtml5.dom.query=function(h,g){var b=[],f;if(h.nodeType){h=[h]}for(var j=0,a=h.length;j<a;j++){f=h[j].querySelectorAll(g);if(f){for(var d=f.length;d--;b.unshift(f[d])){}}}return b};wysihtml5.dom.compareDocumentPosition=(function(){var a=document.documentElement;if(a.compareDocumentPosition){return function(b,d){return b.compareDocumentPosition(d)}}else{return function(d,e){var h,i;if(d.nodeType===9){h=d}else{h=d.ownerDocument}if(e.nodeType===9){i=e}else{i=e.ownerDocument}if(d===e){return 0}if(d===e.ownerDocument){return 4+16}if(d.ownerDocument===e){return 2+8}if(h!==i){return 1}if(d.nodeType===2&&d.childNodes&&wysihtml5.lang.array(d.childNodes).indexOf(e)!==-1){return 4+16}if(e.nodeType===2&&e.childNodes&&wysihtml5.lang.array(e.childNodes).indexOf(d)!==-1){return 2+8}var l=d;var k=[];var g=null;while(l){if(l==e){return 2+8}k.push(l);l=l.parentNode}l=e;g=null;while(l){if(l==d){return 4+16}var m=wysihtml5.lang.array(k).indexOf(l);if(m!==-1){var f=k[m];var j=wysihtml5.lang.array(f.childNodes).indexOf(k[m-1]);var b=wysihtml5.lang.array(f.childNodes).indexOf(g);if(j>b){return 2}else{return 4}}g=l;l=l.parentNode}return 1}}})();wysihtml5.dom.unwrap=function(a){if(a.parentNode){while(a.lastChild){wysihtml5.dom.insert(a.lastChild).after(a)}a.parentNode.removeChild(a)}};wysihtml5.dom.getPastedHtml=function(b){var a;if(b.clipboardData){if(wysihtml5.lang.array(b.clipboardData.types).contains("text/html")){a=b.clipboardData.getData("text/html")}else{if(wysihtml5.lang.array(b.clipboardData.types).contains("text/plain")){a=wysihtml5.lang.string(b.clipboardData.getData("text/plain")).escapeHTML(true,true)}}}return a};wysihtml5.dom.getPastedHtmlWithDiv=function(b,d){var a=b.selection.getBookmark(),e=b.element.ownerDocument,g=e.createElement("DIV");e.body.appendChild(g);g.style.width="1px";g.style.height="1px";g.style.overflow="hidden";g.setAttribute("contenteditable","true");g.focus();setTimeout(function(){b.selection.setBookmark(a);d(g.innerHTML);g.parentNode.removeChild(g)},0)};wysihtml5.quirks.cleanPastedHTML=(function(){var d=function(g){var f=wysihtml5.lang.string(g).trim(),e=f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");return new RegExp("^((?!^"+e+"$).)*$","i")};var b=function(h,g){var i=wysihtml5.lang.object(h).clone(true),e,f;for(e in i.tags){if(i.tags.hasOwnProperty(e)){if(i.tags[e].keep_styles){for(f in i.tags[e].keep_styles){if(i.tags[e].keep_styles.hasOwnProperty(f)){if(g[f]){i.tags[e].keep_styles[f]=d(g[f])}}}}}}return i};var a=function(g,j){var k,f;if(!g){return null}for(var h=0,e=g.length;h<e;h++){if(!g[h].condition){f=g[h].set}if(g[h].condition&&g[h].condition.test(j)){return g[h].set}}return f};return function(g,f){var h={color:wysihtml5.dom.getStyle("color").from(f.referenceNode),fontSize:wysihtml5.dom.getStyle("font-size").from(f.referenceNode)},i=b(a(f.rules,g)||{},h),e;e=wysihtml5.dom.parse(g,{rules:i,cleanUp:true,context:f.referenceNode.ownerDocument,uneditableClass:f.uneditableClass,clearInternals:true,unjoinNbsps:true});return e}})();wysihtml5.quirks.ensureProperClearing=(function(){var a=function(){var b=this;setTimeout(function(){var d=b.innerHTML.toLowerCase();if(d=="<p>&nbsp;</p>"||d=="<p>&nbsp;</p><p>&nbsp;</p>"){b.innerHTML=""}},0)};return function(b){wysihtml5.dom.observe(b.element,["cut","keydown"],a)}})();(function(b){var a="%7E";b.quirks.getCorrectInnerHTML=function(f){var k=f.innerHTML;if(k.indexOf(a)===-1){return k}var h=f.querySelectorAll("[href*='~'], [src*='~']"),d,j,g,e;for(e=0,g=h.length;e<g;e++){d=h[e].href||h[e].src;j=b.lang.string(d).replace("~").by(a);k=b.lang.string(k).replace(j).by(d)}return k}})(wysihtml5);(function(b){var a="wysihtml5-quirks-redraw";b.quirks.redraw=function(d){b.dom.addClass(d,a);b.dom.removeClass(d,a);try{var g=d.ownerDocument;g.execCommand("italic",false,null);g.execCommand("italic",false,null)}catch(f){}}})(wysihtml5);wysihtml5.quirks.tableCellsSelection=function(d,j){var f=wysihtml5.dom,m={table:null,start:null,end:null,cells:null,select:b},h="wysiwyg-tmp-selected-cell",i=null,a=null;function p(){f.observe(d,"mousedown",function(q){var r=wysihtml5.dom.getParentElement(q.target,{nodeName:["TD","TH"]});if(r){k(r)}});return m}function k(q){m.start=q;m.end=q;m.cells=[q];m.table=f.getParentElement(m.start,{nodeName:["TABLE"]});if(m.table){o();f.addClass(q,h);i=f.observe(d,"mousemove",g);a=f.observe(d,"mouseup",n);j.fire("tableselectstart").fire("tableselectstart:composer")}}function o(){if(d){var q=d.querySelectorAll("."+h);if(q.length>0){for(var r=0;r<q.length;r++){f.removeClass(q[r],h)}}}}function e(q){for(var r=0;r<q.length;r++){f.addClass(q[r],h)}}function g(s){var t=null,q=f.getParentElement(s.target,{nodeName:["TD","TH"]}),r;if(q&&m.table&&m.start){t=f.getParentElement(q,{nodeName:["TABLE"]});if(t&&t===m.table){o();r=m.end;m.end=q;m.cells=f.table.getCellsBetween(m.start,q);if(m.cells.length>1){j.composer.selection.deselect()}e(m.cells);if(m.end!==r){j.fire("tableselectchange").fire("tableselectchange:composer")}}}}function n(q){i.stop();a.stop();j.fire("tableselect").fire("tableselect:composer");setTimeout(function(){l()},0)}function l(){var q=f.observe(d.ownerDocument,"click",function(r){q.stop();if(f.getParentElement(r.target,{nodeName:["TABLE"]})!=m.table){o();m.table=null;m.start=null;m.end=null;j.fire("tableunselect").fire("tableunselect:composer")}})}function b(r,q){m.start=r;m.end=q;m.table=f.getParentElement(m.start,{nodeName:["TABLE"]});selectedCells=f.table.getCellsBetween(m.start,m.end);e(selectedCells);l();j.fire("tableselect").fire("tableselect:composer")}return p()};(function(g){var b=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,e=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,a=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,d=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i;var f=function(h){return new RegExp("(^|\\s|;)"+h+"\\s*:\\s*[^;$]+","gi")};g.quirks.styleParser={parseColor:function(k,m){var l=f(m),o=k.match(l),j=10,n,p;if(o){for(var h=o.length;h--;){o[h]=g.lang.string(o[h].split(":")[1]).trim()}n=o[o.length-1];if(b.test(n)){p=n.match(b)}else{if(e.test(n)){p=n.match(e)}else{if(a.test(n)){p=n.match(a);j=16}else{if(d.test(n)){p=n.match(d);p.shift();p.push(1);return g.lang.array(p).map(function(q,i){return(i<3)?(parseInt(q,16)*16)+parseInt(q,16):parseFloat(q)})}}}}if(p){p.shift();if(!p[3]){p.push(1)}return g.lang.array(p).map(function(q,i){return(i<3)?parseInt(q,j):parseFloat(q)})}}return false},unparseColor:function(i,h){if(h){if(h=="hex"){return(i[0].toString(16).toUpperCase())+(i[1].toString(16).toUpperCase())+(i[2].toString(16).toUpperCase())}else{if(h=="hash"){return"#"+(i[0].toString(16).toUpperCase())+(i[1].toString(16).toUpperCase())+(i[2].toString(16).toUpperCase())}else{if(h=="rgb"){return"rgb("+i[0]+","+i[1]+","+i[2]+")"}else{if(h=="rgba"){return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"}else{if(h=="csv"){return i[0]+","+i[1]+","+i[2]+","+i[3]}}}}}}if(i[3]&&i[3]!==1){return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"}else{return"rgb("+i[0]+","+i[1]+","+i[2]+")"}},parseFontSize:function(h){var i=h.match(f("font-size"));if(i){return g.lang.string(i[i.length-1].split(":")[1]).trim()}return false}}})(wysihtml5);(function(f){var e=f.dom;function d(g){var h=0;if(g.parentNode){do{h+=g.offsetTop||0;g=g.offsetParent}while(g)}return h}function b(h,i){var g=0;while(i!==h){g++;i=i.parentNode;if(!i){throw new Error("not a descendant of ancestor!")}}return g}function a(g){if(g.canSurroundContents()){return}var h=g.commonAncestorContainer,i=b(h,g.startContainer),j=b(h,g.endContainer);while(!g.canSurroundContents()){if(i>j){g.setStartBefore(g.startContainer);i=b(h,g.startContainer)}else{g.setEndAfter(g.endContainer);j=b(h,g.endContainer)}}}f.Selection=Base.extend({constructor:function(g,h,i){window.rangy.init();this.editor=g;this.composer=g.composer;this.doc=this.composer.doc;this.contain=h;this.unselectableClass=i||false},getBookmark:function(){var g=this.getRange();if(g){a(g)}return g&&g.cloneRange()},setBookmark:function(g){if(!g){return}this.setSelection(g)},setBefore:function(h){var g=rangy.createRange(this.doc);g.setStartBefore(h);g.setEndBefore(h);return this.setSelection(g)},setAfter:function(h){var g=rangy.createRange(this.doc);g.setStartAfter(h);g.setEndAfter(h);return this.setSelection(g)},selectNode:function(g,m){var i=rangy.createRange(this.doc),l=g.nodeType===f.ELEMENT_NODE,o="canHaveHTML" in g?g.canHaveHTML:(g.nodeName!=="IMG"),k=l?g.innerHTML:g.data,h=(k===""||k===f.INVISIBLE_SPACE),n=e.getStyle("display").from(g),p=(n==="block"||n==="list-item");if(h&&l&&o&&!m){try{g.innerHTML=f.INVISIBLE_SPACE}catch(j){}}if(o){i.selectNodeContents(g)}else{i.selectNode(g)}if(o&&h&&l){i.collapse(p)}else{if(o&&h){i.setStartAfter(g);i.setEndAfter(g)}}this.setSelection(i)},getSelectedNode:function(h){var i,g;if(h&&this.doc.selection&&this.doc.selection.type==="Control"){g=this.doc.selection.createRange();if(g&&g.length){return g.item(0)}}i=this.getSelection(this.doc);if(i.focusNode===i.anchorNode){return i.focusNode}else{g=this.getRange(this.doc);return g?g.commonAncestorContainer:this.doc.body}},fixSelBorders:function(){var g=this.getRange();a(g);this.setSelection(g)},getSelectedOwnNodes:function(k){var l,g=this.getOwnRanges(),m=[];for(var j=0,h=g.length;j<h;j++){m.push(g[j].commonAncestorContainer||this.doc.body)}return m},findNodesInSelection:function(g){var h=this.getOwnRanges(),k=[],l;for(var m=0,j=h.length;m<j;m++){l=h[m].getNodes([1],function(i){return f.lang.array(g).contains(i.nodeName)});k=k.concat(l)}return k},containsUneditable:function(){var h=this.getOwnUneditables(),k=this.getSelection();for(var j=0,g=h.length;j<g;j++){if(k.containsNode(h[j])){return true}}return false},deleteContents:function(){var g=this.getOwnRanges();for(var h=g.length;h--;){g[h].deleteContents()}this.setSelection(g[0])},getPreviousNode:function(k,g){if(!k){var j=this.getSelection();k=j.anchorNode}if(k===this.contain){return false}var h=k.previousSibling,i;if(h===this.contain){return false}if(h&&h.nodeType!==3&&h.nodeType!==1){h=this.getPreviousNode(h,g)}else{if(h&&h.nodeType===3&&(/^\s*$/).test(h.textContent)){h=this.getPreviousNode(h,g)}else{if(g&&h&&h.nodeType===1&&!f.lang.array(["BR","HR","IMG"]).contains(h.nodeName)&&(/^[\s]*$/).test(h.innerHTML)){h=this.getPreviousNode(h,g)}else{if(!h&&k!==this.contain){i=k.parentNode;if(i!==this.contain){h=this.getPreviousNode(i,g)}}}}}return(h!==this.contain)?h:false},getSelectionParentsByTag:function(m){var h=this.getSelectedOwnNodes(),k,j=[];for(var l=0,g=h.length;l<g;l++){k=(h[l].nodeName&&h[l].nodeName==="LI")?h[l]:f.dom.getParentElement(h[l],{nodeName:["LI"]},false,this.contain);if(k){j.push(k)}}return(j.length)?j:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var i=this.getRange(),g=i.startContainer,j=i.startOffset,h=rangy.createRange(this.doc);h.selectNodeContents(g);h.setStart(g,j);return h}},caretIsLastInSelection:function(){var i=rangy.createRange(this.doc),g=this.getSelection(),h=this.getRangeToNodeEnd().cloneContents(),j=h.textContent;return(/^\s*$/).test(j)},caretIsFirstInSelection:function(){var j=rangy.createRange(this.doc),i=this.getSelection(),g=this.getRange(),h=g.startContainer;if(h.nodeType===f.TEXT_NODE){return this.isCollapsed()&&(h.nodeType===f.TEXT_NODE&&(/^\s*$/).test(h.data.substr(0,g.startOffset)))}else{j.selectNodeContents(this.getRange().commonAncestorContainer);j.collapse(true);return(this.isCollapsed()&&(j.startContainer===i.anchorNode||j.endContainer===i.anchorNode)&&j.startOffset===i.anchorOffset)}},caretIsInTheBeginnig:function(g){var h=this.getSelection(),i=h.anchorNode,j=h.anchorOffset;if(g){return(j===0&&(i.nodeName&&i.nodeName===g.toUpperCase()||f.dom.getParentElement(i.parentNode,{nodeName:g},1)))}else{return(j===0&&!this.getPreviousNode(i,true))}},caretIsBeforeUneditable:function(){var l=this.getSelection(),m=l.anchorNode,n=l.anchorOffset;if(n===0){var g=this.getPreviousNode(m,true);if(g){var j=this.getOwnUneditables();for(var k=0,h=j.length;k<h;k++){if(g===j[k]){return j[k]}}}}return false},executeAndRestoreRangy:function(k,j){var i=this.doc.defaultView||this.doc.parentWindow,g=rangy.saveSelection(i);if(!g){k()}else{try{k()}catch(h){setTimeout(function(){throw h},0)}}rangy.restoreSelection(g)},executeAndRestore:function(j,s){var o=this.doc.body,y=s&&o.scrollTop,t=s&&o.scrollLeft,h="_wysihtml5-temp-placeholder",k='<span class="'+h+'">'+f.INVISIBLE_SPACE+"</span>",r=this.getRange(true),n,w,p,z,u,g,q,m;if(!r){j(o,o);return}if(!r.collapsed){q=r.cloneRange();g=q.createContextualFragment(k);q.collapse(false);q.insertNode(g);q.detach()}u=r.createContextualFragment(k);r.insertNode(u);if(g){n=this.contain.querySelectorAll("."+h);r.setStartBefore(n[0]);r.setEndAfter(n[n.length-1])}this.setSelection(r);try{j(r.startContainer,r.endContainer)}catch(x){setTimeout(function(){throw x},0)}n=this.contain.querySelectorAll("."+h);if(n&&n.length){m=rangy.createRange(this.doc);p=n[0].nextSibling;if(n.length>1){z=n[n.length-1].previousSibling}if(z&&p){m.setStartBefore(p);m.setEndAfter(z)}else{w=this.doc.createTextNode(f.INVISIBLE_SPACE);e.insert(w).after(n[0]);m.setStartBefore(w);m.setEndAfter(w)}this.setSelection(m);for(var v=n.length;v--;){n[v].parentNode.removeChild(n[v])}}else{this.contain.focus()}if(s){o.scrollTop=y;o.scrollLeft=t}try{n.parentNode.removeChild(n)}catch(l){}},set:function(h,i){var g=rangy.createRange(this.doc);g.setStart(h,i||0);this.setSelection(g)},insertHTML:function(i){var g=rangy.createRange(this.doc),k=this.doc.createElement("DIV"),h=this.doc.createDocumentFragment(),j;k.innerHTML=i;j=k.lastChild;while(k.firstChild){h.appendChild(k.firstChild)}this.insertNode(h);if(j){this.setAfter(j)}},insertNode:function(h){var g=this.getRange();if(g){g.insertNode(h)}},surround:function(m){var g=this.getOwnRanges(),k,h=[];if(g.length==0){return h}for(var j=g.length;j--;){k=this.doc.createElement(m.nodeName);h.push(k);if(m.className){k.className=m.className}if(m.cssStyle){k.setAttribute("style",m.cssStyle)}try{g[j].surroundContents(k);this.selectNode(k)}catch(l){k.appendChild(g[j].extractContents());g[j].insertNode(k)}}return h},deblockAndSurround:function(l){var h=this.doc.createElement("div"),j=rangy.createRange(this.doc),i,g,k;h.className=l.className;this.composer.commands.exec("formatBlock",l.nodeName,l.className);i=this.contain.querySelectorAll("."+l.className);if(i[0]){i[0].parentNode.insertBefore(h,i[0]);j.setStartBefore(i[0]);j.setEndAfter(i[i.length-1]);g=j.extractContents();while(g.firstChild){k=g.firstChild;if(k.nodeType==1&&f.dom.hasClass(k,l.className)){while(k.firstChild){h.appendChild(k.firstChild)}if(k.nodeName!=="BR"){h.appendChild(this.doc.createElement("br"))}g.removeChild(k)}else{h.appendChild(k)}}}else{h=null}return h},scrollIntoView:function(){var k=this.doc,h=5,j=k.documentElement.scrollHeight>k.documentElement.offsetHeight,g=k._wysihtml5ScrollIntoViewElement=k._wysihtml5ScrollIntoViewElement||(function(){var l=k.createElement("span");l.innerHTML=f.INVISIBLE_SPACE;return l})(),i;if(j){this.insertNode(g);i=d(g);g.parentNode.removeChild(g);if(i>=(k.body.scrollTop+k.documentElement.offsetHeight-h)){k.body.scrollTop=i}}},selectLine:function(){if(f.browser.supportsSelectionModify()){this._selectLine_W3C()}else{if(this.doc.selection){this._selectLine_MSIE()}}},_selectLine_W3C:function(){var h=this.doc.defaultView,g=h.getSelection();g.modify("move","left","lineboundary");g.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var o=this.doc.selection.createRange(),m=o.boundingTop,n=this.doc.body.scrollWidth,h,g,p,l,k;if(!o.moveToPoint){return}if(m===0){p=this.doc.createElement("span");this.insertNode(p);m=p.offsetTop;p.parentNode.removeChild(p)}m+=1;for(l=-10;l<n;l+=2){try{o.moveToPoint(l,m);break}catch(r){}}h=m;g=this.doc.selection.createRange();for(k=n;k>=0;k--){try{g.moveToPoint(k,h);break}catch(q){}}o.setEndPoint("EndToEnd",g);o.select()},getText:function(){var g=this.getSelection();return g?g.toString():""},getNodes:function(g,i){var h=this.getRange();if(h){return h.getNodes([g],i)}else{return[]}},fixRangeOverflow:function(g){if(this.contain&&this.contain.firstChild&&g){var i=g.compareNode(this.contain);if(i!==2){if(i===1){g.setStartBefore(this.contain.firstChild)}if(i===0){g.setEndAfter(this.contain.lastChild)}if(i===3){g.setStartBefore(this.contain.firstChild);g.setEndAfter(this.contain.lastChild)}}else{if(this._detectInlineRangeProblems(g)){var h=g.endContainer.previousElementSibling;if(h){g.setEnd(h,this._endOffsetForNode(h))}}}}},_endOffsetForNode:function(h){var g=document.createRange();g.selectNodeContents(h);return g.endOffset},_detectInlineRangeProblems:function(h){var g=e.compareDocumentPosition(h.startContainer,h.endContainer);return(h.endOffset==0&&g&4)},getRange:function(i){var h=this.getSelection(),g=h&&h.rangeCount&&h.getRangeAt(0);if(i!==true){this.fixRangeOverflow(g)}return g},getOwnUneditables:function(){var h=e.query(this.contain,"."+this.unselectableClass),g=e.query(h,"."+this.unselectableClass);return f.lang.array(h).without(g)},getOwnRanges:function(){var k=[],g=this.getRange(),p;if(g){k.push(g)}if(this.unselectableClass&&this.contain&&g){var l=this.getOwnUneditables(),q;if(l.length>0){for(var o=0,m=l.length;o<m;o++){p=[];for(var n=0,h=k.length;n<h;n++){if(k[n]){switch(k[n].compareNode(l[o])){case 2:break;case 3:q=k[n].cloneRange();q.setEndBefore(l[o]);p.push(q);q=k[n].cloneRange();q.setStartAfter(l[o]);p.push(q);break;default:p.push(k[n])}}k=p}}}}return k},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(g){var i=this.doc.defaultView||this.doc.parentWindow,h=rangy.getSelection(i);return h.setSingleRange(g)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},isEndToEndInNode:function(k){var i=this.getRange(),h=i.commonAncestorContainer,j=i.startContainer,g=i.endContainer;if(h.nodeType===f.TEXT_NODE){h=h.parentNode}if(j.nodeType===f.TEXT_NODE&&!(/^\s*$/).test(j.data.substr(i.startOffset))){return false}if(g.nodeType===f.TEXT_NODE&&!(/^\s*$/).test(g.data.substr(i.endOffset))){return false}while(j&&j!==h){if(j.nodeType!==f.TEXT_NODE&&!f.dom.contains(h,j)){return false}if(f.dom.domNode(j).prev({ignoreBlankTexts:true})){return false}j=j.parentNode}while(g&&g!==h){if(g.nodeType!==f.TEXT_NODE&&!f.dom.contains(h,g)){return false}if(f.dom.domNode(g).next({ignoreBlankTexts:true})){return false}g=g.parentNode}return(f.lang.array(k).contains(h.nodeName))?h:false},deselect:function(){var g=this.getSelection();g&&g.removeAllRanges()}})})(wysihtml5);(function(j,b){var v="span";var d=/\s+/g;function a(y,w,x){if(!y.className){return false}var z=y.className.match(x)||[];return z[z.length-1]===w}function e(y,w){if(!y.getAttribute||!y.getAttribute("style")){return false}var x=y.getAttribute("style").match(w);return(y.getAttribute("style").match(w))?true:false}function p(x,y,w){if(x.getAttribute("style")){u(x,w);if(x.getAttribute("style")&&!(/^\s*$/).test(x.getAttribute("style"))){x.setAttribute("style",y+";"+x.getAttribute("style"))}else{x.setAttribute("style",y)}}else{x.setAttribute("style",y)}}function k(y,w,x){if(y.className){n(y,x);y.className+=" "+w}else{y.className=w}}function n(x,w){if(x.className){x.className=x.className.replace(w,"")}}function u(A,x){var z,w=[];if(A.getAttribute("style")){z=A.getAttribute("style").split(";");for(var y=z.length;y--;){if(!z[y].match(x)&&!(/^\s*$/).test(z[y])){w.push(z[y])}}if(w.length){A.setAttribute("style",w.join(";"))}else{A.removeAttribute("style")}}}function h(C,B){var x=[],D=B.split(";"),A=C.getAttribute("style");if(A){A=A.replace(/\s/gi,"").toLowerCase();x.push(new RegExp("(^|\\s|;)"+B.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var z=D.length;z-->0;){if(!(/^\s*$/).test(D[z])){x.push(new RegExp("(^|\\s|;)"+D[z].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"))}}for(var y=0,w=x.length;y<w;y++){if(A.match(x[y])){return x[y]}}}return false}function l(z,w,y,x){if(y){return h(z,y)}else{if(x){return j.dom.hasClass(z,x)}else{return b.dom.arrayContains(w,z.tagName.toLowerCase())}}}function s(w,x,A,z){for(var y=w.length;y--;){if(!l(w[y],x,A,z)){return false}}return w.length?true:false}function i(y,x,w){var z=h(y,x);if(z){u(y,z);return"remove"}else{p(y,x,w);return"change"}}function r(x,w){return x.className.replace(d," ")==w.className.replace(d," ")}function g(x){var w=x.parentNode;while(x.firstChild){w.insertBefore(x.firstChild,x)}w.removeChild(x)}function f(C,A){if(C.attributes.length!=A.attributes.length){return false}for(var B=0,w=C.attributes.length,z,x,y;B<w;++B){z=C.attributes[B];y=z.name;if(y!="class"){x=A.attributes.getNamedItem(y);if(z.specified!=x.specified){return false}if(z.specified&&z.nodeValue!==x.nodeValue){return false}}}return true}function q(w,x){if(b.dom.isCharacterDataNode(w)){if(x==0){return !!w.previousSibling}else{if(x==w.length){return !!w.nextSibling}else{return true}}}return x>0&&x<w.childNodes.length}function o(A,y,z,w){var x;if(b.dom.isCharacterDataNode(y)){if(z==0){z=b.dom.getNodeIndex(y);y=y.parentNode}else{if(z==y.length){z=b.dom.getNodeIndex(y)+1;y=y.parentNode}else{x=b.dom.splitDataNode(y,z)}}}if(!x){if(!w||y!==w){x=y.cloneNode(false);if(x.id){x.removeAttribute("id")}var B;while((B=y.childNodes[z])){x.appendChild(B)}b.dom.insertAfter(x,y)}}return(y==A)?x:o(A,x.parentNode,b.dom.getNodeIndex(x),w)}function m(w){this.isElementMerge=(w.nodeType==j.ELEMENT_NODE);this.firstTextNode=this.isElementMerge?w.lastChild:w;this.textNodes=[this.firstTextNode]}m.prototype={doMerge:function(){var B=[],A,y,z;for(var x=0,w=this.textNodes.length;x<w;++x){A=this.textNodes[x];y=A.parentNode;B[x]=A.data;if(x){y.removeChild(A);if(!y.hasChildNodes()){y.parentNode.removeChild(y)}}}this.firstTextNode.data=z=B.join("");return z},getLength:function(){var x=this.textNodes.length,w=0;while(x--){w+=this.textNodes[x].length}return w},toString:function(){var y=[];for(var x=0,w=this.textNodes.length;x<w;++x){y[x]="'"+this.textNodes[x].data+"'"}return"[Merge("+y.join(",")+")]"}};function t(w,z,y,A,C,B,x){this.tagNames=w||[v];this.cssClass=z||((z===false)?false:"");this.similarClassRegExp=y;this.cssStyle=C||"";this.similarStyleRegExp=B;this.normalize=A;this.applyToAnyTagName=false;this.container=x}t.prototype={getAncestorWithClass:function(x){var w;while(x){w=this.cssClass?a(x,this.cssClass,this.similarClassRegExp):(this.cssStyle!=="")?false:true;if(x.nodeType==j.ELEMENT_NODE&&x.getAttribute("contenteditable")!="false"&&b.dom.arrayContains(this.tagNames,x.tagName.toLowerCase())&&w){return x}x=x.parentNode}return false},getAncestorWithStyle:function(w){var x;while(w){x=this.cssStyle?e(w,this.similarStyleRegExp):false;if(w.nodeType==j.ELEMENT_NODE&&w.getAttribute("contenteditable")!="false"&&b.dom.arrayContains(this.tagNames,w.tagName.toLowerCase())&&x){return w}w=w.parentNode}return false},getMatchingAncestor:function(x){var w=this.getAncestorWithClass(x),y=false;if(!w){w=this.getAncestorWithStyle(x);if(w){y="style"}}else{if(this.cssStyle){y="class"}}return{element:w,type:y}},postApply:function(I,E){var w=I[0],x=I[I.length-1];var z=[],J;var B=w,y=x;var G=0,K=x.length;var A,D;for(var C=0,F=I.length;C<F;++C){A=I[C];D=null;if(A&&A.parentNode){D=this.getAdjacentMergeableTextNode(A.parentNode,false)}if(D){if(!J){J=new m(D);z.push(J)}J.textNodes.push(A);if(A===w){B=J.firstTextNode;G=B.length}if(A===x){y=J.firstTextNode;K=J.getLength()}}else{J=null}}if(x&&x.parentNode){var H=this.getAdjacentMergeableTextNode(x.parentNode,true);if(H){if(!J){J=new m(x);z.push(J)}J.textNodes.push(H)}}if(z.length){for(C=0,F=z.length;C<F;++C){z[C].doMerge()}E.setStart(B,G);E.setEnd(y,K)}},getAdjacentMergeableTextNode:function(y,w){var A=(y.nodeType==j.TEXT_NODE);var x=A?y.parentNode:y;var B;var z=w?"nextSibling":"previousSibling";if(A){B=y[z];if(B&&B.nodeType==j.TEXT_NODE){return B}}else{B=x[z];if(B&&this.areElementsMergeable(y,B)){return B[w?"firstChild":"lastChild"]}}return null},areElementsMergeable:function(x,w){return b.dom.arrayContains(this.tagNames,(x.tagName||"").toLowerCase())&&b.dom.arrayContains(this.tagNames,(w.tagName||"").toLowerCase())&&r(x,w)&&f(x,w)},createContainer:function(x){var w=x.createElement(this.tagNames[0]);if(this.cssClass){w.className=this.cssClass}if(this.cssStyle){w.setAttribute("style",this.cssStyle)}return w},applyToTextNode:function(y){var x=y.parentNode;if(x.childNodes.length==1&&b.dom.arrayContains(this.tagNames,x.tagName.toLowerCase())){if(this.cssClass){k(x,this.cssClass,this.similarClassRegExp)}if(this.cssStyle){p(x,this.cssStyle,this.similarStyleRegExp)}}else{var w=this.createContainer(b.dom.getDocument(y));y.parentNode.insertBefore(w,y);w.appendChild(y)}},isRemovable:function(w){return b.dom.arrayContains(this.tagNames,w.tagName.toLowerCase())&&j.lang.string(w.className).trim()===""&&(!w.getAttribute("style")||j.lang.string(w.getAttribute("style")).trim()==="")},undoToTextNode:function(C,x,B,A){var D=(B)?false:true,y=B||A,z=false;if(!x.containsNode(y)){var w=x.cloneRange();w.selectNode(y);if(w.isPointInRange(x.endContainer,x.endOffset)&&q(x.endContainer,x.endOffset)){o(y,x.endContainer,x.endOffset,this.container);x.setEndAfter(y)}if(w.isPointInRange(x.startContainer,x.startOffset)&&q(x.startContainer,x.startOffset)){y=o(y,x.startContainer,x.startOffset,this.container)}}if(!D&&this.similarClassRegExp){n(y,this.similarClassRegExp)}if(D&&this.similarStyleRegExp){z=(i(y,this.cssStyle,this.similarStyleRegExp)==="change")}if(this.isRemovable(y)&&!z){g(y)}},applyToRange:function(y){var B;for(var x=y.length;x--;){B=y[x].getNodes([j.TEXT_NODE]);if(!B.length){try{var A=this.createContainer(y[x].endContainer.ownerDocument);y[x].surroundContents(A);this.selectNode(y[x],A);return}catch(C){}}y[x].splitBoundaries();B=y[x].getNodes([j.TEXT_NODE]);if(B.length){var D;for(var z=0,w=B.length;z<w;++z){D=B[z];if(!this.getMatchingAncestor(D).element){this.applyToTextNode(D)}}y[x].setStart(B[0],0);D=B[B.length-1];y[x].setEnd(D,D.length);if(this.normalize){this.postApply(B,y[x])}}}},undoToRange:function(C){var E,y,z,w,B;for(var F=C.length;F--;){E=C[F].getNodes([j.TEXT_NODE]);if(E.length){C[F].splitBoundaries();E=C[F].getNodes([j.TEXT_NODE])}else{var G=C[F].endContainer.ownerDocument,x=G.createTextNode(j.INVISIBLE_SPACE);C[F].insertNode(x);C[F].selectNode(x);E=[x]}for(var A=0,D=E.length;A<D;++A){if(C[F].isValid()){y=E[A];B=this.getMatchingAncestor(y);if(B.type==="style"){this.undoToTextNode(y,C[F],false,B.element)}else{if(B.element){this.undoToTextNode(y,C[F],B.element)}}}}if(D==1){this.selectNode(C[F],E[0])}else{C[F].setStart(E[0],0);y=E[E.length-1];C[F].setEnd(y,y.length);if(this.normalize){this.postApply(E,C[F])}}}},selectNode:function(x,A){var z=A.nodeType===j.ELEMENT_NODE,w="canHaveHTML" in A?A.canHaveHTML:true,y=z?A.innerHTML:A.data,C=(y===""||y===j.INVISIBLE_SPACE);if(C&&z&&w){try{A.innerHTML=j.INVISIBLE_SPACE}catch(B){}}x.selectNodeContents(A);if(C&&z){x.collapse(false)}else{if(C){x.setStartAfter(A);x.setEndAfter(A)}}},getTextSelectedByRange:function(A,w){var x=w.cloneRange();x.selectNodeContents(A);var y=x.intersection(w);var z=y?y.toString():"";x.detach();return z},isAppliedToRange:function(A){var F=[],E="full",z,w,C;for(var D=A.length;D--;){C=A[D].getNodes([j.TEXT_NODE]);if(!C.length){z=this.getMatchingAncestor(A[D].startContainer).element;return(z)?{elements:[z],coverage:E}:false}for(var y=0,B=C.length,x;y<B;++y){x=this.getTextSelectedByRange(C[y],A[D]);z=this.getMatchingAncestor(C[y]).element;if(z&&x!=""){F.push(z);if(j.dom.getTextNodes(z,true).length===1){E="full"}else{if(E==="full"){E="inline"}}}else{if(!z){E="partial"}}}}return(F.length)?{elements:F,coverage:E}:false},toggleRange:function(w){var y=this.isAppliedToRange(w),x;if(y){if(y.coverage==="full"){this.undoToRange(w)}else{if(y.coverage==="inline"){x=s(y.elements,this.tagNames,this.cssStyle,this.cssClass);this.undoToRange(w);if(!x){this.applyToRange(w)}}else{if(!s(y.elements,this.tagNames,this.cssStyle,this.cssClass)){this.undoToRange(w)}this.applyToRange(w)}}}else{this.applyToRange(w)}}};j.selection.HTMLApplier=t})(wysihtml5,rangy);wysihtml5.Commands=Base.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.doc=this.composer.doc},support:function(a){return wysihtml5.browser.supportsCommand(this.doc,a)},exec:function(h,d){var g=wysihtml5.commands[h],b=wysihtml5.lang.array(arguments).get(),i=g&&g.exec,a=null;this.editor.fire("beforecommand:composer");if(i){b.unshift(this.composer);a=i.apply(g,b)}else{try{a=this.doc.execCommand(h,false,d)}catch(f){}}this.editor.fire("aftercommand:composer");return a},state:function(g,a){var f=wysihtml5.commands[g],b=wysihtml5.lang.array(arguments).get(),h=f&&f.state;if(h){b.unshift(this.composer);return h.apply(f,b)}else{try{return this.doc.queryCommandState(g)}catch(d){return false}}},stateValue:function(d){var b=wysihtml5.commands[d],a=wysihtml5.lang.array(arguments).get(),e=b&&b.stateValue;if(e){a.unshift(this.composer);return e.apply(b,a)}else{return false}}});wysihtml5.commands.bold={exec:function(a,b){wysihtml5.commands.formatInline.execWithToggle(a,b,"b")},state:function(a,b){return wysihtml5.commands.formatInline.state(a,b,"b")}};(function(g){var d,b="A",f=g.dom;function a(h,n){var v=h.doc,s="_wysihtml5-temp-"+(+new Date()),x=/non-matching-class/g,r=0,l,k,q,u,p,o,t,w,m;g.commands.formatInline.exec(h,d,b,s,x,d,d,true,true);k=v.querySelectorAll(b+"."+s);l=k.length;for(;r<l;r++){q=k[r];q.removeAttribute("class");for(m in n){if(m!=="text"){q.setAttribute(m,n[m])}}}o=q;if(l===1){t=f.getTextContent(q);u=!!q.querySelector("*");p=t===""||t===g.INVISIBLE_SPACE;if(!u&&p){f.setTextContent(q,n.text||q.href);w=v.createTextNode(" ");h.selection.setAfter(q);f.insert(w).after(q);o=w}}h.selection.setAfter(o)}function e(m,n,i){var o;for(var h=n.length;h--;){o=n[h].attributes;for(var l=o.length;l--;){n[h].removeAttribute(o.item(l).name)}for(var k in i){if(i.hasOwnProperty(k)){n[h].setAttribute(k,i[k])}}}}g.commands.createLink={exec:function(h,k,j){var i=this.state(h,k);if(i){h.selection.executeAndRestore(function(){e(h,i,j)})}else{j=typeof(j)==="object"?j:{href:j};a(h,j)}},state:function(h,i){return g.commands.formatInline.state(h,i,"A")}}})(wysihtml5);(function(d){var b=d.dom;function a(f,l){var k=l.length,g=0,e,j,h;for(;g<k;g++){e=l[g];j=b.getParentElement(e,{nodeName:"code"});h=b.getTextContent(e);if(h.match(b.autoLink.URL_REG_EXP)&&!j){j=b.renameElement(e,"code")}else{b.replaceWithChildNodes(e)}}}d.commands.removeLink={exec:function(e,g){var f=this.state(e,g);if(f){e.selection.executeAndRestore(function(){a(e,f)})}},state:function(e,f){return d.commands.formatInline.state(e,f,"A")}}})(wysihtml5);(function(b){var a=/wysiwyg-font-size-[0-9a-z\-]+/g;b.commands.fontSize={exec:function(d,f,e){b.commands.formatInline.execWithToggle(d,f,"span","wysiwyg-font-size-"+e,a)},state:function(d,f,e){return b.commands.formatInline.state(d,f,"span","wysiwyg-font-size-"+e,a)}}})(wysihtml5);(function(b){var a=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;b.commands.fontSizeStyle={exec:function(d,f,e){e=(typeof(e)=="object")?e.size:e;if(!(/^\s*$/).test(e)){b.commands.formatInline.execWithToggle(d,f,"span",false,false,"font-size:"+e,a)}},state:function(d,f,e){return b.commands.formatInline.state(d,f,"span",false,false,"font-size",a)},stateValue:function(e,i){var d=this.state(e,i),h,f,g=false;if(d&&b.lang.object(d).isArray()){d=d[0]}if(d){h=d.getAttribute("style");if(h){return b.quirks.styleParser.parseFontSize(h)}}return false}}})(wysihtml5);(function(b){var a=/wysiwyg-color-[0-9a-z]+/g;b.commands.foreColor={exec:function(e,f,d){b.commands.formatInline.execWithToggle(e,f,"span","wysiwyg-color-"+d,a)},state:function(e,f,d){return b.commands.formatInline.state(e,f,"span","wysiwyg-color-"+d,a)}}})(wysihtml5);(function(b){var a=/(\s|^)color\s*:\s*[^;\s]+;?/gi;b.commands.foreColorStyle={exec:function(e,g,d){var f=b.quirks.styleParser.parseColor((typeof(d)=="object")?"color:"+d.color:"color:"+d,"color"),h;if(f){h="color: rgb("+f[0]+","+f[1]+","+f[2]+");";if(f[3]!==1){h+="color: rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+");"}b.commands.formatInline.execWithToggle(e,g,"span",false,false,h,a)}},state:function(d,e){return b.commands.formatInline.state(d,e,"span",false,false,"color",a)},stateValue:function(e,h,g){var d=this.state(e,h),f;if(d&&b.lang.object(d).isArray()){d=d[0]}if(d){f=d.getAttribute("style");if(f){if(f){val=b.quirks.styleParser.parseColor(f,"color");return b.quirks.styleParser.unparseColor(val,g)}}}return false}}})(wysihtml5);(function(b){var a=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;b.commands.bgColorStyle={exec:function(e,g,d){var f=b.quirks.styleParser.parseColor((typeof(d)=="object")?"background-color:"+d.color:"background-color:"+d,"background-color"),h;if(f){h="background-color: rgb("+f[0]+","+f[1]+","+f[2]+");";if(f[3]!==1){h+="background-color: rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+");"}b.commands.formatInline.execWithToggle(e,g,"span",false,false,h,a)}},state:function(d,e){return b.commands.formatInline.state(d,e,"span",false,false,"background-color",a)},stateValue:function(e,i,g){var d=this.state(e,i),f,h=false;if(d&&b.lang.object(d).isArray()){d=d[0]}if(d){f=d.getAttribute("style");if(f){h=b.quirks.styleParser.parseColor(f,"background-color");return b.quirks.styleParser.unparseColor(h,g)}}return false}}})(wysihtml5);(function(n){var e=n.dom,f=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];function j(o,p,q){if(o.className){a(o,q);o.className=n.lang.string(o.className+" "+p).trim()}else{o.className=p}}function h(p,q,o){l(p,o);if(p.getAttribute("style")){p.setAttribute("style",n.lang.string(p.getAttribute("style")+" "+q).trim())}else{p.setAttribute("style",q)}}function a(p,q){var o=q.test(p.className);p.className=p.className.replace(q,"");if(n.lang.string(p.className).trim()==""){p.removeAttribute("class")}return o}function l(q,o){var p=o.test(q.getAttribute("style"));q.setAttribute("style",(q.getAttribute("style")||"").replace(o,""));if(n.lang.string(q.getAttribute("style")||"").trim()==""){q.removeAttribute("style")}return p}function g(p){var o=p.lastChild;if(o&&i(o)){o.parentNode.removeChild(o)}}function i(o){return o.nodeName==="BR"}function k(t,q,u,v,s){var o=q.selection.getOwnRanges();for(var r=o.length;r--;){q.selection.getSelection().removeAllRanges();q.selection.setSelection(o[r]);if(s){var p=e.observe(t,"DOMNodeInserted",function(x){var y=x.target,w;if(y.nodeType!==n.ELEMENT_NODE){return}w=e.getStyle("display").from(y);if(w.substr(0,6)!=="inline"){y.className+=" "+s}})}t.execCommand(u,false,v);if(p){p.stop()}}}function b(p,o){if(p.selection.isCollapsed()){p.selection.selectLine()}var s=p.selection.surround(o);for(var r=0,q=s.length;r<q;r++){n.dom.lineBreaks(s[r]).remove();g(s[r])}}function m(o){return !!n.lang.string(o.className).trim()}function d(o){return !!n.lang.string(o.getAttribute("style")||"").trim()}n.commands.formatBlock={exec:function(p,r,w,t,D,x,q){var A=p.doc,C=this.state(p,r,w,t,D,x,q),v=p.config.useLineBreaks,o=v?"DIV":"P",z,B,y,u,s;w=typeof(w)==="string"?w.toUpperCase():w;if(C.length){p.selection.executeAndRestoreRangy(function(){for(var E=C.length;E--;){if(D){B=a(C[E],D)}if(q){u=l(C[E],q)}if((u||B)&&w===null&&C[E].nodeName!=o){return}var G=m(C[E]),F=d(C[E]);if(!G&&!F&&(v||w==="P")){n.dom.lineBreaks(C[E]).add();e.replaceWithChildNodes(C[E])}else{e.renameElement(C[E],w==="P"?"DIV":o)}}});return}if(w===null||n.lang.array(f).contains(w)){z=p.selection.findNodesInSelection(f).concat(p.selection.getSelectedOwnNodes());p.selection.executeAndRestoreRangy(function(){for(var E=z.length;E--;){s=e.getParentElement(z[E],{nodeName:f});if(s==p.element){s=null}if(s){if(w){s=e.renameElement(s,w)}if(t){j(s,t,D)}if(x){h(s,x,q)}y=true}}});if(y){return}}b(p,{nodeName:(w||o),className:t||null,cssStyle:x||null})},state:function(o,s,w,u,z,x,p){var q=o.selection.getSelectedOwnNodes(),v=[],y;w=typeof(w)==="string"?w.toUpperCase():w;for(var t=0,r=q.length;t<r;t++){y=e.getParentElement(q[t],{nodeName:w,className:u,classRegExp:z,cssStyle:x,styleRegExp:p});if(y&&n.lang.array(v).indexOf(y)==-1){v.push(y)}}if(v.length==0){return false}return v}}})(wysihtml5);wysihtml5.commands.formatCode={exec:function(b,g,f){var e=this.state(b),d,a,h;if(e){b.selection.executeAndRestore(function(){d=e.querySelector("code");wysihtml5.dom.replaceWithChildNodes(e);if(d){wysihtml5.dom.replaceWithChildNodes(d)}})}else{a=b.selection.getRange();h=a.extractContents();e=b.doc.createElement("pre");d=b.doc.createElement("code");if(f){d.className=f}e.appendChild(d);d.appendChild(h);a.insertNode(e);b.selection.selectNode(e)}},state:function(a){var b=a.selection.getSelectedNode();if(b&&b.nodeName&&b.nodeName=="PRE"&&b.firstChild&&b.firstChild.nodeName&&b.firstChild.nodeName=="CODE"){return b}else{return wysihtml5.dom.getParentElement(b,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(b,{nodeName:"PRE"})}}};(function(f){var d={strong:"b",em:"i",b:"strong",i:"em"},e={};function b(h){var g=d[h];return g?[h.toLowerCase(),g.toLowerCase()]:[h.toLowerCase()]}function a(j,k,l,m,h,g){var i=j;if(k){i+=":"+k}if(m){i+=":"+m}if(!e[i]){e[i]=new f.selection.HTMLApplier(b(j),k,l,true,m,h,g)}return e[i]}f.commands.formatInline={exec:function(g,l,j,o,q,p,h,i,k){var m=g.selection.createRange(),n=g.selection.getOwnRanges();if(!n||n.length==0){return false}g.selection.getSelection().removeAllRanges();a(j,o,q,p,h,g.element).toggleRange(n);if(!i){m.setStart(n[0].startContainer,n[0].startOffset);m.setEnd(n[n.length-1].endContainer,n[n.length-1].endOffset);g.selection.setSelection(m);g.selection.executeAndRestore(function(){if(!k){g.cleanUp()}},true,true)}else{if(!k){g.cleanUp()}}},execWithToggle:function(g,j,i,l,o,n,h){var k=this;if(this.state(g,j,i,l,o,n,h)&&g.selection.isCollapsed()&&!g.selection.caretIsLastInSelection()&&!g.selection.caretIsFirstInSelection()){var m=k.state(g,j,i,l,o)[0];g.selection.executeAndRestoreRangy(function(){var p=m.parentNode;g.selection.selectNode(m,true);f.commands.formatInline.exec(g,j,i,l,o,n,h,true,true)})}else{if(this.state(g,j,i,l,o,n,h)&&!g.selection.isCollapsed()){g.selection.executeAndRestoreRangy(function(){f.commands.formatInline.exec(g,j,i,l,o,n,h,true,true)})}else{f.commands.formatInline.exec(g,j,i,l,o,n,h)}}},state:function(g,j,i,l,q,m,h){var o=g.doc,n=d[i]||i,k,p;if(!f.dom.hasElementWithTagName(o,i)&&!f.dom.hasElementWithTagName(o,n)){return false}if(l&&!f.dom.hasElementWithClassName(o,l)){return false}k=g.selection.getOwnRanges();if(!k||k.length===0){return false}p=a(i,l,q,m,h,g.element).isAppliedToRange(k);return(p&&p.elements)?p.elements:false}}})(wysihtml5);(function(a){a.commands.insertBlockQuote={exec:function(f,h){var g=this.state(f,h),d=f.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]),e,b;f.selection.executeAndRestore(function(){if(g){if(f.config.useLineBreaks){a.dom.lineBreaks(g).add()}a.dom.unwrap(g)}else{if(f.selection.isCollapsed()){f.selection.selectLine()}if(d){var i=d.ownerDocument.createElement("blockquote");a.dom.insert(i).after(d);i.appendChild(d)}else{f.selection.surround({nodeName:"blockquote"})}}})},state:function(b,f){var e=b.selection.getSelectedNode(),d=a.dom.getParentElement(e,{nodeName:"BLOCKQUOTE"},false,b.element);return(d)?d:false}}})(wysihtml5);wysihtml5.commands.insertHTML={exec:function(a,d,b){if(a.commands.support(d)){a.doc.execCommand(d,false,b)}else{a.selection.insertHTML(b)}},state:function(){return false}};(function(b){var a="IMG";b.commands.insertImage={exec:function(d,l,g){g=typeof(g)==="object"?g:{src:g};var j=d.doc,h=this.state(d),k,f;if(h){d.selection.setBefore(h);f=h.parentNode;f.removeChild(h);b.dom.removeEmptyTextNodes(f);if(f.nodeName==="A"&&!f.firstChild){d.selection.setAfter(f);f.parentNode.removeChild(f)}b.quirks.redraw(d.element);return}h=j.createElement(a);for(var e in g){h.setAttribute(e==="className"?"class":e,g[e])}d.selection.insertNode(h);if(b.browser.hasProblemsSettingCaretAfterImg()){k=j.createTextNode(b.INVISIBLE_SPACE);d.selection.insertNode(k);d.selection.setAfter(k)}else{d.selection.setAfter(h)}},state:function(e){var g=e.doc,f,h,d;if(!b.dom.hasElementWithTagName(g,a)){return false}f=e.selection.getSelectedNode();if(!f){return false}if(f.nodeName===a){return f}if(f.nodeType!==b.ELEMENT_NODE){return false}h=e.selection.getText();h=b.lang.string(h).trim();if(h){return false}d=e.selection.getNodes(b.ELEMENT_NODE,function(i){return i.nodeName==="IMG"});if(d.length!==1){return false}return d[0]}}})(wysihtml5);(function(b){var a="<br>"+(b.browser.needsSpaceAfterLineBreak()?" ":"");b.commands.insertLineBreak={exec:function(d,e){if(d.commands.support(e)){d.doc.execCommand(e,false,null);if(!b.browser.autoScrollsToCaret()){d.selection.scrollIntoView()}}else{d.commands.exec("insertHTML",a)}},state:function(){return false}}})(wysihtml5);wysihtml5.commands.insertOrderedList={exec:function(a,b){wysihtml5.commands.insertList.exec(a,b,"OL")},state:function(a,b){return wysihtml5.commands.insertList.state(a,b,"OL")}};wysihtml5.commands.insertUnorderedList={exec:function(a,b){wysihtml5.commands.insertList.exec(a,b,"UL")},state:function(a,b){return wysihtml5.commands.insertList.state(a,b,"UL")}};wysihtml5.commands.insertList=(function(h){var f=function(j,i){if(j&&j.nodeName){if(typeof i==="string"){i=[i]}for(var k=i.length;k--;){if(j.nodeName===i[k]){return true}}}return false};var d=function(m,n,l){var k={el:null,other:false};if(m){var i=h.dom.getParentElement(m,{nodeName:"LI"}),j=(n==="UL")?"OL":"UL";if(f(m,n)){k.el=m}else{if(f(m,j)){k={el:m,other:true}}else{if(i){if(f(i.parentNode,n)){k.el=i.parentNode}else{if(f(i.parentNode,j)){k={el:i.parentNode,other:true}}}}}}}if(k.el&&!l.element.contains(k.el)){k.el=null}return k};var b=function(k,n,j){var i=(n==="UL")?"OL":"UL",m,l;j.selection.executeAndRestore(function(){var q=g(i,j);if(q.length){for(var o=q.length;o--;){h.dom.renameElement(q[o],n.toLowerCase())}}else{l=g(["OL","UL"],j);for(var p=l.length;p--;){h.dom.resolveList(l[p],j.config.useLineBreaks)}h.dom.resolveList(k,j.config.useLineBreaks)}})};var a=function(k,l,j){var i=(l==="UL")?"OL":"UL";j.selection.executeAndRestore(function(){var n=[k].concat(g(i,j));for(var m=n.length;m--;){h.dom.renameElement(n[m],l.toLowerCase())}})};var g=function(m,k){var i=k.selection.getOwnRanges(),j=[];for(var l=i.length;l--;){j=j.concat(i[l].getNodes([1],function(n){return f(n,m)}))}return j};var e=function(j,i){i.selection.executeAndRestoreRangy(function(){var l="_wysihtml5-temp-"+new Date().getTime(),k=i.selection.deblockAndSurround({nodeName:"div",className:l}),o,m;var n=/\uFEFF/g;k.innerHTML=k.innerHTML.replace(n,"");if(k){o=h.lang.array(["","<br>",h.INVISIBLE_SPACE]).contains(k.innerHTML);m=h.dom.convertToList(k,j.toLowerCase(),i.parent.config.uneditableContainerClassname);if(o){i.selection.selectNode(m.querySelector("li"),true)}}})};return{exec:function(i,n,o){var m=i.doc,l=(o==="OL")?"insertOrderedList":"insertUnorderedList",k=i.selection.getSelectedNode(),j=d(k,o,i);if(!j.el){if(i.commands.support(l)){m.execCommand(l,false,null)}else{e(o,i)}}else{if(j.other){a(j.el,o,i)}else{b(j.el,o,i)}}},state:function(i,l,m){var k=i.selection.getSelectedNode(),j=d(k,m,i);return(j.el&&!j.other)?j.el:false}}})(wysihtml5);wysihtml5.commands.italic={exec:function(a,b){wysihtml5.commands.formatInline.execWithToggle(a,b,"i")},state:function(a,b){return wysihtml5.commands.formatInline.state(a,b,"i")}};(function(d){var b="wysiwyg-text-align-center",a=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyCenter={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,b,a)}}})(wysihtml5);(function(d){var b="wysiwyg-text-align-left",a=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyLeft={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,b,a)}}})(wysihtml5);(function(d){var b="wysiwyg-text-align-right",a=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyRight={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,b,a)}}})(wysihtml5);(function(d){var b="wysiwyg-text-align-justify",a=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyFull={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,b,a)}}})(wysihtml5);(function(d){var b="text-align: right;",a=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;d.commands.alignRightStyle={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,null,null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,null,null,b,a)}}})(wysihtml5);(function(d){var b="text-align: left;",a=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;d.commands.alignLeftStyle={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,null,null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,null,null,b,a)}}})(wysihtml5);(function(d){var b="text-align: center;",a=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;d.commands.alignCenterStyle={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,null,null,b,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,null,null,b,a)}}})(wysihtml5);wysihtml5.commands.redo={exec:function(a){return a.undoManager.redo()},state:function(a){return false}};wysihtml5.commands.underline={exec:function(a,b){wysihtml5.commands.formatInline.execWithToggle(a,b,"u")},state:function(a,b){return wysihtml5.commands.formatInline.state(a,b,"u")}};wysihtml5.commands.undo={exec:function(a){return a.undoManager.undo()},state:function(a){return false}};wysihtml5.commands.createTable={exec:function(b,g,e){var a,f,d;if(e&&e.cols&&e.rows&&parseInt(e.cols,10)>0&&parseInt(e.rows,10)>0){if(e.tableStyle){d='<table style="'+e.tableStyle+'">'}else{d="<table>"}d+="<tbody>";for(f=0;f<e.rows;f++){d+="<tr>";for(a=0;a<e.cols;a++){d+="<td>&nbsp;</td>"}d+="</tr>"}d+="</tbody></table>";b.commands.exec("insertHTML",d)}},state:function(a,b){return false}};wysihtml5.commands.mergeTableCells={exec:function(a,b){if(a.tableSelection&&a.tableSelection.start&&a.tableSelection.end){if(this.state(a,b)){wysihtml5.dom.table.unmergeCell(a.tableSelection.start)}else{wysihtml5.dom.table.mergeCellsBetween(a.tableSelection.start,a.tableSelection.end)}}},state:function(b,d){if(b.tableSelection){var e=b.tableSelection.start,a=b.tableSelection.end;if(e&&a&&e==a&&((wysihtml5.dom.getAttribute(e,"colspan")&&parseInt(wysihtml5.dom.getAttribute(e,"colspan"),10)>1)||(wysihtml5.dom.getAttribute(e,"rowspan")&&parseInt(wysihtml5.dom.getAttribute(e,"rowspan"),10)>1))){return[e]}}return false}};wysihtml5.commands.addTableCells={exec:function(a,e,d){if(a.tableSelection&&a.tableSelection.start&&a.tableSelection.end){var b=wysihtml5.dom.table.orderSelectionEnds(a.tableSelection.start,a.tableSelection.end);if(d=="before"||d=="above"){wysihtml5.dom.table.addCells(b.start,d)}else{if(d=="after"||d=="below"){wysihtml5.dom.table.addCells(b.end,d)}}setTimeout(function(){a.tableSelection.select(b.start,b.end)},0)}},state:function(a,b){return false}};wysihtml5.commands.deleteTableCells={exec:function(d,h,g){if(d.tableSelection&&d.tableSelection.start&&d.tableSelection.end){var e=wysihtml5.dom.table.orderSelectionEnds(d.tableSelection.start,d.tableSelection.end),a=wysihtml5.dom.table.indexOf(e.start),b,f=d.tableSelection.table;wysihtml5.dom.table.removeCells(e.start,g);setTimeout(function(){b=wysihtml5.dom.table.findCell(f,a);if(!b){if(g=="row"){b=wysihtml5.dom.table.findCell(f,{row:a.row-1,col:a.col})}if(g=="column"){b=wysihtml5.dom.table.findCell(f,{row:a.row,col:a.col-1})}}if(b){d.tableSelection.select(b,b)}},0)}},state:function(a,b){return false}};wysihtml5.commands.indentList={exec:function(a,e,d){var b=a.selection.getSelectionParentsByTag("LI");if(b){return this.tryToPushLiLevel(b,a.selection)}return false},state:function(a,b){return false},tryToPushLiLevel:function(b,d){var a,f,i,h,g,e=false;d.executeAndRestoreRangy(function(){for(var j=b.length;j--;){h=b[j];a=(h.parentNode.nodeName==="OL")?"OL":"UL";f=h.ownerDocument.createElement(a);i=wysihtml5.dom.domNode(h).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]});g=(i)?i.querySelector("ul, ol"):null;if(i){if(g){g.appendChild(h)}else{f.appendChild(h);i.appendChild(f)}e=true}}});return e}};wysihtml5.commands.outdentList={exec:function(a,e,d){var b=a.selection.getSelectionParentsByTag("LI");if(b){return this.tryToPullLiLevel(b,a)}return false},state:function(a,b){return false},tryToPullLiLevel:function(k,a){var d,b,f,i,j,h,g,l=false,e=this;a.selection.executeAndRestoreRangy(function(){for(var n=k.length;n--;){h=k[n];if(h.parentNode){d=h.parentNode;if(d.tagName==="OL"||d.tagName==="UL"){l=true;b=wysihtml5.dom.getParentElement(d.parentNode,{nodeName:["OL","UL"]},false,a.element);f=wysihtml5.dom.getParentElement(d.parentNode,{nodeName:["LI"]},false,a.element);if(b&&f){if(h.nextSibling){g=e.getAfterList(d,h);h.appendChild(g)}b.insertBefore(h,f.nextSibling)}else{if(h.nextSibling){g=e.getAfterList(d,h);h.appendChild(g)}for(var m=h.childNodes.length;m--;){d.parentNode.insertBefore(h.childNodes[m],d.nextSibling)}d.parentNode.insertBefore(document.createElement("br"),d.nextSibling);h.parentNode.removeChild(h)}if(d.childNodes.length===0){d.parentNode.removeChild(d)}}}}});return l},getAfterList:function(b,e){var d=b.nodeName,a=document.createElement(d);while(e.nextSibling){a.appendChild(e.nextSibling)}return a}};(function(m){var h=90,k=89,l=8,b=46,a=25,j="data-wysihtml5-selection-node",d="data-wysihtml5-selection-offset",i='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+m.INVISIBLE_SPACE+"</span>",g='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+m.INVISIBLE_SPACE+"</span>",f=m.dom;function e(o){var n;while(n=o.querySelector("._wysihtml5-temp")){n.parentNode.removeChild(n)}}m.UndoManager=m.lang.Dispatcher.extend({constructor:function(n){this.editor=n;this.composer=n.composer;this.element=this.composer.element;this.position=0;this.historyStr=[];this.historyDom=[];this.transact();this._observe()},_observe:function(){var o=this,p=this.composer.sandbox.getDocument(),n;f.observe(this.element,"keydown",function(s){if(s.altKey||(!s.ctrlKey&&!s.metaKey)){return}var t=s.keyCode,q=t===h&&!s.shiftKey,r=(t===h&&s.shiftKey)||(t===k);if(q){o.undo();s.preventDefault()}else{if(r){o.redo();s.preventDefault()}}});f.observe(this.element,"keydown",function(q){var r=q.keyCode;if(r===n){return}n=r;if(r===l||r===b){o.transact()}});this.editor.on("newword:composer",function(){o.transact()}).on("beforecommand:composer",function(){o.transact()})},transact:function(){var w=this.historyStr[this.position-1],q=this.composer.getValue(false,false),p=this.element.offsetWidth>0&&this.element.offsetHeight>0,t,o,r,s,u;if(q===w){return}var n=this.historyStr.length=this.historyDom.length=this.position;if(n>a){this.historyStr.shift();this.historyDom.shift();this.position--}this.position++;if(p){t=this.composer.selection.getRange();o=(t&&t.startContainer)?t.startContainer:this.element;r=(t&&t.startOffset)?t.startOffset:0;if(o.nodeType===m.ELEMENT_NODE){s=o}else{s=o.parentNode;u=this.getChildNodeIndex(s,o)}s.setAttribute(d,r);if(typeof(u)!=="undefined"){s.setAttribute(j,u)}}var v=this.element.cloneNode(!!q);this.historyDom.push(v);this.historyStr.push(q);if(s){s.removeAttribute(d);s.removeAttribute(j)}},undo:function(){this.transact();if(!this.undoPossible()){return}this.set(this.historyDom[--this.position-1]);this.editor.fire("undo:composer")},redo:function(){if(!this.redoPossible()){return}this.set(this.historyDom[++this.position-1]);this.editor.fire("redo:composer")},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(t){this.element.innerHTML="";var o=0,s=t.childNodes,q=t.childNodes.length;for(;o<q;o++){this.element.appendChild(s[o].cloneNode(true))}var r,p,n;if(t.hasAttribute(d)){r=t.getAttribute(d);n=t.getAttribute(j);p=this.element}else{p=this.element.querySelector("["+d+"]")||this.element;r=p.getAttribute(d);n=p.getAttribute(j);p.removeAttribute(d);p.removeAttribute(j)}if(n!==null){p=this.getChildNodeByIndex(p,+n)}this.composer.selection.set(p,r)},getChildNodeIndex:function(o,r){var n=0,q=o.childNodes,p=q.length;for(;n<p;n++){if(q[n]===r){return n}}},getChildNodeByIndex:function(o,n){return o.childNodes[n]}})})(wysihtml5);wysihtml5.views.View=Base.extend({constructor:function(b,d,a){this.parent=b;this.element=d;this.config=a;if(!this.config.noTextarea){this._observeViewChange()}},_observeViewChange:function(){var a=this;this.parent.on("beforeload",function(){a.parent.on("change_view",function(b){if(b===a.name){a.parent.currentView=a;a.show();setTimeout(function(){a.focus()},0)}else{a.hide()}})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")===this.element){return}try{this.element.focus()}catch(a){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});(function(d){var b=d.dom,a=d.browser;d.views.Composer=d.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(f,g,e){this.base(f,g,e);if(!this.config.noTextarea){this.textarea=this.parent.textarea}else{this.editableArea=g}if(this.config.contentEditableMode){this._initContentEditableArea()}else{this._initSandbox()}},clear:function(){this.element.innerHTML=a.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(f,g){var e=this.isEmpty()?"":d.quirks.getCorrectInnerHTML(this.element);if(f!==false){e=this.parent.parse(e,(g===false)?false:true)}return e},setValue:function(f,h){if(h){f=this.parent.parse(f)}try{this.element.innerHTML=f}catch(g){this.element.innerText=f}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"";if(!this.config.noTextarea&&!this.textarea.element.disabled){this.disable();this.enable()}},hide:function(){this._displayStyle=b.getStyle("display").from(this.editableArea);if(this._displayStyle==="none"){this._displayStyle=null}this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer");this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer");this.element.setAttribute("contentEditable","true")},focus:function(f){if(d.browser.doesAsyncFocus()&&this.hasPlaceholderSet()){this.clear()}this.base();var e=this.element.lastChild;if(f&&e&&this.selection){if(e.nodeName==="BR"){this.selection.setBefore(this.element.lastChild)}else{this.selection.setAfter(this.element.lastChild)}}},getTextContent:function(){return b.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==((this.config.noTextarea)?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return(/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i).test(e)||e===""||e==="<br>"||e==="<p></p>"||e==="<p><br></p>"||this.hasPlaceholderSet()},_initContentEditableArea:function(){var e=this;if(this.config.noTextarea){this.sandbox=new b.ContentEditableArea(function(){e._create()},{},this.editableArea)}else{this.sandbox=new b.ContentEditableArea(function(){e._create()});this.editableArea=this.sandbox.getContentEditable();b.insert(this.editableArea).after(this.textarea.element);this._createWysiwygFormField()}},_initSandbox:function(){var e=this;this.sandbox=new b.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets});this.editableArea=this.sandbox.getIframe();var f=this.textarea.element;b.insert(this.editableArea).after(f);this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var e=document.createElement("input");e.type="hidden";e.name="_wysihtml5_mode";e.value=1;b.insert(e).after(this.textarea.element)}},_create:function(){var g=this;this.doc=this.sandbox.getDocument();this.element=(this.config.contentEditableMode)?this.sandbox.getContentEditable():this.doc.body;if(!this.config.noTextarea){this.textarea=this.parent.textarea;this.element.innerHTML=this.textarea.getValue(true,false)}else{this.cleanUp()}this.selection=new d.Selection(this.parent,this.element,this.config.uneditableContainerClassname);this.commands=new d.Commands(this.parent);if(!this.config.noTextarea){b.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element)}b.addClass(this.element,this.config.composerClassName);if(this.config.style&&!this.config.contentEditableMode){this.style()}this.observe();var f=this.config.name;if(f){b.addClass(this.element,f);if(!this.config.contentEditableMode){b.addClass(this.editableArea,f)}}this.enable();if(!this.config.noTextarea&&this.textarea.element.disabled){this.disable()}var e=typeof(this.config.placeholder)==="string"?this.config.placeholder:((this.config.noTextarea)?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"));if(e){b.simulatePlaceholder(this.parent,this,e)}this.commands.exec("styleWithCSS",false);this._initAutoLinking();this._initObjectResizing();this._initUndoManager();this._initLineBreaking();if(!this.config.noTextarea&&(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element)&&!a.isIos()){setTimeout(function(){g.focus(true)},100)}if(!a.clearsContentEditableCorrectly()){d.quirks.ensureProperClearing(this)}if(this.initSync&&this.config.sync){this.initSync()}if(!this.config.noTextarea){this.textarea.hide()}this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var i=this,f=a.canDisableAutoLinking(),g=a.doesAutoLinkingInContentEditable();if(f){this.commands.exec("autoUrlDetect",false)}if(!this.config.autoLink){return}if(!g||(g&&f)){this.parent.on("newword:composer",function(){if(b.getTextContent(i.element).match(b.autoLink.URL_REG_EXP)){i.selection.executeAndRestore(function(n,o){var k=i.element.querySelectorAll("."+i.config.uneditableContainerClassname),m=false;for(var l=k.length;l--;){if(d.dom.contains(k[l],o)){m=true}}if(!m){b.autoLink(o.parentNode,[i.config.uneditableContainerClassname])}})}});b.observe(this.element,"blur",function(){b.autoLink(i.element,[i.config.uneditableContainerClassname])})}var e=this.sandbox.getDocument().getElementsByTagName("a"),j=b.autoLink.URL_REG_EXP,h=function(k){var l=d.lang.string(b.getTextContent(k)).trim();if(l.substr(0,4)==="www."){l="http://"+l}return l};b.observe(this.element,"keydown",function(m){if(!e.length){return}var n=i.selection.getSelectedNode(m.target.ownerDocument),l=b.getParentElement(n,{nodeName:"A"},4),k;if(!l){return}k=h(l);setTimeout(function(){var o=h(l);if(o===k){return}if(o.match(j)){l.setAttribute("href",o)}},0)})},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",true);if(a.supportsEvent("resizeend")){var g=["width","height"],f=g.length,e=this.element;b.observe(e,"resizeend",function(k){var m=k.target||k.srcElement,j=m.style,h=0,l;if(m.nodeName!=="IMG"){return}for(;h<f;h++){l=g[h];if(j[l]){m.setAttribute(l,parseInt(j[l],10));j[l]=""}}d.quirks.redraw(e)})}},_initUndoManager:function(){this.undoManager=new d.UndoManager(this.parent)},_initLineBreaking:function(){var g=this,f=["LI","P","H1","H2","H3","H4","H5","H6"],e=["UL","OL","MENU"];function h(j){var i=b.getParentElement(j,{nodeName:["P","DIV"]},2);if(i&&b.contains(g.element,i)){g.selection.executeAndRestore(function(){if(g.config.useLineBreaks){b.replaceWithChildNodes(i)}else{if(i.nodeName!=="P"){b.renameElement(i,"p")}}})}}if(!this.config.useLineBreaks){b.observe(this.element,["focus","keydown"],function(){if(g.isEmpty()){var i=g.doc.createElement("P");g.element.innerHTML="";g.element.appendChild(i);if(!a.displaysCaretInEmptyContentEditableCorrectly()){i.innerHTML="<br>";g.selection.setBefore(i.firstChild)}else{g.selection.selectNode(i,true)}}})}b.observe(this.element,"keydown",function(i){var j=i.keyCode;if(i.shiftKey){return}if(j!==d.ENTER_KEY&&j!==d.BACKSPACE_KEY){return}var k=b.getParentElement(g.selection.getSelectedNode(),{nodeName:f},4);if(k){setTimeout(function(){var m=g.selection.getSelectedNode(),l;if(k.nodeName==="LI"){if(!m){return}l=b.getParentElement(m,{nodeName:e},2);if(!l){h(m)}}if(j===d.ENTER_KEY&&k.nodeName.match(/^H[1-6]$/)){h(m)}},0);return}if(g.config.useLineBreaks&&j===d.ENTER_KEY&&!d.browser.insertsLineBreaksOnReturn()){i.preventDefault();g.commands.exec("insertLineBreak")}})}})})(wysihtml5);(function(j){var a=j.dom,f=document,d=window,e=f.createElement("div"),b=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],h=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],g=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",j.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"];var i=function(m){if(m.setActive){try{m.setActive()}catch(o){}}else{var n=m.style,p=f.documentElement.scrollTop||f.body.scrollTop,l=f.documentElement.scrollLeft||f.body.scrollLeft,k={position:n.position,top:n.top,left:n.left,WebkitUserSelect:n.WebkitUserSelect};a.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(m);m.focus();a.setStyles(k).on(m);if(d.scrollTo){d.scrollTo(l,p)}}};j.views.Composer.prototype.style=function(){var n=this,m=f.querySelector(":focus"),o=this.textarea.element,r=o.hasAttribute("placeholder"),k=r&&o.getAttribute("placeholder"),p=o.style.display,l=o.disabled,q;this.focusStylesHost=e.cloneNode(false);this.blurStylesHost=e.cloneNode(false);this.disabledStylesHost=e.cloneNode(false);if(r){o.removeAttribute("placeholder")}if(o===m){o.blur()}o.disabled=false;o.style.display=q="none";if((o.getAttribute("rows")&&a.getStyle("height").from(o)==="auto")||(o.getAttribute("cols")&&a.getStyle("width").from(o)==="auto")){o.style.display=q=p}a.copyStyles(h).from(o).to(this.editableArea).andTo(this.blurStylesHost);a.copyStyles(b).from(o).to(this.element).andTo(this.blurStylesHost);a.insertCSS(g).into(this.element.ownerDocument);o.disabled=true;a.copyStyles(h).from(o).to(this.disabledStylesHost);a.copyStyles(b).from(o).to(this.disabledStylesHost);o.disabled=l;o.style.display=p;i(o);o.style.display=q;a.copyStyles(h).from(o).to(this.focusStylesHost);a.copyStyles(b).from(o).to(this.focusStylesHost);o.style.display=p;a.copyStyles(["display"]).from(o).to(this.editableArea);var s=j.lang.array(h).without(["display"]);if(m){m.focus()}else{o.blur()}if(r){o.setAttribute("placeholder",k)}this.parent.on("focus:composer",function(){a.copyStyles(s).from(n.focusStylesHost).to(n.editableArea);a.copyStyles(b).from(n.focusStylesHost).to(n.element)});this.parent.on("blur:composer",function(){a.copyStyles(s).from(n.blurStylesHost).to(n.editableArea);a.copyStyles(b).from(n.blurStylesHost).to(n.element)});this.parent.observe("disable:composer",function(){a.copyStyles(s).from(n.disabledStylesHost).to(n.editableArea);a.copyStyles(b).from(n.disabledStylesHost).to(n.element)});this.parent.observe("enable:composer",function(){a.copyStyles(s).from(n.blurStylesHost).to(n.editableArea);a.copyStyles(b).from(n.blurStylesHost).to(n.element)});return this}})(wysihtml5);(function(h){var f=h.dom,b=h.browser,a={"66":"bold","73":"italic","85":"underline"};var d=function(m,j,k){var i=m.getPreviousNode(j,true),l=m.getSelectedNode();if(l.nodeType!==1&&l.parentNode!==k){l=l.parentNode}if(i){if(l.nodeType==1){var n=l.firstChild;if(i.nodeType==1){while(l.firstChild){i.appendChild(l.firstChild)}}else{while(l.firstChild){j.parentNode.insertBefore(l.firstChild,j)}}if(l.parentNode){l.parentNode.removeChild(l)}m.setBefore(n)}else{if(i.nodeType==1){i.appendChild(l)}else{j.parentNode.insertBefore(l,j)}m.setBefore(l)}}};var g=function(o,m,l,k){if(m.isCollapsed()){if(m.caretIsInTheBeginnig("LI")){o.preventDefault();k.commands.exec("outdentList")}else{if(m.caretIsInTheBeginnig()){o.preventDefault()}else{if(m.caretIsFirstInSelection()&&m.getPreviousNode()&&m.getPreviousNode().nodeName&&(/^H\d$/gi).test(m.getPreviousNode().nodeName)){var i=m.getPreviousNode();o.preventDefault();if((/^\s*$/).test(i.textContent||i.innerText)){i.parentNode.removeChild(i)}else{var j=i.ownerDocument.createRange();j.selectNodeContents(i);j.collapse(false);m.setSelection(j)}}var n=m.caretIsBeforeUneditable();if(n){o.preventDefault();d(m,n,l)}}}}else{if(m.containsUneditable()){o.preventDefault();m.deleteContents()}}};var e=function(i,j){if(!i.selection.isCollapsed()){i.selection.deleteContents()}else{if(i.selection.caretIsInTheBeginnig("LI")){if(i.commands.exec("indentList")){return}}}i.commands.exec("insertHTML","&emsp;")};h.views.Composer.prototype.observe=function(){var o=this,j=this.getValue(false,false),k=(this.sandbox.getIframe)?this.sandbox.getIframe():this.sandbox.getContentEditable(),m=this.element,q=(b.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable)?m:this.sandbox.getWindow(),l=["drop","paste","beforepaste"],p=["drop","paste","mouseup","focus","keyup"];f.observe(k,"DOMNodeRemoved",function(){clearInterval(n);o.parent.fire("destroy:composer")});if(!b.supportsMutationEvents()){var n=setInterval(function(){if(!f.contains(document.documentElement,k)){clearInterval(n);o.parent.fire("destroy:composer")}},250)}f.observe(q,p,function(){setTimeout(function(){o.parent.fire("interaction").fire("interaction:composer")},0)});if(this.config.handleTables){if(!this.tableClickHandle&&this.doc.execCommand&&h.browser.supportsCommand(this.doc,"enableObjectResizing")&&h.browser.supportsCommand(this.doc,"enableInlineTableEditing")){if(this.sandbox.getIframe){this.tableClickHandle=f.observe(k,["focus","mouseup","mouseover"],function(){o.doc.execCommand("enableObjectResizing",false,"false");o.doc.execCommand("enableInlineTableEditing",false,"false");o.tableClickHandle.stop()})}else{setTimeout(function(){o.doc.execCommand("enableObjectResizing",false,"false");o.doc.execCommand("enableInlineTableEditing",false,"false")},0)}}this.tableSelection=h.quirks.tableCellsSelection(m,o.parent)}f.observe(q,"focus",function(r){o.parent.fire("focus",r).fire("focus:composer",r);setTimeout(function(){j=o.getValue(false,false)},0)});f.observe(q,"blur",function(r){if(j!==o.getValue(false,false)){var s=r;if(typeof Object.create=="function"){s=Object.create(r,{type:{value:"change"}})}o.parent.fire("change",s).fire("change:composer",s)}o.parent.fire("blur",r).fire("blur:composer",r)});f.observe(m,"dragenter",function(){o.parent.fire("unset_placeholder")});f.observe(m,l,function(r){o.parent.fire(r.type,r).fire(r.type+":composer",r)});if(this.config.copyedFromMarking){f.observe(m,"copy",function(r){if(r.clipboardData){r.clipboardData.setData("text/html",o.config.copyedFromMarking+o.selection.getHtml());r.preventDefault()}o.parent.fire(r.type,r).fire(r.type+":composer",r)})}f.observe(m,"keyup",function(r){var s=r.keyCode;if(s===h.SPACE_KEY||s===h.ENTER_KEY){o.parent.fire("newword:composer")}});this.parent.on("paste:composer",function(){setTimeout(function(){o.parent.fire("newword:composer")},0)});if(!b.canSelectImagesInContentEditable()){f.observe(m,"mousedown",function(t){var u=t.target;var v=m.querySelectorAll("img"),s=m.querySelectorAll("."+o.config.uneditableContainerClassname+" img"),r=h.lang.array(v).without(s);if(u.nodeName==="IMG"&&h.lang.array(r).contains(u)){o.selection.selectNode(u)}})}if(!b.canSelectImagesInContentEditable()){f.observe(m,"drop",function(r){setTimeout(function(){o.selection.getSelection().removeAllRanges()},0)})}if(b.hasHistoryIssue()&&b.supportsSelectionModify()){f.observe(m,"keydown",function(s){if(!s.metaKey&&!s.ctrlKey){return}var u=s.keyCode,t=m.ownerDocument.defaultView,r=t.getSelection();if(u===37||u===39){if(u===37){r.modify("extend","left","lineboundary");if(!s.shiftKey){r.collapseToStart()}}if(u===39){r.modify("extend","right","lineboundary");if(!s.shiftKey){r.collapseToEnd()}}s.preventDefault()}})}f.observe(m,"keydown",function(r){var s=r.keyCode,t=a[s];if((r.ctrlKey||r.metaKey)&&!r.altKey&&t){o.commands.exec(t);r.preventDefault()}if(s===8){g(r,o.selection,m,o)}else{if(o.config.handleTabKey&&s===9){r.preventDefault();e(o,m)}}});f.observe(m,"keydown",function(s){var u=o.selection.getSelectedNode(true),t=s.keyCode,r;if(u&&u.nodeName==="IMG"&&(t===h.BACKSPACE_KEY||t===h.DELETE_KEY)){r=u.parentNode;r.removeChild(u);if(r.nodeName==="A"&&!r.firstChild){r.parentNode.removeChild(r)}setTimeout(function(){h.quirks.redraw(m)},0);s.preventDefault()}});if(!this.config.contentEditableMode&&b.hasIframeFocusIssue()){f.observe(k,"focus",function(){setTimeout(function(){if(o.doc.querySelector(":focus")!==o.element){o.focus()}},0)});f.observe(this.element,"blur",function(){setTimeout(function(){o.selection.getSelection().removeAllRanges()},0)})}var i={IMG:"Image: ",A:"Link: "};f.observe(m,"mouseover",function(s){var t=s.target,v=t.nodeName,u;if(v!=="A"&&v!=="IMG"){return}var r=t.hasAttribute("title");if(!r){u=i[v]+(t.getAttribute("href")||t.getAttribute("src"));t.setAttribute("title",u)}})}})(wysihtml5);(function(b){var a=400;b.views.Synchronizer=Base.extend({constructor:function(f,d,e){this.editor=f;this.textarea=d;this.composer=e;this._observe()},fromComposerToTextarea:function(d){this.textarea.setValue(b.lang.string(this.composer.getValue(false,false)).trim(),d)},fromTextareaToComposer:function(e){var d=this.textarea.getValue(false,false);if(d){this.composer.setValue(d,e)}else{this.composer.clear();this.editor.fire("set_placeholder")}},sync:function(d){if(this.editor.currentView.name==="textarea"){this.fromTextareaToComposer(d)}else{this.fromComposerToTextarea(d)}},_observe:function(){var d,f=this,e=this.textarea.element.form,h=function(){d=setInterval(function(){f.fromComposerToTextarea()},a)},g=function(){clearInterval(d);d=null};h();if(e){b.dom.observe(e,"submit",function(){f.sync(true)});b.dom.observe(e,"reset",function(){setTimeout(function(){f.fromTextareaToComposer()},0)})}this.editor.on("change_view",function(i){if(i==="composer"&&!d){f.fromTextareaToComposer(true);h()}else{if(i==="textarea"){f.fromComposerToTextarea(true);g()}}});this.editor.on("destroy:composer",g)}})})(wysihtml5);wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(b,d,a){this.base(b,d,a);this._observe()},clear:function(){this.element.value=""},getValue:function(b){var a=this.isEmpty()?"":this.element.value;if(b!==false){a=this.parent.parse(a)}return a},setValue:function(a,b){if(b){a=this.parent.parse(a)}this.element.value=a},cleanUp:function(){var a=this.parent.parse(this.element.value);this.element.value=a},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),a=this.element.getAttribute("placeholder")||null,b=this.element.value,d=!b;return(e&&d)||(b===a)},isEmpty:function(){return !wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var d=this.element,e=this.parent,a={focusin:"focus",focusout:"blur"},b=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.on("beforeload",function(){wysihtml5.dom.observe(d,b,function(g){var f=a[g.type]||g.type;e.fire(f).fire(f+":textarea")});wysihtml5.dom.observe(d,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}});(function(d){var b;var a={name:b,style:true,toolbar:b,showToolbarAfterInit:true,autoLink:true,handleTables:true,handleTabKey:true,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},pasteParserRulesets:null,parser:d.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:true,stylesheets:[],placeholderText:b,supportTouchDevices:true,cleanUp:true,contentEditableMode:false,uneditableContainerClassname:"wysihtml5-uneditable-container",copyedFromMarking:'<meta name="copied-from" content="wysihtml5">'};d.Editor=d.lang.Dispatcher.extend({constructor:function(g,e){this.editableElement=typeof(g)==="string"?document.getElementById(g):g;this.config=d.lang.object({}).merge(a).merge(e).get();this._isCompatible=d.browser.supported();if(this.editableElement.nodeName.toLowerCase()!="textarea"){this.config.contentEditableMode=true;this.config.noTextarea=true}if(!this.config.noTextarea){this.textarea=new d.views.Textarea(this,this.editableElement,this.config);this.currentView=this.textarea}if(!this._isCompatible||(!this.config.supportTouchDevices&&d.browser.isTouchDevice())){var f=this;setTimeout(function(){f.fire("beforeload").fire("load")},0);return}d.dom.addClass(document.body,this.config.bodyClassName);this.composer=new d.views.Composer(this,this.editableElement,this.config);this.currentView=this.composer;if(typeof(this.config.parser)==="function"){this._initParser()}this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){if(!this.config.noTextarea){this.synchronizer=new d.views.Synchronizer(this,this.textarea,this.composer)}if(this.config.toolbar){this.toolbar=new d.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit)}},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(e,f){return this.currentView.getValue(e,f)},setValue:function(e,f){this.fire("unset_placeholder");if(!e){return this.clear()}this.currentView.setValue(e,f);return this},cleanUp:function(){this.currentView.cleanUp()},focus:function(e){this.currentView.focus(e);return this},disable:function(){this.currentView.disable();return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(f,h){var e=(this.config.contentEditableMode)?document:((this.composer)?this.composer.sandbox.getDocument():null);var g=this.config.parser(f,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:e,uneditableClass:this.config.uneditableContainerClassname,clearInternals:h});if(typeof(f)==="object"){d.quirks.redraw(f)}return g},_initParser:function(){var g=this,f,e;if(d.browser.supportsModenPaste()){this.on("paste:composer",function(h){h.preventDefault();f=d.dom.getPastedHtml(h);if(f){g._cleanAndPaste(f)}})}else{this.on("beforepaste:composer",function(h){h.preventDefault();d.dom.getPastedHtmlWithDiv(g.composer,function(i){if(i){g._cleanAndPaste(i)}})})}},_cleanAndPaste:function(f){var e=d.quirks.cleanPastedHTML(f,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],uneditableClass:this.config.uneditableContainerClassname});this.composer.selection.deleteContents();this.composer.selection.insertHTML(e)}})})(wysihtml5);(function(g){var f=g.dom,a="wysihtml5-command-dialog-opened",e="input, select, textarea",b="[data-wysihtml5-dialog-field]",d="data-wysihtml5-dialog-field";g.toolbar.Dialog=g.lang.Dispatcher.extend({constructor:function(i,h){this.link=i;this.container=h},_observe:function(){if(this._observed){return}var l=this,m=function(o){var i=l._serialize();if(i==l.elementToChange){l.fire("edit",i)}else{l.fire("save",i)}l.hide();o.preventDefault();o.stopPropagation()};f.observe(l.link,"click",function(){if(f.hasClass(l.link,a)){setTimeout(function(){l.hide()},0)}});f.observe(this.container,"keydown",function(i){var o=i.keyCode;if(o===g.ENTER_KEY){m(i)}if(o===g.ESCAPE_KEY){l.fire("cancel");l.hide()}});f.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",m);f.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(i){l.fire("cancel");l.hide();i.preventDefault();i.stopPropagation()});var j=this.container.querySelectorAll(e),h=0,k=j.length,n=function(){clearInterval(l.interval)};for(;h<k;h++){f.observe(j[h],"change",n)}this._observed=true},_serialize:function(){var l=this.elementToChange||{},h=this.container.querySelectorAll(b),k=h.length,j=0;for(;j<k;j++){l[h[j].getAttribute(d)]=h[j].value}return l},_interpolate:function(n){var m,p,l,o=document.querySelector(":focus"),h=this.container.querySelectorAll(b),k=h.length,j=0;for(;j<k;j++){m=h[j];if(m===o){continue}if(n&&m.type==="hidden"){continue}p=m.getAttribute(d);l=(this.elementToChange&&typeof(this.elementToChange)!=="boolean")?(this.elementToChange.getAttribute(p)||""):m.defaultValue;m.value=l}},show:function(k){if(f.hasClass(this.link,a)){return}var i=this,h=this.container.querySelector(e);this.elementToChange=k;this._observe();this._interpolate();if(k){this.interval=setInterval(function(){i._interpolate(true)},500)}f.addClass(this.link,a);this.container.style.display="";this.fire("show");if(h&&!k){try{h.focus()}catch(j){}}},hide:function(){clearInterval(this.interval);this.elementToChange=null;f.removeClass(this.link,a);this.container.style.display="none";this.fire("hide")}})})(wysihtml5);(function(g){var f=g.dom;var e={position:"relative"};var d={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1};var b={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"};var a={"x-webkit-speech":"",speech:""};g.toolbar.Speech=function(j,k){var i=document.createElement("input");if(!g.browser.supportsSpeechApiOn(i)){k.style.display="none";return}var l=j.editor.textarea.element.getAttribute("lang");if(l){a.lang=l}var m=document.createElement("div");g.lang.object(d).merge({width:k.offsetWidth+"px",height:k.offsetHeight+"px"});f.insert(i).into(m);f.insert(m).into(k);f.setStyles(b).on(i);f.setAttributes(a).on(i);f.setStyles(d).on(m);f.setStyles(e).on(k);var h="onwebkitspeechchange" in i?"webkitspeechchange":"speechchange";f.observe(i,h,function(){j.execCommand("insertText",i.value);i.value=""});f.observe(i,"click",function(n){if(f.hasClass(k,"wysihtml5-command-disabled")){n.preventDefault()}n.stopPropagation()})}})(wysihtml5);(function(g){var a="wysihtml5-command-disabled",b="wysihtml5-commands-disabled",d="wysihtml5-command-active",e="wysihtml5-action-active",f=g.dom;g.toolbar.Toolbar=Base.extend({constructor:function(m,h,l){this.editor=m;this.container=typeof(h)==="string"?document.getElementById(h):h;this.composer=m.composer;this._getLinks("command");this._getLinks("action");this._observe();if(l){this.show()}if(m.config.classNameCommandDisabled!=null){a=m.config.classNameCommandDisabled}if(m.config.classNameCommandsDisabled!=null){b=m.config.classNameCommandsDisabled}if(m.config.classNameCommandActive!=null){d=m.config.classNameCommandActive}if(m.config.classNameActionActive!=null){e=m.config.classNameActionActive}var j=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),n=j.length,k=0;for(;k<n;k++){new g.toolbar.Speech(this,j[k])}},_getLinks:function(n){var r=this[n+"Links"]=g.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+n+"]")).get(),k=r.length,l=0,h=this[n+"Mapping"]={},o,q,j,p,m;for(;l<k;l++){o=r[l];j=o.getAttribute("data-wysihtml5-"+n);p=o.getAttribute("data-wysihtml5-"+n+"-value");q=this.container.querySelector("[data-wysihtml5-"+n+"-group='"+j+"']");m=this._getDialog(o,j);h[j+":"+p]={link:o,group:q,name:j,value:p,dialog:m,state:false}}},_getDialog:function(l,m){var k=this,j=this.container.querySelector("[data-wysihtml5-dialog='"+m+"']"),i,h;if(j){if(g.toolbar["Dialog_"+m]){i=new g.toolbar["Dialog_"+m](l,j)}else{i=new g.toolbar.Dialog(l,j)}i.on("show",function(){h=k.composer.selection.getBookmark();k.editor.fire("show:dialog",{command:m,dialogContainer:j,commandLink:l})});i.on("save",function(n){if(h){k.composer.selection.setBookmark(h)}k._execCommand(m,n);k.editor.fire("save:dialog",{command:m,dialogContainer:j,commandLink:l})});i.on("cancel",function(){k.editor.focus(false);k.editor.fire("cancel:dialog",{command:m,dialogContainer:j,commandLink:l})})}return i},execCommand:function(j,h){if(this.commandsDisabled){return}var i=this.commandMapping[j+":"+h];if(i&&i.dialog&&!i.state){i.dialog.show()}else{this._execCommand(j,h)}},_execCommand:function(i,h){this.editor.focus(false);this.composer.commands.exec(i,h);this._updateLinkStates()},execAction:function(i){var h=this.editor;if(i==="change_view"){if(h.textarea){if(h.currentView===h.textarea){h.fire("change_view","composer")}else{h.fire("change_view","textarea")}}}if(i=="showSource"){h.fire("showSource")}},_observe:function(){var n=this,l=this.editor,h=this.container,j=this.commandLinks.concat(this.actionLinks),m=j.length,k=0;for(;k<m;k++){if(j[k].nodeName==="A"){f.setAttributes({href:"javascript:;",unselectable:"on"}).on(j[k])}else{f.setAttributes({unselectable:"on"}).on(j[k])}}f.delegate(h,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(i){i.preventDefault()});f.delegate(h,"[data-wysihtml5-command]","click",function(p){var o=this,q=o.getAttribute("data-wysihtml5-command"),i=o.getAttribute("data-wysihtml5-command-value");n.execCommand(q,i);p.preventDefault()});f.delegate(h,"[data-wysihtml5-action]","click",function(i){var o=this.getAttribute("data-wysihtml5-action");n.execAction(o);i.preventDefault()});l.on("interaction:composer",function(){n._updateLinkStates()});l.on("focus:composer",function(){n.bookmark=null});if(this.editor.config.handleTables){l.on("tableselect:composer",function(){n.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""});l.on("tableunselect:composer",function(){n.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})}l.on("change_view",function(i){if(l.textarea){setTimeout(function(){n.commandsDisabled=(i!=="composer");n._updateLinkStates();if(n.commandsDisabled){f.addClass(h,b)}else{f.removeClass(h,b)}},0)}})},_updateLinkStates:function(){var j=this.commandMapping,m=this.actionMapping,h,l,k,n;for(h in j){n=j[h];if(this.commandsDisabled){l=false;f.removeClass(n.link,d);if(n.group){f.removeClass(n.group,d)}if(n.dialog){n.dialog.hide()}}else{l=this.composer.commands.state(n.name,n.value);f.removeClass(n.link,a);if(n.group){f.removeClass(n.group,a)}}if(n.state===l){continue}n.state=l;if(l){f.addClass(n.link,d);if(n.group){f.addClass(n.group,d)}if(n.dialog){if(typeof(l)==="object"||g.lang.object(l).isArray()){if(!n.dialog.multiselect&&g.lang.object(l).isArray()){l=l.length===1?l[0]:true;n.state=l}n.dialog.show(l)}else{n.dialog.hide()}}}else{f.removeClass(n.link,d);if(n.group){f.removeClass(n.group,d)}if(n.dialog){n.dialog.hide()}}}for(h in m){k=m[h];if(k.name==="change_view"){k.state=this.editor.currentView===this.editor.textarea;if(k.state){f.addClass(k.link,e)}else{f.removeClass(k.link,e)}}}},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})})(wysihtml5);(function(a){a.toolbar.Dialog_createTable=a.toolbar.Dialog.extend({show:function(b){this.base(b)}})})(wysihtml5);(function(e){var d=e.dom,a="[data-wysihtml5-dialog-field]",b="data-wysihtml5-dialog-field";e.toolbar.Dialog_foreColorStyle=e.toolbar.Dialog.extend({multiselect:true,_serialize:function(){var j={},f=this.container.querySelectorAll(a),h=f.length,g=0;for(;g<h;g++){j[f[g].getAttribute(b)]=f[g].value}return j},_interpolate:function(h){var o,q,f,n=document.querySelector(":focus"),l=this.container.querySelectorAll(a),g=l.length,k=0,m=(this.elementToChange)?((e.lang.object(this.elementToChange).isArray())?this.elementToChange[0]:this.elementToChange):null,p=(m)?m.getAttribute("style"):null,j=(p)?e.quirks.styleParser.parseColor(p,"color"):null;for(;k<g;k++){o=l[k];if(o===n){continue}if(h&&o.type==="hidden"){continue}if(o.getAttribute(b)==="color"){if(j){if(j[3]&&j[3]!=1){o.value="rgba("+j[0]+","+j[1]+","+j[2]+","+j[3]+");"}else{o.value="rgb("+j[0]+","+j[1]+","+j[2]+");"}}else{o.value="rgb(0,0,0);"}}}}})})(wysihtml5);(function(e){var d=e.dom,a="[data-wysihtml5-dialog-field]",b="data-wysihtml5-dialog-field";e.toolbar.Dialog_fontSizeStyle=e.toolbar.Dialog.extend({multiselect:true,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(j){var k=document.querySelector(":focus"),h=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),g=(this.elementToChange)?((e.lang.object(this.elementToChange).isArray())?this.elementToChange[0]:this.elementToChange):null,i=(g)?g.getAttribute("style"):null,f=(i)?e.quirks.styleParser.parseFontSize(i):null;if(h&&h!==k&&f&&!(/^\s*$/).test(f)){h.value=f}}})})(wysihtml5);
/*!

 handlebars v1.3.0

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/
var Handlebars=function(){var h=function(){function e(b){this.string=b}var d;return e.prototype.toString=function(){return""+this.string},d=e}(),g=function(z){function y(b){return s[b]||"&amp;"}function x(e,d){for(var f in d){Object.prototype.hasOwnProperty.call(d,f)&&(e[f]=d[f])}}function w(b){return b instanceof t?b.toString():b||0===b?(b=""+b,q.test(b)?b.replace(r,y):b):""}function v(b){return b||0===b?n(b)&&0===b.length?!0:!1:!0}var u={},t=z,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=/[&<>"'`]/g,q=/[&<>"'`]/;u.extend=x;var p=Object.prototype.toString;u.toString=p;var o=function(b){return"function"==typeof b};o(/x/)&&(o=function(b){return"function"==typeof b&&"[object Function]"===p.call(b)});var o;u.isFunction=o;var n=Array.isArray||function(b){return b&&"object"==typeof b?"[object Array]"===p.call(b):!1};return u.isArray=n,u.escapeExpression=w,u.isEmpty=v,u}(h),l=function(){function e(n,m){var q;m&&m.firstLine&&(q=m.firstLine,n+=" - "+q+":"+m.firstColumn);for(var p=Error.prototype.constructor.call(this,n),o=0;o<f.length;o++){this[f[o]]=p[f[o]]}q&&(this.lineNumber=q,this.column=m.firstColumn)}var d,f=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,d=e}(),k=function(H,G){function F(e,d){this.helpers=e||{},this.partials=d||{},E(this)}function E(b){b.registerHelper("helperMissing",function(d){if(2===arguments.length){return void 0}throw new A("Missing helper: '"+d+"'")}),b.registerHelper("blockHelperMissing",function(a,n){var m=n.inverse||function(){},f=n.fn;return v(a)&&(a=a.call(this)),a===!0?f(this):a===!1||null==a?m(this):w(a)?a.length>0?b.helpers.each(a,n):m(this):f(a)}),b.registerHelper("each",function(L,K){var J,I=K.fn,q=K.inverse,p=0,o="";if(v(L)&&(L=L.call(this)),K.data&&(J=r(K.data)),L&&"object"==typeof L){if(w(L)){for(var n=L.length;n>p;p++){J&&(J.index=p,J.first=0===p,J.last=p===L.length-1),o+=I(L[p],{data:J})}}else{for(var m in L){L.hasOwnProperty(m)&&(J&&(J.key=m,J.index=p,J.first=0===p),o+=I(L[m],{data:J}),p++)}}}return 0===p&&(o=q(this)),o}),b.registerHelper("if",function(e,d){return v(e)&&(e=e.call(this)),!d.hash.includeZero&&!e||B.isEmpty(e)?d.inverse(this):d.fn(this)}),b.registerHelper("unless",function(a,d){return b.helpers["if"].call(this,a,{fn:d.inverse,inverse:d.fn,hash:d.hash})}),b.registerHelper("with",function(e,d){return v(e)&&(e=e.call(this)),B.isEmpty(e)?void 0:d.fn(e)}),b.registerHelper("log",function(a,f){var e=f.data&&null!=f.data.level?parseInt(f.data.level,10):1;b.log(e,a)})}function D(e,d){s.log(e,d)}var C={},B=H,A=G,z="1.3.0";C.VERSION=z;var y=4;C.COMPILER_REVISION=y;var x={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};C.REVISION_CHANGES=x;var w=B.isArray,v=B.isFunction,u=B.toString,t="[object Object]";C.HandlebarsEnvironment=F,F.prototype={constructor:F,logger:s,log:D,registerHelper:function(e,d,f){if(u.call(e)===t){if(f||d){throw new A("Arg not supported with multiple helpers")}B.extend(this.helpers,e)}else{f&&(d.not=f),this.helpers[e]=d}},registerPartial:function(e,d){u.call(e)===t?B.extend(this.partials,e):this.partials[e]=d}};var s={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,d){if(s.level<=e){var f=s.methodMap[e];"undefined"!=typeof console&&console[f]&&console[f].call(console,d)}}};C.logger=s,C.log=D;var r=function(e){var d={};return B.extend(d,e),d};return C.createFrame=r,C}(g,l),j=function(B,A,z){function y(m){var f=m&&m[0]||1,D=p;if(f!==D){if(D>f){var C=o[D],n=o[f];throw new q("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+C+") or downgrade your runtime to an older version ("+n+").")}throw new q("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+m[1]+").")}}function x(f,e){if(!e){throw new q("No environment passed to template")}var n=function(b,I,H,G,F,E){var D=e.VM.invokePartial.apply(this,arguments);if(null!=D){return D}if(e.compile){var C={helpers:G,partials:F,data:E};return F[I]=e.compile(b,{data:void 0!==E},e),F[I](H,C)}throw new q("The partial "+I+" could not be compiled when running in runtime-only mode")},m={escapeExpression:r.escapeExpression,invokePartial:n,programs:[],program:function(D,C,F){var E=this.programs[D];return F?E=v(D,C,F):E||(E=this.programs[D]=v(D,C)),E},merge:function(C,d){var D=C||d;return C&&d&&C!==d&&(D={},r.extend(D,d),r.extend(D,C)),D},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(E,D){D=D||{};var C,d,b=D.partial?D:e;D.partial||(C=D.helpers,d=D.partials);var a=f.call(m,b,E,C,d,D.data);return D.partial||e.VM.checkRevision(m.compilerInfo),a}}function w(m,f,D){var C=Array.prototype.slice.call(arguments,3),n=function(b,d){return d=d||{},f.apply(this,[b,d.data||D].concat(C))};return n.program=m,n.depth=C.length,n}function v(f,e,n){var m=function(b,C){return C=C||{},e(b,C.data||n)};return m.program=f,m.depth=0,m}function u(n,m,G,F,E,D){var C={partial:!0,helpers:F,partials:E,data:D};if(void 0===n){throw new q("The partial "+m+" could not be found")}return n instanceof Function?n(G,C):void 0}function t(){return""}var s={},r=B,q=A,p=z.COMPILER_REVISION,o=z.REVISION_CHANGES;return s.checkRevision=y,s.template=x,s.programWithDepth=w,s.program=v,s.invokePartial=u,s.noop=t,s}(g,l,k),i=function(z,y,x,w,v){var u,t=z,s=y,r=x,q=w,p=v,o=function(){var b=new t.HandlebarsEnvironment;return q.extend(b,t),b.SafeString=s,b.Exception=r,b.Utils=q,b.VM=p,b.template=function(a){return p.template(a,b)},b},n=o();return n.create=o,u=n}(k,h,l,g,j);return i}();this["wysihtml5"]=this["wysihtml5"]||{};this["wysihtml5"]["tpl"]=this["wysihtml5"]["tpl"]||{};this["wysihtml5"]["tpl"]["blockquote"]=Handlebars.template(function(f,l,e,k,j){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,f.helpers);j=j||{};var h="",b,g="function",i=this.escapeExpression,n=this;function d(r,q){var o="",p;o+="btn-"+i(((p=((p=((p=(r&&r.options)),p==null||p===false?p:p.toolbar)),p==null||p===false?p:p.size)),typeof p===g?p.apply(r):p));return o}function a(p,o){return' \n      <span class="fa fa-quote-left"></span>\n    '}function m(p,o){return'\n      <span class="glyphicon glyphicon-quote"></span>\n    '}h+='<li>\n  <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:n.noop,fn:n.program(1,d,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n    ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.fa),{hash:{},inverse:n.program(5,m,j),fn:n.program(3,a,j),data:j});if(b||b===0){h+=b}h+="\n  </a>\n</li>\n";return h});this["wysihtml5"]["tpl"]["color"]=Handlebars.template(function(e,k,d,j,i){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,e.helpers);i=i||{};var g="",a,f="function",h=this.escapeExpression,l=this;function b(p,o){var m="",n;m+="btn-"+h(((n=((n=((n=(p&&p.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.size)),typeof n===f?n.apply(p):n));return m}g+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ';a=d["if"].call(k,((a=((a=(k&&k.options)),a==null||a===false?a:a.toolbar)),a==null||a===false?a:a.size),{hash:{},inverse:l.noop,fn:l.program(1,b,i),data:i});if(a||a===0){g+=a}g+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.black)),typeof a===f?a.apply(k):a))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.black)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.silver)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.gray)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.maroon)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.red)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.purple)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.green)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.olive)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.navy)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.blue)),typeof a===f?a.apply(k):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+h(((a=((a=((a=(k&&k.locale)),a==null||a===false?a:a.colours)),a==null||a===false?a:a.orange)),typeof a===f?a.apply(k):a))+"</a></li>\n  </ul>\n</li>\n";return g});this["wysihtml5"]["tpl"]["emphasis"]=Handlebars.template(function(f,l,e,k,j){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,f.helpers);j=j||{};var h="",b,g="function",i=this.escapeExpression,m=this;function d(q,p){var n="",o;n+="btn-"+i(((o=((o=((o=(q&&q.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.size)),typeof o===g?o.apply(q):o));return n}function a(q,p){var n="",o;n+='\n    <a class="btn ';o=e["if"].call(q,((o=((o=(q&&q.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.size),{hash:{},inverse:m.noop,fn:m.program(1,d,p),data:p});if(o||o===0){n+=o}n+=' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+i(((o=((o=((o=(q&&q.locale)),o==null||o===false?o:o.emphasis)),o==null||o===false?o:o.small)),typeof o===g?o.apply(q):o))+"</a>\n    ";return n}h+='<li>\n  <div class="btn-group">\n    <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:m.noop,fn:m.program(1,d,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.emphasis)),b==null||b===false?b:b.bold)),typeof b===g?b.apply(l):b))+'</a>\n    <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:m.noop,fn:m.program(1,d,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.emphasis)),b==null||b===false?b:b.italic)),typeof b===g?b.apply(l):b))+'</a>\n    <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:m.noop,fn:m.program(1,d,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.emphasis)),b==null||b===false?b:b.underline)),typeof b===g?b.apply(l):b))+"</a>\n    ";b=e["if"].call(l,((b=((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.emphasis)),b==null||b===false?b:b.small),{hash:{},inverse:m.noop,fn:m.program(3,a,j),data:j});if(b||b===0){h+=b}h+="\n  </div>\n</li>\n";return h});this["wysihtml5"]["tpl"]["font-styles"]=Handlebars.template(function(f,l,e,k,j){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,f.helpers);j=j||{};var h="",b,g="function",i=this.escapeExpression,n=this;function d(r,q){var o="",p;o+="btn-"+i(((p=((p=((p=(r&&r.options)),p==null||p===false?p:p.toolbar)),p==null||p===false?p:p.size)),typeof p===g?p.apply(r):p));return o}function a(p,o){return'\n      <span class="fa fa-font"></span>\n    '}function m(p,o){return'\n      <span class="glyphicon glyphicon-font"></span>\n    '}h+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:n.noop,fn:n.program(1,d,j),data:j});if(b||b===0){h+=b}h+='" data-toggle="dropdown">\n    ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.fa),{hash:{},inverse:n.program(5,m,j),fn:n.program(3,a,j),data:j});if(b||b===0){h+=b}h+='\n    <span class="current-font">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.normal)),typeof b===g?b.apply(l):b))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.normal)),typeof b===g?b.apply(l):b))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.h1)),typeof b===g?b.apply(l):b))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.h2)),typeof b===g?b.apply(l):b))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.h3)),typeof b===g?b.apply(l):b))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.h4)),typeof b===g?b.apply(l):b))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.h5)),typeof b===g?b.apply(l):b))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.font_styles)),b==null||b===false?b:b.h6)),typeof b===g?b.apply(l):b))+"</a></li>\n  </ul>\n</li>\n";return h});this["wysihtml5"]["tpl"]["html"]=Handlebars.template(function(f,l,e,k,j){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,f.helpers);j=j||{};var h="",b,g="function",i=this.escapeExpression,n=this;function d(r,q){var o="",p;o+="btn-"+i(((p=((p=((p=(r&&r.options)),p==null||p===false?p:p.toolbar)),p==null||p===false?p:p.size)),typeof p===g?p.apply(r):p));return o}function a(p,o){return'\n        <span class="fa fa-pencil"></span>\n      '}function m(p,o){return'\n        <span class="glyphicon glyphicon-pencil"></span>\n      '}h+='<li>\n  <div class="btn-group">\n    <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:n.noop,fn:n.program(1,d,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-action="change_view" title="'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.html)),b==null||b===false?b:b.edit)),typeof b===g?b.apply(l):b))+'" tabindex="-1">\n      ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.fa),{hash:{},inverse:n.program(5,m,j),fn:n.program(3,a,j),data:j});if(b||b===0){h+=b}h+="\n    </a>\n  </div>\n</li>\n";return h});this["wysihtml5"]["tpl"]["image"]=Handlebars.template(function(f,l,e,k,j){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,f.helpers);j=j||{};var h="",b,g="function",i=this.escapeExpression,o=this;function d(q,p){return"modal-sm"}function a(s,r){var p="",q;p+="btn-"+i(((q=((q=((q=(s&&s.options)),q==null||q===false?q:q.toolbar)),q==null||q===false?q:q.size)),typeof q===g?q.apply(s):q));return p}function n(q,p){return'\n      <span class="fa fa-file-image-o"></span>\n    '}function m(q,p){return'\n      <span class="glyphicon glyphicon-picture"></span>\n    '}h+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.smallmodals),{hash:{},inverse:o.noop,fn:o.program(1,d,j),data:j});if(b||b===0){h+=b}h+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.image)),b==null||b===false?b:b.insert)),typeof b===g?b.apply(l):b))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.image)),b==null||b===false?b:b.cancel)),typeof b===g?b.apply(l):b))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.image)),b==null||b===false?b:b.insert)),typeof b===g?b.apply(l):b))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:o.noop,fn:o.program(3,a,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-command="insertImage" title="'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.image)),b==null||b===false?b:b.insert)),typeof b===g?b.apply(l):b))+'" tabindex="-1">\n    ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.fa),{hash:{},inverse:o.program(7,m,j),fn:o.program(5,n,j),data:j});if(b||b===0){h+=b}h+="\n  </a>\n</li>\n";return h});this["wysihtml5"]["tpl"]["link"]=Handlebars.template(function(f,l,e,k,j){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,f.helpers);j=j||{};var h="",b,g="function",i=this.escapeExpression,o=this;function d(q,p){return"modal-sm"}function a(s,r){var p="",q;p+="btn-"+i(((q=((q=((q=(s&&s.options)),q==null||q===false?q:q.toolbar)),q==null||q===false?q:q.size)),typeof q===g?q.apply(s):q));return p}function n(q,p){return'\n      <span class="fa fa-share-square-o"></span>\n    '}function m(q,p){return'\n      <span class="glyphicon glyphicon-share"></span>\n    '}h+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.smallmodals),{hash:{},inverse:o.noop,fn:o.program(1,d,j),data:j});if(b||b===0){h+=b}h+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.link)),b==null||b===false?b:b.insert)),typeof b===g?b.apply(l):b))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.link)),b==null||b===false?b:b.target)),typeof b===g?b.apply(l):b))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.link)),b==null||b===false?b:b.cancel)),typeof b===g?b.apply(l):b))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.link)),b==null||b===false?b:b.insert)),typeof b===g?b.apply(l):b))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.size),{hash:{},inverse:o.noop,fn:o.program(3,a,j),data:j});if(b||b===0){h+=b}h+=' btn-default" data-wysihtml5-command="createLink" title="'+i(((b=((b=((b=(l&&l.locale)),b==null||b===false?b:b.link)),b==null||b===false?b:b.insert)),typeof b===g?b.apply(l):b))+'" tabindex="-1">\n    ';b=e["if"].call(l,((b=((b=(l&&l.options)),b==null||b===false?b:b.toolbar)),b==null||b===false?b:b.fa),{hash:{},inverse:o.program(7,m,j),fn:o.program(5,n,j),data:j});if(b||b===0){h+=b}h+="\n  </a>\n</li>\n";return h});this["wysihtml5"]["tpl"]["lists"]=Handlebars.template(function(e,o,m,i,t){this.compilerInfo=[4,">= 1.0.0"];m=this.merge(m,e.helpers);t=t||{};var n="",f,b="function",a=this.escapeExpression,l=this;function k(x,w){var u="",v;u+="btn-"+a(((v=((v=((v=(x&&x.options)),v==null||v===false?v:v.toolbar)),v==null||v===false?v:v.size)),typeof v===b?v.apply(x):v));return u}function j(v,u){return'\n      <span class="fa fa-list-ul"></span>\n    '}function h(v,u){return'\n      <span class="glyphicon glyphicon-list"></span>\n    '}function g(v,u){return'\n      <span class="fa fa-list-ol"></span>\n    '}function d(v,u){return'\n      <span class="glyphicon glyphicon-th-list"></span>\n    '}function s(v,u){return'\n      <span class="fa fa-outdent"></span>\n    '}function r(v,u){return'\n      <span class="glyphicon glyphicon-indent-right"></span>\n    '}function q(v,u){return'\n      <span class="fa fa-indent"></span>\n    '}function p(v,u){return'\n      <span class="glyphicon glyphicon-indent-left"></span>\n    '}n+='<li>\n  <div class="btn-group">\n    <a class="btn ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.size),{hash:{},inverse:l.noop,fn:l.program(1,k,t),data:t});if(f||f===0){n+=f}n+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+a(((f=((f=((f=(o&&o.locale)),f==null||f===false?f:f.lists)),f==null||f===false?f:f.unordered)),typeof f===b?f.apply(o):f))+'" tabindex="-1">\n    ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.fa),{hash:{},inverse:l.program(5,h,t),fn:l.program(3,j,t),data:t});if(f||f===0){n+=f}n+='\n    </a>\n    <a class="btn ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.size),{hash:{},inverse:l.noop,fn:l.program(1,k,t),data:t});if(f||f===0){n+=f}n+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+a(((f=((f=((f=(o&&o.locale)),f==null||f===false?f:f.lists)),f==null||f===false?f:f.ordered)),typeof f===b?f.apply(o):f))+'" tabindex="-1">\n    ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.fa),{hash:{},inverse:l.program(9,d,t),fn:l.program(7,g,t),data:t});if(f||f===0){n+=f}n+='\n    </a>\n    <a class="btn ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.size),{hash:{},inverse:l.noop,fn:l.program(1,k,t),data:t});if(f||f===0){n+=f}n+=' btn-default" data-wysihtml5-command="Outdent" title="'+a(((f=((f=((f=(o&&o.locale)),f==null||f===false?f:f.lists)),f==null||f===false?f:f.outdent)),typeof f===b?f.apply(o):f))+'" tabindex="-1">\n    ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.fa),{hash:{},inverse:l.program(13,r,t),fn:l.program(11,s,t),data:t});if(f||f===0){n+=f}n+='\n    </a>\n    <a class="btn ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.size),{hash:{},inverse:l.noop,fn:l.program(1,k,t),data:t});if(f||f===0){n+=f}n+=' btn-default" data-wysihtml5-command="Indent" title="'+a(((f=((f=((f=(o&&o.locale)),f==null||f===false?f:f.lists)),f==null||f===false?f:f.indent)),typeof f===b?f.apply(o):f))+'" tabindex="-1">\n    ';f=m["if"].call(o,((f=((f=(o&&o.options)),f==null||f===false?f:f.toolbar)),f==null||f===false?f:f.fa),{hash:{},inverse:l.program(17,p,t),fn:l.program(15,q,t),data:t});if(f||f===0){n+=f}n+="\n    </a>\n  </div>\n</li>\n";return n});(function(a){if(typeof define==="function"&&define.amd){define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],a)}else{a(jQuery,wysihtml5)}}(function(b,d){var a=function(i,k){var h=function(n,l,m){if(k.tpl[n]){return k.tpl[n]({locale:l,options:m})}};var j=function(n,l){this.el=n;var o=i.extend(true,{},f,l);for(var m in o.customTemplates){if(o.customTemplates.hasOwnProperty(m)){k.tpl[m]=o.customTemplates[m]}}this.toolbar=this.createToolbar(n,o);this.editor=this.createEditor(o)};j.prototype={constructor:j,createEditor:function(l){l=l||{};l=i.extend(true,{},l);l.toolbar=this.toolbar[0];this.initializeEditor(this.el[0],l)},initializeEditor:function(o,m){var n=new k.Editor(this.el[0],m);n.on("beforeload",this.syncBootstrapDialogEvents);n.on("beforeload",this.loadParserRules);if(n.composer.editableArea.contentDocument){this.addMoreShortcuts(n,n.composer.editableArea.contentDocument.body||n.composer.editableArea.contentDocument,m.shortcuts)}else{this.addMoreShortcuts(n,n.composer.editableArea,m.shortcuts)}if(m&&m.events){for(var l in m.events){if(m.events.hasOwnProperty(l)){n.on(l,m.events[l])}}}return n},loadParserRules:function(){if(i.type(this.config.parserRules)==="string"){i.ajax({dataType:"json",url:this.config.parserRules,context:this,error:function(l,n,m){console.log(m)},success:function(l){this.config.parserRules=l;console.log("parserrules loaded")}})}if(this.config.pasteParserRulesets&&i.type(this.config.pasteParserRulesets)==="string"){i.ajax({dataType:"json",url:this.config.pasteParserRulesets,context:this,error:function(l,n,m){console.log(m)},success:function(l){this.config.pasteParserRulesets=l}})}},syncBootstrapDialogEvents:function(){var l=this;i.map(this.toolbar.commandMapping,function(m){return[m]}).filter(function(m){return m.dialog}).map(function(m){return m.dialog}).forEach(function(m){m.on("show",function(){i(this.container).modal("show")});m.on("hide",function(){i(this.container).modal("hide");setTimeout(l.composer.focus,0)});i(m.container).on("shown.bs.modal",function(){i(this).find("input, select, textarea").first().focus()})});this.on("change_view",function(){i(this.toolbar.container.children).find("a.btn").not('[data-wysihtml5-action="change_view"]').toggleClass("disabled")})},createToolbar:function(p,n){var m=this;var q=i("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"});var l=n.locale||f.locale||"en";if(!e.hasOwnProperty(l)){console.debug("Locale '"+l+"' not found. Available locales are: "+Object.keys(e)+". Falling back to 'en'.");l="en"}var r=i.extend(true,{},e.en,e[l]);for(var o in n.toolbar){if(n.toolbar[o]){q.append(h(o,r,n))}}q.find('a[data-wysihtml5-command="formatBlock"]').click(function(w){var v=w.delegateTarget||w.target||w.srcElement,s=i(v),t=s.data("wysihtml5-display-format-name"),u=s.data("wysihtml5-format-name")||s.html();if(t===undefined||t==="true"){m.toolbar.find(".current-font").text(u)}});q.find('a[data-wysihtml5-command="foreColor"]').click(function(u){var t=u.target||u.srcElement;var s=i(t);m.toolbar.find(".current-color").text(s.html())});this.el.before(q);return q},addMoreShortcuts:function(n,m,l){k.dom.observe(m,"keydown",function(p){var q=p.keyCode,r=l[q];if((p.ctrlKey||p.metaKey||p.altKey)&&r&&k.commands[r]){var o=n.toolbar.commandMapping[r+":null"];if(o&&o.dialog&&!o.state){o.dialog.show()}else{k.commands[r].exec(n.composer,r)}p.preventDefault()}})}};var g={resetDefaults:function(){i.fn.wysihtml5.defaultOptions=i.extend(true,{},i.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(l){return this.each(function(){var m=i(this);m.data("wysihtml5",new j(m,l))})},shallowExtend:function(l){var m=i.extend({},i.fn.wysihtml5.defaultOptions,l||{},i(this).data());var n=this;return g.bypassDefaults.apply(n,[m])},deepExtend:function(l){var m=i.extend(true,{},i.fn.wysihtml5.defaultOptions,l||{});var n=this;return g.bypassDefaults.apply(n,[m])},init:function(l){var m=this;return g.shallowExtend.apply(m,[l])}};i.fn.wysihtml5=function(l){if(g[l]){return g[l].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof l==="object"||!l){return g.init.apply(this,arguments)}else{i.error("Method "+l+" does not exist on jQuery.wysihtml5")}}};i.fn.wysihtml5.Constructor=j;var f=i.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":true,color:false,emphasis:{small:true},blockquote:true,lists:true,html:false,link:true,image:true,smallmodals:false},useLineBreaks:false,parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{"83":"small","75":"createLink"}};if(typeof i.fn.wysihtml5.defaultOptionsCache==="undefined"){i.fn.wysihtml5.defaultOptionsCache=i.extend(true,{},i.fn.wysihtml5.defaultOptions)}var e=i.fn.wysihtml5.locale={}};a(b,d)}));(function(a){a.commands.small={exec:function(b,d){return a.commands.formatInline.exec(b,d,"small")},state:function(b,d){return a.commands.formatInline.state(b,d,"small")}}})(wysihtml5);(function(a){if(typeof define==="function"&&define.amd){define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],a)}else{a(jQuery)}}(function(a){a.fn.wysihtml5.locale.en=a.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}));