/*! ColReorder 1.1.3
 * Â©2010-2014 SpryMedia Ltd - datatables.net/license
 */
(function(e,a,g){function f(l){var k=[];for(var j=0,h=l.length;j<h;j++){k[l[j]]=j}return k}function d(i,k,j){var h=i.splice(k,1)[0];i.splice(j,0,h)}function b(l,o,n){var k=[];for(var j=0,h=l.childNodes.length;j<h;j++){if(l.childNodes[j].nodeType==1){k.push(l.childNodes[j])}}var m=k[o];if(n!==null){l.insertBefore(m,k[n])}else{l.appendChild(m)}}var c=function(j,i){j.fn.dataTableExt.oApi.fnColReorder=function(n,w,o){var p=j.fn.dataTable.Api?true:false;var x,u,v,A,q=n.aoColumns.length,m,k;var y=function(F,G,E){if(!F[G]){return}var C=F[G].split(".");var D=C.shift();if(isNaN(D*1)){return}F[G]=E[D*1]+"."+C.join(".")};if(w==o){return}if(w<0||w>=q){this.oApi._fnLog(n,1,"ColReorder 'from' index is out of bounds: "+w);return}if(o<0||o>=q){this.oApi._fnLog(n,1,"ColReorder 'to' index is out of bounds: "+o);return}var s=[];for(x=0,u=q;x<u;x++){s[x]=x}d(s,w,o);var z=f(s);for(x=0,u=n.aaSorting.length;x<u;x++){n.aaSorting[x][0]=z[n.aaSorting[x][0]]}if(n.aaSortingFixed!==null){for(x=0,u=n.aaSortingFixed.length;x<u;x++){n.aaSortingFixed[x][0]=z[n.aaSortingFixed[x][0]]}}for(x=0,u=q;x<u;x++){k=n.aoColumns[x];for(v=0,A=k.aDataSort.length;v<A;v++){k.aDataSort[v]=z[k.aDataSort[v]]}if(p){k.idx=z[k.idx]}}if(p){j.each(n.aLastSort,function(C,D){n.aLastSort[C].src=z[D.src]})}for(x=0,u=q;x<u;x++){k=n.aoColumns[x];if(typeof k.mData=="number"){k.mData=z[k.mData];n.oApi._fnColumnOptions(n,x,{})}else{if(j.isPlainObject(k.mData)){y(k.mData,"_",z);y(k.mData,"filter",z);y(k.mData,"sort",z);y(k.mData,"type",z);n.oApi._fnColumnOptions(n,x,{})}}}if(n.aoColumns[w].bVisible){var t=this.oApi._fnColumnIndexToVisible(n,w);var l=null;x=o<w?o:o+1;while(l===null&&x<q){l=this.oApi._fnColumnIndexToVisible(n,x);x++}m=n.nTHead.getElementsByTagName("tr");for(x=0,u=m.length;x<u;x++){b(m[x],t,l)}if(n.nTFoot!==null){m=n.nTFoot.getElementsByTagName("tr");for(x=0,u=m.length;x<u;x++){b(m[x],t,l)}}for(x=0,u=n.aoData.length;x<u;x++){if(n.aoData[x].nTr!==null){b(n.aoData[x].nTr,t,l)}}}d(n.aoColumns,w,o);d(n.aoPreSearchCols,w,o);for(x=0,u=n.aoData.length;x<u;x++){var B=n.aoData[x];if(p){if(B.anCells){d(B.anCells,w,o)}if(B.src!=="dom"&&j.isArray(B._aData)){d(B._aData,w,o)}}else{if(j.isArray(B._aData)){d(B._aData,w,o)}d(B._anHidden,w,o)}}for(x=0,u=n.aoHeader.length;x<u;x++){d(n.aoHeader[x],w,o)}if(n.aoFooter!==null){for(x=0,u=n.aoFooter.length;x<u;x++){d(n.aoFooter[x],w,o)}}if(p){var r=new j.fn.dataTable.Api(n);r.rows().invalidate()}for(x=0,u=q;x<u;x++){j(n.aoColumns[x].nTh).off("click.DT");this.oApi._fnSortAttachListener(n,n.aoColumns[x].nTh,x)}j(n.oInstance).trigger("column-reorder",[n,{iFrom:w,iTo:o,aiInvertMapping:z}])};var h=function(m,l){var n;if(j.fn.dataTable.Api){n=new j.fn.dataTable.Api(m).settings()[0]}else{if(m.fnSettings){n=m.fnSettings()}else{if(typeof m==="string"){if(j.fn.dataTable.fnIsDataTable(j(m)[0])){n=j(m).eq(0).dataTable().fnSettings()}}else{if(m.nodeName&&m.nodeName.toLowerCase()==="table"){if(j.fn.dataTable.fnIsDataTable(m.nodeName)){n=j(m.nodeName).dataTable().fnSettings()}}else{if(m instanceof jQuery){if(j.fn.dataTable.fnIsDataTable(m[0])){n=m.eq(0).dataTable().fnSettings()}}else{n=m}}}}}if(n._colReorder){throw"ColReorder already initialised on table #"+n.nTable.id}var k=j.fn.dataTable.camelToHungarian;if(k){k(h.defaults,h.defaults,true);k(h.defaults,l||{})}this.s={dt:null,init:j.extend(true,{},h.defaults,l),fixed:0,fixedRight:0,reorderCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]};this.dom={drag:null,pointer:null};this.s.dt=n;this.s.dt._colReorder=this;this._fnConstruct();n.oApi._fnCallbackReg(n,"aoDestroyCallback",j.proxy(this._fnDestroy,this),"ColReorder");return this};h.prototype={fnReset:function(){var l=[];for(var m=0,k=this.s.dt.aoColumns.length;m<k;m++){l.push(this.s.dt.aoColumns[m]._ColReorder_iOrigCol)}this._fnOrderColumns(l);return this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(n){if(n===g){var l=[];for(var m=0,k=this.s.dt.aoColumns.length;m<k;m++){l.push(this.s.dt.aoColumns[m]._ColReorder_iOrigCol)}return l}this._fnOrderColumns(f(n));return this},_fnConstruct:function(){var p=this;var k=this.s.dt.aoColumns.length;var o;if(this.s.init.iFixedColumns){this.s.fixed=this.s.init.iFixedColumns}this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0;if(this.s.init.fnReorderCallback){this.s.reorderCallback=this.s.init.fnReorderCallback}for(o=0;o<k;o++){if(o>this.s.fixed-1&&o<k-this.s.fixedRight){this._fnMouseListener(o,this.s.dt.aoColumns[o].nTh)}this.s.dt.aoColumns[o]._ColReorder_iOrigCol=o}this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(q,r){p._fnStateSave.call(p,r)},"ColReorder_State");var l=null;if(this.s.init.aiOrder){l=this.s.init.aiOrder.slice()}if(this.s.dt.oLoadedState&&typeof this.s.dt.oLoadedState.ColReorder!="undefined"&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length){l=this.s.dt.oLoadedState.ColReorder}if(l){if(!p.s.dt._bInitComplete){var n=false;this.s.dt.aoDrawCallback.push({fn:function(){if(!p.s.dt._bInitComplete&&!n){n=true;var q=f(l);p._fnOrderColumns.call(p,q)}},sName:"ColReorder_Pre"})}else{var m=f(l);p._fnOrderColumns.call(p,m)}}else{this._fnSetColumnIndexes()}},_fnOrderColumns:function(l){if(l.length!=this.s.dt.aoColumns.length){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not match known number of columns. Skipping.");return}for(var m=0,k=l.length;m<k;m++){var n=j.inArray(m,l);if(m!=n){d(l,n,m);this.s.dt.oInstance.fnColReorder(n,m)}}if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);this._fnSetColumnIndexes();if(this.s.reorderCallback!==null){this.s.reorderCallback.call(this)}},_fnStateSave:function(q){var n,l,s,p;var k=this.s.dt;var m=k.aoColumns;q.ColReorder=[];if(q.aaSorting){for(n=0;n<q.aaSorting.length;n++){q.aaSorting[n][0]=m[q.aaSorting[n][0]]._ColReorder_iOrigCol}var o=j.extend(true,[],q.aoSearchCols);for(n=0,l=m.length;n<l;n++){p=m[n]._ColReorder_iOrigCol;q.aoSearchCols[p]=o[n];q.abVisCols[p]=m[n].bVisible;q.ColReorder.push(p)}}else{if(q.order){for(n=0;n<q.order.length;n++){q.order[n][0]=m[q.order[n][0]]._ColReorder_iOrigCol}var r=j.extend(true,[],q.columns);for(n=0,l=m.length;n<l;n++){p=m[n]._ColReorder_iOrigCol;q.columns[p]=r[n];q.ColReorder.push(p)}}}},_fnMouseListener:function(k,m){var l=this;j(m).on("mousedown.ColReorder",function(n){n.preventDefault();l._fnMouseDown.call(l,n,m)})},_fnMouseDown:function(o,n){var l=this;var m=j(o.target).closest("th, td");var p=m.offset();var k=parseInt(j(n).attr("data-column-index"),10);if(k===g){return}this.s.mouse.startX=o.pageX;this.s.mouse.startY=o.pageY;this.s.mouse.offsetX=o.pageX-p.left;this.s.mouse.offsetY=o.pageY-p.top;this.s.mouse.target=this.s.dt.aoColumns[k].nTh;this.s.mouse.targetIndex=k;this.s.mouse.fromIndex=k;this._fnRegions();j(a).on("mousemove.ColReorder",function(q){l._fnMouseMove.call(l,q)}).on("mouseup.ColReorder",function(q){l._fnMouseUp.call(l,q)})},_fnMouseMove:function(o){var n=this;if(this.dom.drag===null){if(Math.pow(Math.pow(o.pageX-this.s.mouse.startX,2)+Math.pow(o.pageY-this.s.mouse.startY,2),0.5)<5){return}this._fnCreateDragNode()}this.dom.drag.css({left:o.pageX-this.s.mouse.offsetX,top:o.pageY-this.s.mouse.offsetY});var p=false;var l=this.s.mouse.toIndex;for(var m=1,k=this.s.aoTargets.length;m<k;m++){if(o.pageX<this.s.aoTargets[m-1].x+((this.s.aoTargets[m].x-this.s.aoTargets[m-1].x)/2)){this.dom.pointer.css("left",this.s.aoTargets[m-1].x);this.s.mouse.toIndex=this.s.aoTargets[m-1].to;p=true;break}}if(!p){this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x);this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to}if(this.s.init.bRealtime&&l!==this.s.mouse.toIndex){this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this.s.mouse.fromIndex=this.s.mouse.toIndex;this._fnRegions()}},_fnMouseUp:function(l){var k=this;j(a).off("mousemove.ColReorder mouseup.ColReorder");if(this.dom.drag!==null){this.dom.drag.remove();this.dom.pointer.remove();this.dom.drag=null;this.dom.pointer=null;this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this._fnSetColumnIndexes();if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);if(this.s.reorderCallback!==null){this.s.reorderCallback.call(this)}}},_fnRegions:function(){var l=this.s.dt.aoColumns;this.s.aoTargets.splice(0,this.s.aoTargets.length);this.s.aoTargets.push({x:j(this.s.dt.nTable).offset().left,to:0});var n=0;for(var m=0,k=l.length;m<k;m++){if(m!=this.s.mouse.fromIndex){n++}if(l[m].bVisible){this.s.aoTargets.push({x:j(l[m].nTh).offset().left+j(l[m].nTh).outerWidth(),to:n})}}if(this.s.fixedRight!==0){this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight)}if(this.s.fixed!==0){this.s.aoTargets.splice(0,this.s.fixed)}},_fnCreateDragNode:function(){var p=this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="";var m=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh;var l=m.parentNode;var n=l.parentNode;var k=n.parentNode;var o=j(m).clone();this.dom.drag=j(k.cloneNode(false)).addClass("DTCR_clonedTable").append(j(n.cloneNode(false)).append(j(l.cloneNode(false)).append(o[0]))).css({position:"absolute",top:0,left:0,width:j(m).outerWidth(),height:j(m).outerHeight()}).appendTo("body");this.dom.pointer=j("<div></div>").addClass("DTCR_pointer").css({position:"absolute",top:p?j("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:j(this.s.dt.nTable).offset().top,height:p?j("div.dataTables_scroll",this.s.dt.nTableWrapper).height():j(this.s.dt.nTable).height()}).appendTo("body")},_fnDestroy:function(){var l,k;for(l=0,k=this.s.dt.aoDrawCallback.length;l<k;l++){if(this.s.dt.aoDrawCallback[l].sName==="ColReorder_Pre"){this.s.dt.aoDrawCallback.splice(l,1);break}}j(this.s.dt.nTHead).find("*").off(".ColReorder");j.each(this.s.dt.aoColumns,function(m,n){j(n.nTh).removeAttr("data-column-index")});this.s.dt._colReorder=null;this.s=null},_fnSetColumnIndexes:function(){j.each(this.s.dt.aoColumns,function(k,l){j(l.nTh).attr("data-column-index",k)})}};h.defaults={aiOrder:null,bRealtime:false,iFixedColumns:0,iFixedColumnsRight:0,fnReorderCallback:null};h.version="1.1.3";j.fn.dataTable.ColReorder=h;j.fn.DataTable.ColReorder=h;if(typeof j.fn.dataTable=="function"&&typeof j.fn.dataTableExt.fnVersionCheck=="function"&&j.fn.dataTableExt.fnVersionCheck("1.9.3")){j.fn.dataTableExt.aoFeatures.push({fnInit:function(k){var m=k.oInstance;if(!k._colReorder){var n=k.oInit;var l=n.colReorder||n.oColReorder||{};new h(k,l)}else{m.oApi._fnLog(k,1,"ColReorder attempted to initialise twice. Ignoring second")}return null},cFeature:"R",sFeature:"ColReorder"})}else{alert("Warning: ColReorder requires DataTables 1.9.3 or greater - www.datatables.net/download")}if(j.fn.dataTable.Api){j.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(k){k._colReorder.fnReset()})});j.fn.dataTable.Api.register("colReorder.order()",function(k){if(k){return this.iterator("table",function(l){l._colReorder.fnOrder(k)})}return this.context.length?this.context[0]._colReorder.fnOrder():null})}return h};if(typeof define==="function"&&define.amd){define(["jquery","datatables"],c)}else{if(typeof exports==="object"){c(require("jquery"),require("datatables"))}else{if(jQuery&&!jQuery.fn.dataTable.ColReorder){c(jQuery,jQuery.fn.dataTable)}}}})(window,document);