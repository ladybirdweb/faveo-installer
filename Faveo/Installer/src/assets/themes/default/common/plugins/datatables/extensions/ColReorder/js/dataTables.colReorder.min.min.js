/*! ColReorder 1.1.3
 * Â©2010-2014 SpryMedia Ltd - datatables.net/license
 */
(function(l,i,j){function k(a){var b=[];for(var c=0,d=a.length;c<d;c++){b[a[c]]=c}return b}function m(c,a,b){var d=c.splice(a,1)[0];c.splice(b,0,d)}function h(b,f,g){var c=[];for(var d=0,e=b.childNodes.length;d<e;d++){if(b.childNodes[d].nodeType==1){c.push(b.childNodes[d])}}var a=c[f];if(g!==null){b.insertBefore(a,c[g])}else{b.appendChild(a)}}var n=function(a,b){a.fn.dataTableExt.oApi.fnColReorder=function(M,g,L){var K=a.fn.dataTable.Api?true:false;var f,D,C,J,I=M.aoColumns.length,N,P;var e=function(p,o,q){if(!p[o]){return}var s=p[o].split(".");var r=s.shift();if(isNaN(r*1)){return}p[o]=q[r*1]+"."+s.join(".")};if(g==L){return}if(g<0||g>=I){this.oApi._fnLog(M,1,"ColReorder 'from' index is out of bounds: "+g);return}if(L<0||L>=I){this.oApi._fnLog(M,1,"ColReorder 'to' index is out of bounds: "+L);return}var F=[];for(f=0,D=I;f<D;f++){F[f]=f}m(F,g,L);var d=k(F);for(f=0,D=M.aaSorting.length;f<D;f++){M.aaSorting[f][0]=d[M.aaSorting[f][0]]}if(M.aaSortingFixed!==null){for(f=0,D=M.aaSortingFixed.length;f<D;f++){M.aaSortingFixed[f][0]=d[M.aaSortingFixed[f][0]]}}for(f=0,D=I;f<D;f++){P=M.aoColumns[f];for(C=0,J=P.aDataSort.length;C<J;C++){P.aDataSort[C]=d[P.aDataSort[C]]}if(K){P.idx=d[P.idx]}}if(K){a.each(M.aLastSort,function(p,o){M.aLastSort[p].src=d[o.src]})}for(f=0,D=I;f<D;f++){P=M.aoColumns[f];if(typeof P.mData=="number"){P.mData=d[P.mData];M.oApi._fnColumnOptions(M,f,{})}else{if(a.isPlainObject(P.mData)){e(P.mData,"_",d);e(P.mData,"filter",d);e(P.mData,"sort",d);e(P.mData,"type",d);M.oApi._fnColumnOptions(M,f,{})}}}if(M.aoColumns[g].bVisible){var E=this.oApi._fnColumnIndexToVisible(M,g);var O=null;f=L<g?L:L+1;while(O===null&&f<I){O=this.oApi._fnColumnIndexToVisible(M,f);f++}N=M.nTHead.getElementsByTagName("tr");for(f=0,D=N.length;f<D;f++){h(N[f],E,O)}if(M.nTFoot!==null){N=M.nTFoot.getElementsByTagName("tr");for(f=0,D=N.length;f<D;f++){h(N[f],E,O)}}for(f=0,D=M.aoData.length;f<D;f++){if(M.aoData[f].nTr!==null){h(M.aoData[f].nTr,E,O)}}}m(M.aoColumns,g,L);m(M.aoPreSearchCols,g,L);for(f=0,D=M.aoData.length;f<D;f++){var H=M.aoData[f];if(K){if(H.anCells){m(H.anCells,g,L)}if(H.src!=="dom"&&a.isArray(H._aData)){m(H._aData,g,L)}}else{if(a.isArray(H._aData)){m(H._aData,g,L)}m(H._anHidden,g,L)}}for(f=0,D=M.aoHeader.length;f<D;f++){m(M.aoHeader[f],g,L)}if(M.aoFooter!==null){for(f=0,D=M.aoFooter.length;f<D;f++){m(M.aoFooter[f],g,L)}}if(K){var G=new a.fn.dataTable.Api(M);G.rows().invalidate()}for(f=0,D=I;f<D;f++){a(M.aoColumns[f].nTh).off("click.DT");this.oApi._fnSortAttachListener(M,M.aoColumns[f].nTh,f)}a(M.oInstance).trigger("column-reorder",[M,{iFrom:g,iTo:L,aiInvertMapping:d}])};var c=function(d,e){var g;if(a.fn.dataTable.Api){g=new a.fn.dataTable.Api(d).settings()[0]}else{if(d.fnSettings){g=d.fnSettings()}else{if(typeof d==="string"){if(a.fn.dataTable.fnIsDataTable(a(d)[0])){g=a(d).eq(0).dataTable().fnSettings()}}else{if(d.nodeName&&d.nodeName.toLowerCase()==="table"){if(a.fn.dataTable.fnIsDataTable(d.nodeName)){g=a(d.nodeName).dataTable().fnSettings()}}else{if(d instanceof jQuery){if(a.fn.dataTable.fnIsDataTable(d[0])){g=d.eq(0).dataTable().fnSettings()}}else{g=d}}}}}if(g._colReorder){throw"ColReorder already initialised on table #"+g.nTable.id}var f=a.fn.dataTable.camelToHungarian;if(f){f(c.defaults,c.defaults,true);f(c.defaults,e||{})}this.s={dt:null,init:a.extend(true,{},c.defaults,e),fixed:0,fixedRight:0,reorderCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]};this.dom={drag:null,pointer:null};this.s.dt=g;this.s.dt._colReorder=this;this._fnConstruct();g.oApi._fnCallbackReg(g,"aoDestroyCallback",a.proxy(this._fnDestroy,this),"ColReorder");return this};c.prototype={fnReset:function(){var e=[];for(var d=0,f=this.s.dt.aoColumns.length;d<f;d++){e.push(this.s.dt.aoColumns[d]._ColReorder_iOrigCol)}this._fnOrderColumns(e);return this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(g){if(g===j){var e=[];for(var d=0,f=this.s.dt.aoColumns.length;d<f;d++){e.push(this.s.dt.aoColumns[d]._ColReorder_iOrigCol)}return e}this._fnOrderColumns(k(g));return this},_fnConstruct:function(){var g=this;var f=this.s.dt.aoColumns.length;var q;if(this.s.init.iFixedColumns){this.s.fixed=this.s.init.iFixedColumns}this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0;if(this.s.init.fnReorderCallback){this.s.reorderCallback=this.s.init.fnReorderCallback}for(q=0;q<f;q++){if(q>this.s.fixed-1&&q<f-this.s.fixedRight){this._fnMouseListener(q,this.s.dt.aoColumns[q].nTh)}this.s.dt.aoColumns[q]._ColReorder_iOrigCol=q}this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(p,o){g._fnStateSave.call(g,o)},"ColReorder_State");var e=null;if(this.s.init.aiOrder){e=this.s.init.aiOrder.slice()}if(this.s.dt.oLoadedState&&typeof this.s.dt.oLoadedState.ColReorder!="undefined"&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length){e=this.s.dt.oLoadedState.ColReorder}if(e){if(!g.s.dt._bInitComplete){var r=false;this.s.dt.aoDrawCallback.push({fn:function(){if(!g.s.dt._bInitComplete&&!r){r=true;var o=k(e);g._fnOrderColumns.call(g,o)}},sName:"ColReorder_Pre"})}else{var d=k(e);g._fnOrderColumns.call(g,d)}}else{this._fnSetColumnIndexes()}},_fnOrderColumns:function(e){if(e.length!=this.s.dt.aoColumns.length){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not match known number of columns. Skipping.");return}for(var d=0,f=e.length;d<f;d++){var g=a.inArray(d,e);if(d!=g){m(e,g,d);this.s.dt.oInstance.fnColReorder(g,d)}}if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);this._fnSetColumnIndexes();if(this.s.reorderCallback!==null){this.s.reorderCallback.call(this)}},_fnStateSave:function(e){var t,v,x,f;var w=this.s.dt;var u=w.aoColumns;e.ColReorder=[];if(e.aaSorting){for(t=0;t<e.aaSorting.length;t++){e.aaSorting[t][0]=u[e.aaSorting[t][0]]._ColReorder_iOrigCol}var g=a.extend(true,[],e.aoSearchCols);for(t=0,v=u.length;t<v;t++){f=u[t]._ColReorder_iOrigCol;e.aoSearchCols[f]=g[t];e.abVisCols[f]=u[t].bVisible;e.ColReorder.push(f)}}else{if(e.order){for(t=0;t<e.order.length;t++){e.order[t][0]=u[e.order[t][0]]._ColReorder_iOrigCol}var d=a.extend(true,[],e.columns);for(t=0,v=u.length;t<v;t++){f=u[t]._ColReorder_iOrigCol;e.columns[f]=d[t];e.ColReorder.push(f)}}}},_fnMouseListener:function(f,d){var e=this;a(d).on("mousedown.ColReorder",function(g){g.preventDefault();e._fnMouseDown.call(e,g,d)})},_fnMouseDown:function(q,r){var e=this;var d=a(q.target).closest("th, td");var g=d.offset();var f=parseInt(a(r).attr("data-column-index"),10);if(f===j){return}this.s.mouse.startX=q.pageX;this.s.mouse.startY=q.pageY;this.s.mouse.offsetX=q.pageX-g.left;this.s.mouse.offsetY=q.pageY-g.top;this.s.mouse.target=this.s.dt.aoColumns[f].nTh;this.s.mouse.targetIndex=f;this.s.mouse.fromIndex=f;this._fnRegions();a(i).on("mousemove.ColReorder",function(o){e._fnMouseMove.call(e,o)}).on("mouseup.ColReorder",function(o){e._fnMouseUp.call(e,o)})},_fnMouseMove:function(q){var r=this;if(this.dom.drag===null){if(Math.pow(Math.pow(q.pageX-this.s.mouse.startX,2)+Math.pow(q.pageY-this.s.mouse.startY,2),0.5)<5){return}this._fnCreateDragNode()}this.dom.drag.css({left:q.pageX-this.s.mouse.offsetX,top:q.pageY-this.s.mouse.offsetY});var g=false;var e=this.s.mouse.toIndex;for(var d=1,f=this.s.aoTargets.length;d<f;d++){if(q.pageX<this.s.aoTargets[d-1].x+((this.s.aoTargets[d].x-this.s.aoTargets[d-1].x)/2)){this.dom.pointer.css("left",this.s.aoTargets[d-1].x);this.s.mouse.toIndex=this.s.aoTargets[d-1].to;g=true;break}}if(!g){this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x);this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to}if(this.s.init.bRealtime&&e!==this.s.mouse.toIndex){this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this.s.mouse.fromIndex=this.s.mouse.toIndex;this._fnRegions()}},_fnMouseUp:function(d){var e=this;a(i).off("mousemove.ColReorder mouseup.ColReorder");if(this.dom.drag!==null){this.dom.drag.remove();this.dom.pointer.remove();this.dom.drag=null;this.dom.pointer=null;this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this._fnSetColumnIndexes();if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);if(this.s.reorderCallback!==null){this.s.reorderCallback.call(this)}}},_fnRegions:function(){var e=this.s.dt.aoColumns;this.s.aoTargets.splice(0,this.s.aoTargets.length);this.s.aoTargets.push({x:a(this.s.dt.nTable).offset().left,to:0});var g=0;for(var d=0,f=e.length;d<f;d++){if(d!=this.s.mouse.fromIndex){g++}if(e[d].bVisible){this.s.aoTargets.push({x:a(e[d].nTh).offset().left+a(e[d].nTh).outerWidth(),to:g})}}if(this.s.fixedRight!==0){this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight)}if(this.s.fixed!==0){this.s.aoTargets.splice(0,this.s.fixed)}},_fnCreateDragNode:function(){var g=this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="";var d=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh;var e=d.parentNode;var r=e.parentNode;var f=r.parentNode;var q=a(d).clone();this.dom.drag=a(f.cloneNode(false)).addClass("DTCR_clonedTable").append(a(r.cloneNode(false)).append(a(e.cloneNode(false)).append(q[0]))).css({position:"absolute",top:0,left:0,width:a(d).outerWidth(),height:a(d).outerHeight()}).appendTo("body");this.dom.pointer=a("<div></div>").addClass("DTCR_pointer").css({position:"absolute",top:g?a("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:a(this.s.dt.nTable).offset().top,height:g?a("div.dataTables_scroll",this.s.dt.nTableWrapper).height():a(this.s.dt.nTable).height()}).appendTo("body")},_fnDestroy:function(){var d,e;for(d=0,e=this.s.dt.aoDrawCallback.length;d<e;d++){if(this.s.dt.aoDrawCallback[d].sName==="ColReorder_Pre"){this.s.dt.aoDrawCallback.splice(d,1);break}}a(this.s.dt.nTHead).find("*").off(".ColReorder");a.each(this.s.dt.aoColumns,function(f,g){a(g.nTh).removeAttr("data-column-index")});this.s.dt._colReorder=null;this.s=null},_fnSetColumnIndexes:function(){a.each(this.s.dt.aoColumns,function(e,d){a(d.nTh).attr("data-column-index",e)})}};c.defaults={aiOrder:null,bRealtime:false,iFixedColumns:0,iFixedColumnsRight:0,fnReorderCallback:null};c.version="1.1.3";a.fn.dataTable.ColReorder=c;a.fn.DataTable.ColReorder=c;if(typeof a.fn.dataTable=="function"&&typeof a.fn.dataTableExt.fnVersionCheck=="function"&&a.fn.dataTableExt.fnVersionCheck("1.9.3")){a.fn.dataTableExt.aoFeatures.push({fnInit:function(f){var d=f.oInstance;if(!f._colReorder){var g=f.oInit;var e=g.colReorder||g.oColReorder||{};new c(f,e)}else{d.oApi._fnLog(f,1,"ColReorder attempted to initialise twice. Ignoring second")}return null},cFeature:"R",sFeature:"ColReorder"})}else{alert("Warning: ColReorder requires DataTables 1.9.3 or greater - www.datatables.net/download")}if(a.fn.dataTable.Api){a.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(d){d._colReorder.fnReset()})});a.fn.dataTable.Api.register("colReorder.order()",function(d){if(d){return this.iterator("table",function(e){e._colReorder.fnOrder(d)})}return this.context.length?this.context[0]._colReorder.fnOrder():null})}return c};if(typeof define==="function"&&define.amd){define(["jquery","datatables"],n)}else{if(typeof exports==="object"){n(require("jquery"),require("datatables"))}else{if(jQuery&&!jQuery.fn.dataTable.ColReorder){n(jQuery,jQuery.fn.dataTable)}}}})(window,document);